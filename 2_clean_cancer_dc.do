** This is the second *do* file to be called by the master file.

 ******************************************************************************
 *
 *	GA-C D R C      A N A L Y S I S         C O D E
 *                                                              
 *  DO FILE: 		2_clean_cancer_dc
 *					2nd dofile: Cancer Data Clean
 *
 *	STATUS:			Completed
 *
 *  FIRST RUN:	 	06sep2018
 *
 *	LAST RUN:		03dec2018
 *
 *  ANALYSIS: 		Cleaning data on all CR5 tables incl.
 *					dropping duplicates and irrelevant years of data
 *					JC uses for basis of checkflags for cancer team corrections
 *
 * 	VERSION: 		version02 - 2014 ABSTRACTION PHASE
 *     
 *  SUPPORT: 		Natasha Sobers/Ian R Hambleton	
 *
 ******************************************************************************

** Stata version control
version 15.1
** Initialising the STATA log and allow automatic page scrolling
capture {
    program drop _all
	drop _all
	log close
	}

** Direct Stata to your data-cleaning folder using the -cd- command
cd "L:\BNR_data\DM\data_cleaning\2014\cancer\versions\version02\"

log using "logfiles\2_clean_cancer_2014_dc.smcl", replace

set more off

**************************************
** DATA PREPARATION  
**************************************
** LOAD the prepared dataset
use "data\raw\2014_cancer_prep_dc.dta" ,clear

count //6,871

drop if dxyr!=2014 //4,315 obs deleted

count //2,556
/*
 JC 31oct18: Some of the totals recorded after the 'count' checks below may vary
 due to updates made in CR5 raw data but due to time constraints I can't keep 
 revising and re-checking totals
*/

*************************************************
/*
BLANK & INCONSISTENCY CHECKS - PATIENT TABLE
CHECKS 1 - 46
IDENTIFY, REVIEW & CORRECT ERRORS
Note: Checks not always in sequential order due
	  to previous review format
*/
*************************************************

********************** 
** Unique PatientID **
**********************
count if pid=="" //0

** Person Search
count if persearch==0 //840 - person serach not done; can ignore as will check duplicates in this dofile
count if persearch==3 //0
count if persearch==4 //0

** Patient record updated by
** Auto-generated by CR5 but may be needed when assigning who last accessed record.

** Date patient record updated
** Auto-generated by CR5 but may be needed when assigning who last accessed record.

************************
** PT Data Abstractor **
************************
** Check 1 - missing
count if ptda==. //0

** Check 2 - nonnumeric characters in numeric field
** contains a nonnumeric character so field needs correcting!

** Check 3 - length
count if ptda>14 & ptda<22 //0

**********************
** Casefinding Date **
**********************
** Check 4 - missing/ptdoa!=stdoa
count if ptdoa==. //0
count if ptdoa!=stdoa & ptdoa!=d(01jan2000) & stdoa!=d(01jan2000) & (tumourtot<2 & sourcetot<2) //27 - no correction necessary
list pid eid sid ptdoa stdoa dxyr cr5id if ptdoa!=stdoa & ptdoa!=d(01jan2000) & stdoa!=d(01jan2000) & (tumourtot<2 & sourcetot<2)

** Check 5 - invalid (future date)
** Need to create a variable with current date - to be used when cleaning dates
gen currentd=c(current_date)
gen double currentdatept=date(currentd, "DMY", 2017)
drop currentd
format currentdatept %dD_m_CY
label var currentdate "Current date PT"
count if ptdoa!=. & ptdoa>currentdatept //0

*****************
** Case Status **
*****************
** Check 6 - missing
count if cstatus==. //0

** Check 7 - invalid (case status=ABS, rec status!=Dup but TT DA is missing)
count if cstatus==1 & recstatus!=4 & ttda==. //0
list pid cstatus ttda ttdoa dxyr cr5id if cstatus==1 & recstatus!=4 & ttda==.

** Check 8 - possibly invalid (patient record listed as duplicate)
count if cstatus==4 //0

** Check 9 - possibly invalid (patient record listed as deleted)
count if cstatus==2 //0

** Check 10 - possibly invalid (patient record listed as ineligible but tumour record status not ineligible/duplicate)
count if cstatus==3 & recstatus<3 //0
list pid cstatus recstatus dxyr cr5id if cstatus==3 & recstatus<3

** Check 11 - invalid (record status for all tumours in a patient record=duplicate)
/* 
JC 18sep2018: Checked all tumours and sources in below list in CR5 to ensure they all relate to tumour site(s) and no MPs accidentally not abstracted(esp. for breast,colon cases).
JC 18sep2018: Emailed SAF re pid 20130692 whose primsite/top is incorrectly assigned as mediastinum (heart) but should be lung. Updated excel list manually in
			  pathway: \Sync\Cancer\CanReg5\DA Corrections\2018\July\ 2018-07-12_Cancer_Corrections_PRE-2014_JC.xlsx
JC 18/19sep2018: Awaiting email responses from PP, SAF for below pids
	20140315 - to confirm hx/morph: PP 19sep2018 states to code M9734-plasmacytoma, extramedullary (not occurring in bone). 
	20140752 - to confirm eligibility ?before 2014: SAF confirmed by email 24sep18 "Case ineligible. Dx 2012 – Lab # 12017600."
	20141117 - to confirm MP (wilms tumour) - ignore wilms tumour dx: see email thread from 14nov18-KWG checked pt notes and no mention of that dx - maybe a notification error from doc on NF.
	20141181 - to confirm site(s)/morph(s): PP 19sep2018 states 2 tumours–one in the ovary which is borderline/benign and the other in the chest wall which is sclerosing epithelioid fibrosarcoma. I will correct the abstraction so that the chest wall primary is abstracted and not the ovary as originally done by the DA
	20141490 - to confirm site (cervix vs endometrium): PP 19sep2018 states primsite is endometrium with spread to cervix
*/
count if cstatus==1 & recstatus==4 //198
list pid cstatus dxyr cr5id if cstatus==1 & recstatus==4

/* 
Below cases are MPs that were missed by cancer team at abstraction and should have been abstracted or incidentally found incorrect data.
JC 18sep2018 corrected below as NS instructed for 2014 data cleaning I will clean data but for the future SDA to clean data:
	20140077 T3 - Missed MP: added T1S1 to T3S2 and abstracted GE cancer (T1=rectum) in main CR5.
	20140125 T2 - DID NOT abstract anal cancer (T1=NHL) since IHC showed vimentin positive staining on anal bx and this can be a variable for lymphomas.
	20140138 T1 - updated in Stata dofile hx, morph, grade and ttda(see below) from metastatic carcinoma to metastatic neuroendocrine carcinoma, intermediate grade based on T2S1 bx cons rpt.
	20140176 T3 - Missed MP: added T3 and added T1S1 to T3S1 and abstracted breast cancer (T1=rectum) in main CR5.
	20140232 T1 - updated in Stata dofile hx, morph and grade(see below) from carcinoma to undifferentiated carcinoma based on T2S1 bx MD comment.
	20140289 T1 - updated in Stata dofile hx, morph and grade(see below) from carcinoma to endometrioid adenocarcinoma based on T1S2 bx MD.
	20140315 T1 - updated in Stata dofile primsite,top,hx,morph,lat(see below) from BM to LN-cervical, from NHL to NHL,plasmacytic type/plasmacytoma extramedullary, from 8 to 1 based on T2S1 bx.
	20140387 T1 - updated in Stata dofile hx and morph(see below) from adenocarcinoma to endometrioid adenocarcinoma based on T2S1 bx MD.
	20140394 T1 - updated in Stata dofile primsite, top, hx, morph and grade(see below) from bone marrow to stomach and from NHL to MALT based on T2S1 bx MD (MALT chosen over DLBCL as this has higher morph code see IARC MP rules).
	20140395 T1 - updated in Stata dofile primsite, top, hx, morph and grade(see below) from bone marrow to LN, NOS and from NHL to T-CELL NHL based on T2S1 dx (see PONC Vol 2 Malig. Lymph. pg5 re undetermined primsite).
	20140398 T1 - updated in Stata dofile hx and morph(see below) from adenocarcinoma to endometrioid adenocarcinoma based on T2S1 bx MD.
	20140407 T1 - updated in Stata dofile hx and grade(see below) from carcinoma to poorly diff. carcinoma based on T1S2 bx MD.
	20140463 T1 - updated in Stata dofile hx and morph(see below) from SCC to SCC keratinizing mod.diff. based on T2S1 bx.
	20140463 T1 - updated in Stata dofile primsite,top,hx and morph(see below) from peritoneum to retroperitoneum and from liposarcoma to liposarcoma, dedifferentiated variant based on T2S1 bx.
	20140555 T2 - Missed MP: abstracted T2 as Lt breast cancer, T1=Rt breast cancer in main CR5(incorrect latcheckcat already flagged for T1 as lat=bilat but breast should<>bilat so will correct now in dofile so T1 lat=Rt).
	20140690 T4,T5 - updated in Stata dofile T4 hx and morph(see below) from endometroid ca to endometrioid carcinoma based on T4S1 bx; updated T5 beh from malig. to in-situ based on T5S1 bx.
	20140692 T1 - updated in Stata dofile hx and morph(see below) from SCC to SCC keratinizing mod.diff. based on T2S1 bx.
	20140693 T1 - updated in Stata dofile hx and grade(see below) from invasive ductal ca to invasive ductal carcinoma, grade 2 based on T2S1 bx.
	20140739 T1 - updated in Stata dofile morph(see below) from M8380 to M8262 based on T2S1 bx. 
	20140752 T1 - updated in Stata dofile recstatus from 1(conf.) to 3(ineli.) and comments: SAF confirmed by email 24sep18 "Case ineligible. Dx 2012 – Lab # 12017600."
	20141040 T2 - updated in Stata dofile hx,lat,beh,grade(see below) from lt to right, from invasive ductal ca to in-situ ductal ca, from grade 2 to 9 (only malignant tumours are graded) based on T1S1 bx.
	20141115 T1 - updated in Stata dofile primsite,top,hx,morph,grade(see below) from breast to breast UOQ, from invasive lobular ca to invasive mammary ca, from grade 9 to 2 based on T2S1 bx.
	20141124 T1 - updated in Stata dofile primsite,top(see below) from esophagus to esophagus middle third based on T1S1 bx.
	20141181 T1 - updated in Stata dofile primsite,top,hx,morph,basis(see below) from ovary to chest wall, from carcinoma to sclerosing epithelioid fibrosarcoma, from 6 to 7 based on T2S1 bx(cons rpt).
	20141211 T1 - updated in Stata dofile grade(see below) from 9 to 2 based on T1S1 bx.
	20141477 T1 - updated in Stata dofile hx and morph(see below) from adenocarcinoma to endometrioid carcinoma based on T1S1 bx.
	20141481 T1 - updated in Stata dofile morph(see below) from 8522 to 8520 based on T2S1, T2S2 bx.
	20141490 T1 - updated in Stata dofile primsite,top,hx and morph(see below) from adenocarcinoma to endometrioid carcinoma based on T2S1 bx.
	20141501 T1 - updated in Stata dofile hx,morph(see below) from 8140 to 8380 based on T1S1 bx.
	20145027 T1 - updated in Stata dofile primsite,top(see below) from 20.9 to 21.8 based on bxs and cod.
	20145030 T1 - updated in Stata dofile lat(see below) from rt to bilat. based on T1S1 bx.
	20145084 T1 - updated in Stata dofile hx,morph(see below) from 8140 to 8480 based on T1S1 bx.
*/
replace hx="METASTATIC NEUROENDOCRINE CARCINOMA, INTERMEDIATE GRADE" if pid=="20140138" & regexm(cr5id, "T1") //3 changes
replace morph=8246 if pid=="20140138" & regexm(cr5id, "T1") //3 changes
replace morphcat=6 if pid=="20140138" & regexm(cr5id, "T1") //3 changes
replace grade=2 if pid=="20140138" & regexm(cr5id, "T1") //3 changes
replace ttda=9 if pid=="20140138" & regexm(cr5id, "T1") //3 changes

replace hx="UNDIFFERENTIATED CARCINOMA" if pid=="20140232" & regexm(cr5id, "T1") //2 changes
replace morph=8020 if pid=="20140232" & regexm(cr5id, "T1") //2 changes
replace morphcat=2 if pid=="20140232" & regexm(cr5id, "T1") //0 changess
replace grade=4 if pid=="20140232" & regexm(cr5id, "T1") //2 changes

replace hx="ENDOMETRIOID ADENOCARCINOMA FIGO GRADE 1" if pid=="20140289" & regexm(cr5id, "T1") //4 changes
replace morph=8380 if pid=="20140289" & regexm(cr5id, "T1") //4 changes
replace morphcat=6 if pid=="20140289" & regexm(cr5id, "T1") //4 changes
replace grade=1 if pid=="20140289" & regexm(cr5id, "T1") //4 changes

replace primarysite="LYMPH NODE-CERVICAL" if pid=="20140315" & regexm(cr5id, "T1") //1 change
replace topography=770 if pid=="20140315" & regexm(cr5id, "T1") //1 change
replace top="770" if pid=="20140315" & regexm(cr5id, "T1") //1 change
replace topcat=69 if pid=="20140315" & regexm(cr5id, "T1") //1 change
replace hx="NON-HODGKIN LYMPHOMA,PLASMACYTIC TYPE/PLASMACYTOMA EXTRAMEDULLARY" if pid=="20140315" & regexm(cr5id, "T1") //1 change
replace morph=9734 if pid=="20140315" & regexm(cr5id, "T1") //1 change
replace morphcat=46 if pid=="20140315" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140315" & regexm(cr5id, "T1") //1 change

replace hx="ENDOMETRIOID ADENOCARCINOMA FIGO GRADE 1" if pid=="20140387" & regexm(cr5id, "T1") //1 change
replace morph=8380 if pid=="20140387" & regexm(cr5id, "T1") //1 change
replace morphcat=6 if pid=="20140387" & regexm(cr5id, "T1") //0 changess

replace primarysite="STOMACH" if pid=="20140394" & regexm(cr5id, "T1") //1 change
replace topography=169 if pid=="20140394" & regexm(cr5id, "T1") //1 change
replace top="169" if pid=="20140394" & regexm(cr5id, "T1") //1 change
replace topcat=17 if pid=="20140394" & regexm(cr5id, "T1") //1 change
replace hx="MALT-MUCOSAL-ASSOCIATED LYMPHOID TISSUE/MARGINAL ZONE B-CELL LYMPHOMA" if pid=="20140394" & regexm(cr5id, "T1") //1 change
replace morph=9699 if pid=="20140394" & regexm(cr5id, "T1") //1 change
replace morphcat=43 if pid=="20140394" & regexm(cr5id, "T1") //1 change
replace grade=6 if pid=="20140394" & regexm(cr5id, "T1") //1 change

replace primarysite="LYMPH NODE-MEDIASTINUM ANTERIOR" if pid=="20140395" & regexm(cr5id, "T1") //1 change
replace topography=771 if pid=="20140395" & regexm(cr5id, "T1") //1 change
replace top="771" if pid=="20140395" & regexm(cr5id, "T1") //1 change
replace topcat=69 if pid=="20140395" & regexm(cr5id, "T1") //1 change
replace hx="T-CELL NON-HODGKIN LYMPHOMA" if pid=="20140395" & regexm(cr5id, "T1") //1 change
replace morph=9702 if pid=="20140395" & regexm(cr5id, "T1") //1 change
replace morphcat=44 if pid=="20140395" & regexm(cr5id, "T1") //1 change
replace grade=5 if pid=="20140394" & regexm(cr5id, "T1") //1 change

replace hx="ENDOMETRIOID ADENOCARCINOMA FIGO GRADE 3" if pid=="20140398" & regexm(cr5id, "T1") //2 changes
replace morph=8380 if pid=="20140398" & regexm(cr5id, "T1") //2 changes
replace morphcat=6 if pid=="20140398" & regexm(cr5id, "T1") //0 changess

replace hx="POORLY DIFFERENTIATED CARCINOMA" if pid=="20140407" & regexm(cr5id, "T1") //4 changes
replace grade=3 if pid=="20140407" & regexm(cr5id, "T1") //4 changes

replace hx="SQUAMOUS CELL CARCINOMA, KERATINIZING, MODERATELY DIFFERENTIATED" if pid=="20140463" & regexm(cr5id, "T1") //3 changes
replace morph=8071 if pid=="20140463" & regexm(cr5id, "T1") //3 changes
replace morphcat=3 if pid=="20140463" & regexm(cr5id, "T1") //0 changess

replace primarysite="RETROPERITONEUM" if pid=="20140525" & regexm(cr5id, "T1") //2 changes
replace topography=480 if pid=="20140525" & regexm(cr5id, "T1") //2 changes
replace top="480" if pid=="20140525" & regexm(cr5id, "T1") //2 changes
replace topcat=41 if pid=="20140525" & regexm(cr5id, "T1") //0 changess
replace hx="LIPOSARCOMA, DEDIFFERENTIATED VARIANT" if pid=="20140525" & regexm(cr5id, "T1") //2 changes
replace morph=8858 if pid=="20140525" & regexm(cr5id, "T1") //2 changes
replace morphcat=20 if pid=="20140525" & regexm(cr5id, "T1") //0 changess

replace lat=1 if pid=="20140555" & regexm(cr5id, "T1") //2 changes

replace hx="ENDOMETRIOID CARCINOMA" if pid=="20140690" & regexm(cr5id, "T4") //1 change
replace morph=8380 if pid=="20140690" & regexm(cr5id, "T4") //1 change
replace morphcat=6 if pid=="20140690" & regexm(cr5id, "T4") //0 changess
replace beh=2 if pid=="20140690" & regexm(cr5id, "T5") //1 change

replace hx="IN SITU DUCT CARCINOMA WITH MICROINVASION, PAGET'S DISEASE OF NIPPLE" if pid=="20140692" & regexm(cr5id, "T1") //3 changes
replace morph=8541 if pid=="20140692" & regexm(cr5id, "T1") //3 changes
replace morphcat=10 if pid=="20140692" & regexm(cr5id, "T1") //0 changess

replace hx="INVASIVE DUCTAL CARCINOMA, GRADE 2" if pid=="20140693" & regexm(cr5id, "T1") //3 changes
replace grade=2 if pid=="20140693" & regexm(cr5id, "T1") //3 changes

replace morph=8262 if pid=="20140739" & regexm(cr5id, "T1") //1 change
replace morphcat=6 if pid=="20140739" & regexm(cr5id, "T1") //0 changess

replace recstatus=3 if pid=="20140752" & regexm(cr5id, "T1") //2 changes
replace comments="24SEP18 JC: T1 Ineligible: SAF confirmed by email 24sep18 'Case ineligible. Dx 2012 – Lab # 12017600.' No F/U Needed. Pt found in Death Data, new source with COD added." if pid=="20140752" //3 changes

replace recstatus=3 if pid=="20141040" & regexm(cr5id, "T2") //1 change
replace hx="IN-SITU DUCTAL CARCINOMA" if pid=="20141040" & regexm(cr5id, "T2") //1 change
replace lat=1 if pid=="20141040" & regexm(cr5id, "T2") //1 change
replace beh=2 if pid=="20141040" & regexm(cr5id, "T2") //1 change
replace grade=9 if pid=="20141040" & regexm(cr5id, "T2") //1 change

replace primarysite="BREAST-UOQ" if pid=="20141115" & regexm(cr5id, "T1") //1 change
replace topography=504 if pid=="20141115" & regexm(cr5id, "T1") //1 change
replace top="504" if pid=="20141115" & regexm(cr5id, "T1") //1 change
replace topcat=43 if pid=="20141115" & regexm(cr5id, "T1") //0 changess
replace hx="INVASIVE MAMMARY CARCINOMA" if pid=="20141115" & regexm(cr5id, "T1") //1 change
replace morph=8500 if pid=="20141115" & regexm(cr5id, "T1") //1 change
replace morphcat=10 if pid=="20141115" & regexm(cr5id, "T1") //0 changess
replace grade=2 if pid=="20141115" & regexm(cr5id, "T1") //1 change

replace primarysite="ESOPHAGUS-MIDDLE THIRD" if pid=="20141124" & regexm(cr5id, "T1") //2 changes
replace topography=154 if pid=="20141124" & regexm(cr5id, "T1") //2 changes
replace top="154" if pid=="20141124" & regexm(cr5id, "T1") //2 changes
replace topcat=16 if pid=="20141124" & regexm(cr5id, "T1") //0 changess

replace primarysite="CHEST WALL-SOFT TISSUE" if pid=="20141181" & regexm(cr5id, "T1") //2 changes
replace topography=493 if pid=="20141181" & regexm(cr5id, "T1") //2 changes
replace top="493" if pid=="20141181" & regexm(cr5id, "T1") //2 changes
replace topcat=42 if pid=="20141181" & regexm(cr5id, "T1") //2 changes
replace hx="SCLEROSING EPITHELIOID FIBROSARCOMA" if pid=="20141181" & regexm(cr5id, "T1") //2 changes
replace morph=8810 if pid=="20141181" & regexm(cr5id, "T1") //2 changes
replace morphcat=18 if pid=="20141181" & regexm(cr5id, "T1") //2 changes
replace basis=7 if pid=="20141181" & regexm(cr5id, "T1") //2 changes

replace grade=2 if pid=="20141211" & regexm(cr5id, "T1") //2 changes

replace hx="ENDOMETRIOID ADENOCARCINOMA" if pid=="20141477" & regexm(cr5id, "T1") //3 changes
replace morph=8380 if pid=="20141477" & regexm(cr5id, "T1") //3 changes
replace morphcat=6 if pid=="20141477" & regexm(cr5id, "T1") //0 changess

replace morph=8520 if pid=="20141481" & regexm(cr5id, "T1") //2 changes

replace primarysite="ENDOMETRIUM" if pid=="20141490" & regexm(cr5id, "T1") //1 change
replace topography=541 if pid=="20141490" & regexm(cr5id, "T1") //1 change
replace top="541" if pid=="20141490" & regexm(cr5id, "T1") //1 change
replace topcat=47 if pid=="20141490" & regexm(cr5id, "T1") //1 change
replace hx="ENDOMETRIOID ADENOCARCINOMA" if pid=="20141490" & regexm(cr5id, "T1") //1 change
replace morph=8380 if pid=="20141490" & regexm(cr5id, "T1") //1 change
replace morphcat=6 if pid=="20141490" & regexm(cr5id, "T1") //0 changess

replace hx="ENDOMETRIOID ADENOCARCINOMA" if pid=="20141501" & regexm(cr5id, "T1") //2 changes
replace morph=8380 if pid=="20141501" & regexm(cr5id, "T1") //2 changes
replace morphcat=6 if pid=="20141501" & regexm(cr5id, "T1") //0 changess

replace primarysite="OVERLAP-ANUS RECTUM" if pid=="20145027" & regexm(cr5id, "T1") //3 changes
replace topography=218 if pid=="20145027" & regexm(cr5id, "T1") //3 changes
replace top="218" if pid=="20145027" & regexm(cr5id, "T1") //3 changes
replace topcat=22 if pid=="20145027" & regexm(cr5id, "T1") //3 changes

replace lat=4 if pid=="20145030" & regexm(cr5id, "T1") //3 changes

replace hx="ADENOCARCINOMA WITH MUCINOUS COMPONENT" if pid=="20145084" & regexm(cr5id, "T1") //2 changes
replace morph=8480 if pid=="20145084" & regexm(cr5id, "T1") //2 changes
replace morphcat=9 if pid=="20145084" & regexm(cr5id, "T1") //2 change


********************************
** First, Middle & Last Names **
********************************
** Check 23 - missing
count if fname=="" //0

** Check 24 - missing 
count if init=="" //37
list pid dxyr cr5id if init==""
replace notesseen=3 if pid=="20080704"
replace nsdate=d(01jan2000) if pid=="20080704"
replace init="M" if pid=="20080704"
replace resident=9 if pid=="20080704"
replace slc=9 if pid=="20080704"
replace init="99" if init==""

** Check 25 - missing 
count if lname=="" //0

*******************
** Date of Birth **
*******************
** Check 26 - missing (use birthdate var as partial dates are dropped when dob was formatted to a date var)
count if birthdate==. & primarysite!="" //0
list pid dobyear dobmonth dobday if birthdate==. & primarysite!=""

** Check 27 - missing but full NRN available
gen nrnday = substr(natregno,5,2)
count if dob==. & natregno!="" & natregno!="9999999999" & natregno!="999999-9999" & natregno!="99" & nrnday!="99" //0
list pid cr5id dob natregno cstatus recstatus dxyr if dob==. & natregno!="" & natregno!="9999999999" & natregno!="999999-9999" & natregno!="99" & nrnday!="99"

** Check 28 - invalid (dob has future year)
gen dob_yr = year(dob)
count if dob!=. & dob_yr>2014 //0
list pid dob dob_yr if dob!=. & dob_yr>2014

** Check 29 - invalid (dob does not match natregno)
gen dob_year = year(dob) if natregno!="" & natregno!="9999999999" & natregno!="999999-9999" & nrnday!="99" & length(natregno)==11
gen yr1=.
replace yr1 = 20 if dob_year>1999
replace yr1 = 19 if dob_year<2000
replace yr1 = 19 if dob_year==.
replace yr1 = 99 if natregno=="99"
list pid dob_year dob natregno yr yr1 if dob_year!=. & dob_year > 1999
gen nrn = substr(natregno,1,6) if natregno!="" & natregno!="9999999999" & natregno!="999999-9999" & nrnday!="99" & length(natregno)==11
destring nrn, replace
format nrn %06.0f
nsplit nrn, digits(2 2 2) gen(year month day)
format year month day %02.0f
tostring yr1, replace
gen year2 = string(year,"%02.0f")
gen nrnyr = substr(yr1,1,2) + substr(year2,1,2)
destring nrnyr, replace
sort nrn
gen dobchk=mdy(month, day, nrnyr)
format dobchk %dD_m_CY
count if dob!=dobchk & dobchk!=. //6
list pid age natregno dob dobchk dob_year dot if dob!=dobchk & dobchk!=.
drop day month year nrnyr yr yr1 nrn
** Correct dob and age, where applicable
replace dob=dobchk if pid=="20145154" //2 changes
replace dob_year=year(dobchk) if pid=="20145154" //2 changes
replace age=75 if pid=="20145154" //2 changes
replace dob=dobchk if pid=="20140779" //3 changes - age & dob_year already correct
replace dob=dobchk if pid=="20140700" //1 change - age & dob_year already correct

***********************
** National Reg. No. **
***********************
sort pid
** Check 30 - missing 
count if natregno=="" & dob!=. //1
list pid cr5id dob natregno cstatus recstatus dxyr if natregno=="" & dob!=.
replace natregno="310730-9999" if pid=="20140793" //1 change

** Check 31 - invalid length
count if length(natregno)<11 & natregno!="" //3
list pid natregno if length(natregno)<11 & natregno!=""
replace natregno="649999-9999" if pid=="20140545" //1 change
replace natregno="640717-0064" if pid=="20140911" //1 change
replace natregno="860909-9999" if pid=="20145118" //1 change

*********
** Sex **
*********
** Check 32 - missing
count if sex==. | sex==9 //0; 39 - no replace done as this was added after IARC chk in dofile 5 so will correct in that dofile

** Check 33 - possibly invalid (first name, NRN and sex check: MALES)
gen nrnid=substr(natregno, -4,4)
count if sex==2 & nrnid!="9999" & regex(substr(natregno,-2,1), "[1,3,5,7,9]") //9 - only 1 to change; others correct sex
list pid fname lname sex natregno cr5id if sex==2 & nrnid!="9999" & regex(substr(natregno,-2,1), "[1,3,5,7,9]")
replace sex=1 if pid=="20140557" //1 change

** Check 34 - possibly invalid (sex=M; site=breast)
count if sex==1 & (regexm(cr5cod, "BREAST") | regexm(top, "^50")) //7 - no changes; all correct
list pid fname lname natregno sex top cr5cod cr5id if sex==1 & (regexm(cr5cod, "BREAST") | regexm(top, "^50"))

** Check 35 - invalid (sex=M; site=FGS)
count if sex==1 & topcat>43 & topcat<52	& (regexm(cr5cod, "VULVA") | regexm(cr5cod, "VAGINA") | regexm(cr5cod, "CERVIX") | regexm(cr5cod, "CERVICAL") ///
								| regexm(cr5cod, "UTER") | regexm(cr5cod, "OVAR") | regexm(cr5cod, "PLACENTA")) //0
list pid fname lname natregno sex top cr5cod cr5id if sex==1 & topcat>43 & topcat<52 & (regexm(cr5cod, "VULVA") | regexm(cr5cod, "VAGINA") ///
								| regexm(cr5cod, "CERVIX") | regexm(cr5cod, "CERVICAL") | regexm(cr5cod, "UTER") | regexm(cr5cod, "OVAR") | regexm(cr5cod, "PLACENTA"))
								
** Check 36 - possibly invalid (first name, NRN and sex check: FEMALES)
count if sex==1 & nrnid!="9999" & regex(substr(natregno,-2,1), "[0,2,4,6,8]") //5 - 3 changed; others correct sex
list pid fname lname sex natregno cr5id if sex==1 & nrnid!="9999" & regex(substr(natregno,-2,1), "[0,2,4,6,8]")
replace sex=2 if pid=="20140369" //3 changes

** Check 37 - invalid (sex=F; site=MGS)
count if sex==2 & topcat>51 & topcat<56 & (regexm(cr5cod, "PENIS")|regexm(cr5cod, "PROSTAT")|regexm(cr5cod, "TESTIS")|regexm(cr5cod, "TESTIC")) //0
list pid fname lname natregno sex top cr5cod cr5id if sex==2 & topcat>51 & topcat<56 & (regexm(cr5cod, "PENIS")|regexm(cr5cod, "PROSTAT") ///
													  |regexm(cr5cod, "TESTIS")|regexm(cr5cod, "TESTIC"))

*********************
** Hospital Number **
*********************
** Check 38 - missing
count if hospnum=="" & retsource<8 //0
list pid hospnum retsource cr5id if hospnum=="" & retsource<8

*********************
** Resident Status **
*********************
** Check 39 - missing
count if resident==. //41 - all recstatus=ineligible
list pid resident recstatus cr5id if resident==.
replace resident=9 if resident==. //41 changes

*************************
** Status Last Contact **
*************************
** Check 40 - missing
count if slc==. & cstatus==1 //29
list pid slc recstatus cr5id if slc==. & cstatus==1
** Review cases in main CR5 db to determine slc then correct
**replace slc=9 if pid=="20140186" //1 change
replace grade=9 if pid=="20140186" //1 change
replace slc=1 if pid=="20140683" //2 changes
replace dlc=d(21feb2014) if pid=="20140683" //2 changes
**replace slc=9 if pid=="20140773" //1 change
**replace slc=9 if pid=="20140808" //2 changes
replace grade=2 if pid=="20140808" //2 changes
replace slc=1 if pid=="20140912" //3 changes
replace dlc=d(28may2014) if pid=="20140912" //3 changes
replace slc=1 if pid=="20140926" //1 change
replace dlc=d(30sep2014) if pid=="20140926" //1 change
replace slc=1 if pid=="20140928" //4 changes
replace dlc=d(10mar2014) if pid=="20140928" //4 changes
replace slc=1 if pid=="20140929" //3 changes
replace dlc=d(03jul2014) if pid=="20140929" //3 changes
replace slc=1 if pid=="20140962" //1 change
replace dlc=d(22dec2014) if pid=="20140962" //1 change
replace slc=1 if pid=="20140979" //1 change
replace dlc=d(17apr2014) if pid=="20140979" //1 change
replace slc=1 if pid=="20140995" //2 changes
replace dlc=d(11jul2014) if pid=="20140995" //2 changes
replace grade=2 if pid=="20140995" //2 changes
replace slc=1 if pid=="20140996" //1 change
replace dlc=d(17jan2014) if pid=="20140996" //1 change
replace grade=2 if pid=="20140996" //1 change
replace slc=1 if pid=="20141108" //2 changes
replace dlc=d(29jan2015) if pid=="20141108" //2 changes
replace slc=1 if pid=="20145094" //1 change
replace dlc=d(07apr2014) if pid=="20145094" //1 change
replace slc=1 if pid=="20145111" //1 change
replace dlc=d(31jul2014) if pid=="20145111" //1 change
replace slc=1 if pid=="20145117" //1 change
replace dlc=d(16oct2014) if pid=="20145117" //1 change
replace grade=2 if pid=="20145117" //1 change
replace slc=1 if pid=="20160029" //2 changes
replace dlc=d(02dec2014) if pid=="20160029" //2 changes
replace morph=8522 if pid=="20160029" //2 changes
replace morphcat=10 if pid=="20160029" //0 changess

count if slc==. //159; 157
** Change slc=9 if recstatus=ineligible cases
replace slc=9 if slc==. & recstatus==3 //155 changes; 153
list pid slc recstatus cr5id if slc==.
** Review cases in main CR5 db to determine slc then correct
replace slc=9 if pid=="20140836" //1 change
replace slc=9 if pid=="20141098" //1 change
replace slc=1 if pid=="20150175" //2 changes
replace dlc=d(18mar2015) if pid=="20150175" //2 changes
replace hx="MALIGNANT LYMPHOMA B-CELL TYPE/NON-HODGKIN LYMPHOMA" if pid=="20150175" //2 changes
replace grade=6 if pid=="20150175" //2 changes

** Check 41 - invalid (slc=died;dlc=blank)
count if slc==2 & dlc==. //0
list pid slc dlc cr5id if slc==2 & dlc==.

** Check 42 - invalid (slc=alive;dlc=blank)
count if slc==1 & dlc==. //86 - 20140701,20140801,20140817 dlc to remain blank;
list pid slc dlc recstatus cr5id if slc==1 & dlc==.
** Review cases in main CR5 db to determine slc then correct
replace dlc=d(01jul2014) if pid=="20080242" //1 change
replace primarysite="GINGIVAL SULCUS" if pid=="20080242" //1 change
replace topography=61 if pid=="20080242" //1 change
replace top="061" if pid=="20080242" //1 change
replace topcat=7 if pid=="20080242" //1 change
replace slc=2 if pid=="20140685" //1 change
replace dlc=d(05feb2017) if pid=="20140685" //1 change
replace dlc=d(20may2014) if pid=="20140690" //5 changes
replace slc=2 if pid=="20140700" //1 change
replace dlc=d(04jul2017) if pid=="20140700" //1 change
**replace slc=9 if pid=="20140701" //1 change
replace dlc=d(30jun2012) if pid=="20140777" //1 change
**replace slc=9 if pid=="20140817" //1 change
replace grade=6 if pid=="20140817" //1 change
replace morph=9811 if pid=="20140817" //1 change
replace morphcat=50 if pid=="20140817" //1 change
replace dlc=d(14nov2014) if pid=="20140869" //2 changes
replace dlc=d(05dec2014) if pid=="20140871" //1 change
replace dlc=d(03dec2014) if pid=="20140872" //3 changes
replace dlc=d(20may2014) if pid=="20140875" //2 changes
replace dlc=d(07oct2014) if pid=="20140878" //3 changes
replace hx="INFILTRATING MAMMARY CARCINOMA WITH MEDULLARY PHENOTYPE" if pid=="20140878" //3 changes
replace morph=8523 if pid=="20140878" //3 changes
replace morphcat=10 if pid=="20140878" //0 changess
replace dlc=d(06nov2015) if pid=="20140886" //1 change
replace dlc=d(08may2015) if pid=="20140888" //2 changes
replace dlc=d(30may2014) if pid=="20140889" //1 change
replace dlc=d(04apr2014) if pid=="20140890" //1 change
replace dlc=d(16dec2014) if pid=="20140892" //3 changes
replace dlc=d(16may2014) if pid=="20140906" //2 changes
replace dlc=d(09dec2014) if pid=="20140907" //2 changes
replace dlc=d(17oct2014) if pid=="20140908" //2 changes
replace dlc=d(28mar2014) if pid=="20140910" //1 change
replace dlc=d(19may2014) if pid=="20140911" //1 change
replace dlc=d(14jan2014) if pid=="20140923" //1 change
replace dlc=d(15aug2014) if pid=="20140925" //1 change
replace dlc=d(02oct2014) if pid=="20140931" //1 change
replace hx="INFILTRATING MAMMARY CARCINOMA WITH MEDULLARY PHENOTYPE" if pid=="20140931" //1 change
replace morph=8523 if pid=="20140931" //1 change
replace morphcat=10 if pid=="20140931" //0 changess
replace dlc=d(15aug2014) if pid=="20140936" //1 change
replace dlc=d(16sep2014) if pid=="20140940" //3 changes
replace dlc=d(03oct2014) if pid=="20140943" //1 change
replace dlc=d(22apr2014) if pid=="20140945" //2 changes
replace dlc=d(30jun2014) if pid=="20140947" //1 change
replace dlc=d(21feb2014) if pid=="20140948" //1 change
replace dlc=d(18jul2014) if pid=="20140951" //1 change
replace dlc=d(27jun2014) if pid=="20140952" //3 changes
replace hx="UNDIFFERENTIATED MALIGNANT FIBROUS HISTIOCYTOMA" if pid=="20140952" & regexm(cr5id, "T1") //3 changes
replace grade=4 if pid=="20140952" & regexm(cr5id, "T1") //3 changes
replace dlc=d(08dec2014) if pid=="20140959" //1 change
replace dlc=d(14nov2014) if pid=="20140960" //2 changes
replace dlc=d(21feb2014) if pid=="20140961" //1 change
replace dlc=d(12sep2014) if pid=="20140963" //2 changes
replace dlc=d(30may2014) if pid=="20140965" //1 change
replace grade=1 if pid=="20140965" //1 change
replace dlc=d(24jan2014) if pid=="20140968" //1 change
replace dlc=d(24nov2014) if pid=="20140973" //2 changes
replace dlc=d(17apr2014) if pid=="20140977" //2 changes
replace dlc=d(19mar2014) if pid=="20140982" //1 change
replace dlc=d(02jun2014) if pid=="20140985" //1 change
replace dlc=d(17oct2014) if pid=="20140986" //1 change
replace dlc=d(19mar2015) if pid=="20140988" //3 changes
replace dlc=d(18jul2014) if pid=="20140990" //1 change
replace dlc=d(28jul2014) if pid=="20140993" //3 changes
replace grade=3 if pid=="20140993" //3 changes
replace lat=1 if pid=="20140993" //3 changes
replace dlc=d(20jun2014) if pid=="20140997" //1 change
replace dlc=d(24apr2014) if pid=="20140998" //1 change
replace dlc=d(30jun2018) if pid=="20141339" //1 change
replace primarysite="URINARY BLADDER-NECK" if pid=="20141339" //1 change
replace topography=675 if pid=="20141339" //1 change
replace top="675" if pid=="20141339" //1 change
replace topcat=59 if pid=="20141339" //0 changess
replace grade=3 if pid=="20141339" //1 change
replace dlc=d(08apr2014) if pid=="20145095" //1 change
replace grade=2 if pid=="20145095" //1 change
replace dlc=d(14sep2014) if pid=="20145097" //2 changes
replace dot=d(08sep2014) if pid=="20145097" //2 changes
replace dlc=d(30jan2014) if pid=="20145101" //1 change
replace hx="CANCER" if pid=="20145101" //1 change
replace morph=8000 if pid=="20145101" //1 change
replace morphcat=1 if pid=="20145101" //1 change
replace dlc=d(28jul2014) if pid=="20145106" //2 changes

** Check 43 - invalid (slc=alive;nftype=death info)
count if slc==1 & (nftype==8 | nftype==9) //0
list pid slc nftype cr5id if slc==1 & (nftype==8 | nftype==9)

***********************
** Date Last Contact **
***********************
** Check 44 - missing
count if dlc==. & cstatus==1 & slc!=9 //0
list pid slc dlc cr5id if dlc==. & cstatus==1 & slc!=9

** Check 45 - invalid (future date)
** Use already created variable called 'currentdatept';
** to be used when cleaning dates
count if dlc!=. & dlc>currentdatept //0

**************
** Comments **
**************
** Check 46 - missing
count if comments=="" & cstatus==1 //278
list pid cstatus comments cr5id if comments=="" & cstatus==1
replace comments="99" if comments=="" & cstatus==1 //278 changes

** Crate a variable that contains the # of characters in the 'Comments' variable
gen countvar = wordcount(comments)


**********************************************************
/*
BLANK & INCONSISTENCY CHECKS - TUMOUR TABLE
CHECKS 47 - 119
IDENTIFY, REVIEW & CORRECT ERRORS
Note: Checks not always in sequential order due
	  to previous review format
*/
**********************************************************

*********************
** Unique TumourID **
*********************
count if eid=="" //0

**********************
** TT Record Status **
**********************
** This is auto-generated by CR5 while simultaneously allowing for manual input so
** there will never be any records with missing recstatus

** Check 47 - invalid (recstatus=pending)
count if recstatus==0 & dxyr!=. //5 - 2 pending review by PP (20140064 and 20141339) review completed 26sep18 recstatus changed to confirmed; 3 with no age/DOB and not in death data so cannot confirm
list pid dxyr cr5id if recstatus==0 & dxyr!=.
replace recstatus=4 if pid=="20140716" & cr5id=="T2S1" //1 change
replace recstatus=1 if pid=="20141167" & cr5id=="T1S1" //1 change
replace recstatus=1 if pid=="20141510" & cr5id=="T1S1" //1 change
replace recstatus=1 if pid=="20145025" & cr5id=="T1S1" //1 change

** Check 48 - invalid(cstatus=CF;recstatus<>Pending)
count if recstatus!=0 & cstatus==0 & ttdoa!=. //4
list pid cstatus recstatus dxyr ttdoa pid2 cr5id if recstatus!=0 & cstatus==0 & ttdoa!=.
replace cstatus=1 if pid2=="2014089701"
replace cstatus=1 if pid=="20141258"
replace cstatus=1 if pid=="20150175"

** Check 49a - possibly invalid (tumour record listed as deleted)
count if recstatus==2 //0

** REVIEW ALL dxyr>2013 CASES FLAGGED AS INELIGIBLE SINCE SOME DISCOVERED IN 2014 AS INELIGIBLE WHICH ARE ELIGIBLE FOR REGISTRATION
** Points to note: (1) reason for ineligibility should be recorded by DA in Comments field; (2) dxyr should be updated with correct year.
count if recstatus==3 //698 - too many to check as some are legitimate ineligibles
list pid cr5id dxyr ttda recstatus if recstatus==3
/*
Below cases are MPs that were missed by cancer team at abstraction and should have been abstracted or incidentally found incorrect data.
JC 24sep2018 corrected below as NS instructed for 2014 data cleaning I will clean data but for the future SDA to clean data:
	20080607 T2 - Missed MP: abstracted T2 breast cancer based on T2S2 path rpt(T1=colon) in main CR5.
	20130398 T2 - Missed MP: T2 merged with T1 but T1=male and died in 2013, T2=endometrium and bx=2014 - case incorrectly merged to wrong pt! JC emailed SAF/NS 24sep18 to discuss-see OneNote->Annual Report->Data Cleaning->Cancer_2014.
	20140130 T1 - updated in Stata dofile comments based on ineligible dx date.
	20140203 T1 - no reason for ineligibility given in comments and appears eligible so emailed SAF 24sep18 to confirm.
	20140394 T3 - updated in Stata dofile comments based on ineligible dx in path rpt.
	20140801 T1 - updated in Stata dofile comments,resident from 2 to 1 based on pt dx overseas but when moved here rx continued.
	20140968 T1 - updated in Stata dofile comments based on ineligible dx in path rpt.
	20140982 T1 - updated in Stata dofile comments to correct spelling from 'inelegible' to 'ineligible' as check will not pick it up.
	20141023 T1 - updated in Stata dofile comments based on ineligible dx in path rpt.
	20141098 T1 - updated in Stata dofile comments,resident from 2 to 1 based on pt lives overseas.
	20141149 T1 - updated in Stata dofile comments based on ineligible dx in path rpt.
	20141172 T1 - updated in Stata dofile comments to correct spelling from 'inelgible' to 'ineligible' as check will not pick it up.
	20141194 T1 - updated in Stata dofile comments based on ineligible dx in path rpt.
	20141198 T1 - updated in Stata dofile comments based on ineligible dx in path rpt.
	20141199 T1 - updated in Stata dofile comments based on ineligible dx in path rpt.
	20141208 T1 - updated in Stata dofile comments based on ineligible dx in path rpt.
	20141214 T1 - updated in Stata dofile comments based on ineligible dx in path rpt.
	20145150 T1 - updated in Stata dofile comments based on ineligible dx in path rpt.
*/
count if recstatus==3 & (!strmatch(strlower(comments), "*eli*")) //20; 18
list pid cr5id dxyr ttda recstatus if recstatus==3 & (!strmatch(strlower(comments), "*eli*"))
replace comments="29AUG18_SF Ineligible Dx in 2010 - Pth Rpt 2599-10. No F/U Needed. Incidence date chosen is that of RT registration date on S2. Abstracted from Database." if pid=="20140130" //2 changes
replace comments="24SEP18 JC: T3 Ineligible-no malignancy. No F/U Needed. IHC report added. F/U Needed with IPS for IHC report confirming NHL differentiation. Abstracted from Database. 25AUG17 SF Merged with Duplicates. Hosp # updated from 99 to 24217." if pid=="20140394" //3 changes
replace comments="24SEP18 JC: T3 Ineligible-dx overseas. 14MAY18_KWG Notes seen in Haem Clinic, notes state Pt was diagnosed in the USA, year not given. Pt continued treatment in Barbados after returning here to reside. Record status updated. F/U Needed with Qeh Colposcopy Clinic to determine DLC, IncidenceDate and Basis of Diagnosis." if pid=="20140801" //1 change
replace resident=2 if pid=="20140801" //1 change
replace comments="24SEP18 JC: T3 Ineligible-in-situ ca, no malignancy. 27FEB18_SF Birth Date added." if pid=="20140968" //1 change
replace comments="29MAR18_SF Ineligible, no malignancy mentioned." if pid=="20140982" //1 change
replace comments="24SEP18 JC: T1 Ineligible-no malignancy. 27FEB18_SF Birth Date added. ?Final Dx." if pid=="20141023" //1 change
replace comments="24SEP18 JC: T1 Ineligible-not resident. 02JUL18_TH Dr. Lewis nurse said Pt is a Barbadian resident but lives in Tortola. Address: Road Town, Tortola. 27FEB18_SF Birth Date added. 2FEB17 SF Found further notes at I Lewis - Pt was not resident in the 6 months prior to Dx, was residing in Tortola. Rpt seen in pt notes.26Jan17_KWG CT Scan of the chest seen at Dr I Lewis. CT Barbados (#16939) IMPRESSION: 1. Right, lower, outer breast mass consistent with carcinoma. There is one suspect lymph node in the right axilla. Pt address listed as Carrot Bay Tortola, ?address." if pid=="20141098" //2 changes
replace resident=2 if pid=="20141098" //2 changes
replace comments="24SEP18 JC: T1 Ineligible-no malignancy. 27FEB18_SF Birth Date added. ? Final dx." if pid=="20141149" //1 change
replace comments="30APR18_KWG Case ineligible, no cancer diagnosis seen. Record status updated. ? Final dx." if pid=="20141172" //1 change
replace comments="24SEP18 JC: T1 Ineligible-no malignancy. 30APR18_KWG Diagnosis negative for cancer, record status updated. ? Final dx." if pid=="20141194" //1 change
replace comments="24SEP18 JC: T1 Ineligible-no malignancy. 30APR18_KWG Diagnosis negative for malignancy, record status updated. ? Final dx." if pid=="20141198" //1 change
replace comments="24SEP18 JC: T1 Ineligible-no malignancy. 30APR18_KWG Diagnosis negative for malignancy. Record status updated. 27FEB18_SF Birth Date added. ? Final dx." if pid=="20141199" //1 change
replace comments="24SEP18 JC: T1 Ineligible-no malignancy. 30APR18_KWG Diagnosis negative for malignancy. Record status updated. 1) ? Final dx. 2) Path report states doctor is ""Ramesh"". Confirm that it is J Ramesh when notes are seen." if pid=="20141208" //1 change
replace comments="24SEP18 JC: T1 Ineligible-no malignancy. 1) ? Final dx.2) Age is blank on path report. 3) Path report states doctor as Walrond. Confirm when notes are reviewd." if pid=="20141214" //1 change
replace comments="24SEP18 JC: T1 Ineligible-no malignancy. 24JAN17 SF - Spoke to Death Records Clerk, supposed to 'Baby Of', Coroner's Report. Date of Death Added." if pid=="20145150" //1 change

** Check 49b - review all cases flagged as ineligible to check for missed 2013 cases
** JC 30oct18: In later checks I incidentally discovered missed 2013 cases so added in this new check
count if recstatus==3 & cr5id=="T1S1" //490 - contain 'true' ineligible years, need to cut down list
gen sampleyr=year(sampledate)
gen recvyr=year(recvdate)
gen rptyr=year(rptdate)
gen admyr=year(admdate)
gen dfcyr=year(dfc)
gen rtyr=year(rtdate)
** Create ID for list to indicate which field contains 2013 or 13
gen yr2013id=1 if sampleyr==2013
replace yr2013id=2 if recvyr==2013
replace yr2013id=3 if rptyr==2013
replace yr2013id=4 if admyr==2013
replace yr2013id=5 if dfcyr==2013
replace yr2013id=6 if rtyr==2013
label var yr2013id "2013 ID"
label define yr2013id_lab 1 "sampleyr" 2 "recvyr" 3 "rptyr" ///
					      4 "admyr" 5 "dfcyr" 6 "rtyr" ,modify
label values yr2013id yr2013id_lab
gen txt2013id=1 if regexm(comments, "13")
replace txt2013id=2 if regexm(clindets, "13")
label var txt2013id "2013 in Text"
label define txt2013id_lab 1 "comments" 2 "clindets" ,modify
label values txt2013id txt2013id_lab
** Create list
count if recstatus==3 & (sampleyr==2013|recvyr==2013|rptyr==2013|admyr==2013|dfcyr==2013|rtyr==2013|regexm(comments, "13")) //82; 87
list pid yr2013id txt2013id cr5id if recstatus==3 & (sampleyr==2013|recvyr==2013|rptyr==2013|admyr==2013|dfcyr==2013|rtyr==2013|regexm(comments, "13"))
/* 
After checking my incidentally found missed 2013 cases I realized the above list is leaving out a case(missing confirmed 2014 case (20140120) that was dx in 2013) so modified code to below
Review all cases where comments/date fields contain '2013' to check for missed 2013 cases
Check 'Comments' field for above list of cases in main CR5 db
*/
count if sampleyr==2013|recvyr==2013|rptyr==2013|admyr==2013|dfcyr==2013|rtyr==2013|regexm(comments, "13") //179; 184
list pid yr2013id txt2013id cr5id if sampleyr==2013|recvyr==2013|rptyr==2013|admyr==2013|dfcyr==2013|rtyr==2013|regexm(comments, "13")
/* 
JC emailed KWG/SAF re missing TT & ST records for 20141529,20145093,20145099 - on 30oct18 KWG abstracted 20141529, 20145093 as 2014 cases since these were 
eligible but missed abstractions; However, JC noticed on visual review of 20155093 in main CR5db that KWG incorrectly abstracted 20145093 as 2014 case but 
it's a 2013 case according to clinical details of path rpt.
So updated 49b list as noted below:
*/

count if sampleyr==2013|recvyr==2013|rptyr==2013|admyr==2013|dfcyr==2013|rtyr==2013|regexm(comments, "13")|regexm(clindets, "13") //212; 217
list pid yr2013id txt2013id cr5id if sampleyr==2013|recvyr==2013|rptyr==2013|admyr==2013|dfcyr==2013|rtyr==2013|regexm(comments, "13")|regexm(clindets, "13")
** Abstract 2013 cases here in preparation for creating a dataset with missed 2013 cases to then append to new version of already analysed 2013 dataset
** One case, 20130398 T2, is an incorrect CR5db merge (ca endometrium but pt is male) so emailed KWG cc NS, SAF to f/u at source listed in T2S1 so can abstract
/*
Review steps for this list are:
(1) Check comments field in CR5db
(2) Check this dofile to see if pid already flagged elsewhere
(3) Check for patient in MasterDb - 3 discovered in MasterDb and dx in 2012 so below code updated 14nov18
	20141164
	20141551
	20141566
	20145093
(4) Highlight in purple on hardcopy list the missed 2013 cases
(5) Highlight in yellow on hardcopy list the missed 2014 cases
*/
replace cstatus=3 if pid=="20145093" //1 change
replace recstatus=3 if pid=="20145093" //1 change
replace dot=d(30jun2012) if pid=="20145093" //1 change
replace dxyr=2012 if pid=="20145093" //1 change

replace dxyr=2013 if pid=="20130176" & regexm(cr5id,"T2") //1 change

replace hx="ADENOCARCINOMA IN VILLOUS ADENOMA" if pid=="20130275" & regexm(cr5id,"T3") //1 change
replace morph=8261 if pid=="20130275" & regexm(cr5id,"T3") //1 change
replace morphcat=6 if pid=="20130275" & regexm(cr5id,"T3") //0 changes

replace dxyr=2013 if pid=="20130286" & regexm(cr5id,"T2") //1 change

replace dxyr=2013 if pid=="20130298" & regexm(cr5id,"T2") //1 change

replace dxyr=2013 if pid=="20130316" & regexm(cr5id,"T2") //1 change

replace dot=d(31dec2013) if pid=="20130338" & regexm(cr5id,"T1") //2 changes
replace dxyr=2013 if pid=="20130338" & regexm(cr5id,"T1") //2 changes

replace dxyr=2013 if pid=="20130341" & (regexm(cr5id,"T2")|regexm(cr5id,"T3")|regexm(cr5id,"T4")) //3 changes

replace dxyr=2013 if pid=="20130357" & regexm(cr5id,"T3") //1 change

replace dot=d(30jun2006) if pid=="20140023" & regexm(cr5id,"T1") //2 changes
replace dxyr=2006 if pid=="20140023" & regexm(cr5id,"T1") //2 changes
replace basis=7 if pid=="20140023" & regexm(cr5id,"T1") //2 changes

replace cstatus=1 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace mpseq=0 if pid=="20140178" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20140178" & regexm(cr5id, "T1") //0 changes
replace primarysite="PROSTATE" if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace topography=619 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace top="619" if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace topcat=53 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140178" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace basis=9 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace staging=7 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace dot=d(15dec2013) if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140178" & regexm(cr5id, "T1") //1 change
replace rx1=9 if pid=="20140178" & regexm(cr5id, "T1") //1 change

replace notesseen=3 if pid=="20140195" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2009) if pid=="20140195" & regexm(cr5id, "T1") //1 change
replace dxyr=2009 if pid=="20140195" & regexm(cr5id, "T1") //1 change

replace notesseen=3 if pid=="20140196" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2012) if pid=="20140196" & regexm(cr5id, "T1") //1 change
replace dxyr=2012 if pid=="20140196" & regexm(cr5id, "T1") //1 change

replace notesseen=3 if pid=="20140197" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2009) if pid=="20140197" & regexm(cr5id, "T1") //1 change
replace dxyr=2009 if pid=="20140197" & regexm(cr5id, "T1") //1 change

replace notesseen=3 if pid=="20140198" & regexm(cr5id, "T1") //1 change
replace resident=9 if pid=="20140198" & regexm(cr5id, "T1") //0 changes - already corrected in Check 39 
replace dot=d(30jun2009) if pid=="20140198" & regexm(cr5id, "T1") //1 change
replace dxyr=2009 if pid=="20140198" & regexm(cr5id, "T1") //1 change

replace notesseen=3 if pid=="20140199" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2011) if pid=="20140199" & regexm(cr5id, "T1") //1 change
replace dxyr=2011 if pid=="20140199" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace mpseq=0 if pid=="20140202" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20140202" & regexm(cr5id, "T1") //0 changes
replace primarysite="UNKNOWN" if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace topography=809 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace top="809" if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace topcat=70 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace hx="METASTATIC CARCINOMA" if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140202" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace staging=9 if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace dot=dlc if pid=="20140202" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140202" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace mpseq=0 if pid=="20140204" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20140204" & regexm(cr5id, "T1") //0 changes
replace primarysite="PANCREAS" if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace topography=259 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace top="259" if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace topcat=26 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace hx="CANCER" if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace morph=8000 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace morphcat=1 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140204" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace basis=9 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace staging=7 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace dot=d(15dec2013) if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace dxyr=2013 if pid=="20140204" & regexm(cr5id, "T1") //2 changes
replace consultant=certifier if pid=="20140204" & regexm(cr5id, "T1") //1 change
replace rx1=9 if pid=="20140204" & regexm(cr5id, "T1") //2 changes

replace cstatus=1 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace recstatus=1 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace notesseen=3 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace checkstatus=1 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace mpseq=1 if pid=="20140207" & regexm(cr5id, "T1") //0 changes
replace mptot=2 if pid=="20140207" & regexm(cr5id, "T1") //0 changes
replace primarysite="BREAST-UPPER" if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace topography=508 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace top="508" if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace topcat=43 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace hx="IN-SITU & INVASIVE DUCTAL CARCINOMA" if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace morph=8500 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace morphcat=10 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace lat=1 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace latcat=31 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace beh=3 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace grade=9 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace basis=7 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace staging=7 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace dot=d(15nov2013) if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace dxyr=2013 if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace consultant="S JACKMAN" if pid=="20140207" & regexm(cr5id, "T1") //3 changes
replace rx1=9 if pid=="20140207" & regexm(cr5id, "T1") //3 changes

replace cstatus=1 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace mpseq=0 if pid=="20140211" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20140211" & regexm(cr5id, "T1") //0 changes
replace primarysite="BREAST" if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace topography=509 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace top="509" if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace topcat=43 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace lat=9 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace latcat=31 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace beh=3 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace basis=9 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace staging=9 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace dot=d(15dec2013) if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140211" & regexm(cr5id, "T1") //1 change
replace rx1=9 if pid=="20140211" & regexm(cr5id, "T1") //1 change

replace notesseen=1 if pid=="20140354" & regexm(cr5id, "T1") //1 change
replace nsdate=d(04apr2017) if pid=="20140354" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2011) if pid=="20140354" & regexm(cr5id, "T1") //1 change
replace dxyr=2011 if pid=="20140354" & regexm(cr5id, "T1") //1 change

replace grade=9 if pid=="20140395" & regexm(cr5id, "T1") //1 change
replace staging=1 if pid=="20140395" & regexm(cr5id, "T1") //1 change
replace dot=d(13jan2013) if pid=="20140395" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20140395" & regexm(cr5id, "T1") //1 change

replace notesseen=3 if pid=="20140409" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2012) if pid=="20140409" & regexm(cr5id, "T1") //1 change
replace dxyr=2012 if pid=="20140409" & regexm(cr5id, "T1") //1 change

replace notesseen=3 if pid=="20140495" & regexm(cr5id, "T1") //2 changes
replace dot=d(15nov2011) if pid=="20140495" & regexm(cr5id, "T1") //2 changes
replace dxyr=2011 if pid=="20140495" & regexm(cr5id, "T1") //2 changes

replace notesseen=3 if pid=="20140528" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2011) if pid=="20140528" & regexm(cr5id, "T1") //1 change
replace dxyr=2011 if pid=="20140528" & regexm(cr5id, "T1") //1 change

replace notesseen=3 if pid=="20140547" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2011) if pid=="20140547" & regexm(cr5id, "T1") //1 change
replace dxyr=2011 if pid=="20140547" & regexm(cr5id, "T1") //1 change

replace nsdate=d(24jul2018) if pid=="20140560" & regexm(cr5id, "T1") //1 change
replace beh=1 if pid=="20140560" & regexm(cr5id, "T1") //1 change
replace basis=9 if pid=="20140560" & regexm(cr5id, "T1") //1 change
replace dot=d(02oct2014) if pid=="20140560" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace init="99" if pid=="20140687" & regexm(cr5id, "T1") //0 changes - already corrected in above check
replace resident=9 if pid=="20140687" & regexm(cr5id, "T1") //0 changes - already corrected in above check
replace slc=1 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace dlc=d(09apr2014) if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace mpseq=0 if pid=="20140687" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20140687" & regexm(cr5id, "T1") //0 changes
replace parish=99 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace addr="99" if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace age=55 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace primarysite="SKIN,NOS" if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace topography=449 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace top="449" if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace topcat=39 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace hx="MYCOSIS FUNGOIDES" if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace morph=9700 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace morphcat=44 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140687" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace basis=7 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace staging=9 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace dot=d(18sep2013) if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace consultant="J CLARKE" if pid=="20140687" & regexm(cr5id, "T1") //1 change
replace rx1=9 if pid=="20140687" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace notesseen=1 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace nsdate=d(26jun2018) if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace init="E" if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace slc=1 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace dlc=d(21mar2013) if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace mpseq=0 if pid=="20140723" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20140723" & regexm(cr5id, "T1") //0 changes
replace parish=10 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace addr="99" if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace age=33 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace primarysite="THYROID" if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace topography=739 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace top="739" if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace topcat=65 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace hx="PAPILLARY CARCINOMA" if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace morph=8260 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace morphcat=6 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140723" & regexm(cr5id, "T1") //0 changes
replace latcat=0 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace beh=3 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace basis=7 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace staging=1 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace dot=d(17jan2013) if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace consultant="V CLARKE" if pid=="20140723" & regexm(cr5id, "T1") //1 change
replace rx1=9 if pid=="20140723" & regexm(cr5id, "T1") //1 change

replace resident=2 if pid=="20140738" & regexm(cr5id, "T1") //1 change
replace slc=1 if pid=="20140738" & regexm(cr5id, "T1") //1 change
replace dlc=d(16jul2014) if pid=="20140738" & regexm(cr5id, "T1") //1 change
replace recstatus=4 if pid=="20140738" & regexm(cr5id, "T2") //1 change
replace recstatus=4 if pid=="20140738" & regexm(cr5id, "T3") //1 change

replace grade=9 if pid=="20140763" & regexm(cr5id, "T1") //5 changes

replace cstatus=1 if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace mpseq=0 if pid=="20140891" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20140891" & regexm(cr5id, "T1") //0 changes
replace primarysite="CECUM" if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace topography=180 if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace top="180" if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace topcat=19 if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace hx="NEUROENDOCRINE TUMOUR" if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace morph=8000 if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace morphcat=1 if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140891" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace basis=7 if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace dot=d(24nov2014) if pid=="20140891" & regexm(cr5id, "T1") //2 changes
replace consultant="E SPRINGER-CYRUS" if pid=="20140891" & regexm(cr5id, "T1") //2 changes

replace hx="ADENOCARCINOMA MUCINOUS VARIANT" if pid=="20140893" & regexm(cr5id, "T1") //3 changes
replace morph=8480 if pid=="20140893" & regexm(cr5id, "T1") //3 changes
replace morphcat=9 if pid=="20140893" & regexm(cr5id, "T1") //3 changes

replace notesseen=3 if pid=="20140894" & regexm(cr5id, "T1") //2 changes
replace resident=2 if pid=="20140894" & regexm(cr5id, "T1") //2 changes
replace slc=1 if pid=="20140894" & regexm(cr5id, "T1") //2 changes
replace dlc=d(10oct2014) if pid=="20140894" & regexm(cr5id, "T1") //2 changes

replace hx="INFILTRATING DUCT CARCINOMA, FOCAL MUCINOUS FEATURES" if pid=="20140924" & regexm(cr5id, "T1") //3 changes
replace morph=8523 if pid=="20140924" & regexm(cr5id, "T1") //3 changes
replace morphcat=10 if pid=="20140924" & regexm(cr5id, "T1") //0 changes
replace lat=1 if pid=="20140924" & regexm(cr5id, "T1") //3 changes
replace grade=2 if pid=="20140924" & regexm(cr5id, "T1") //3 changes

replace notesseen=3 if pid=="20140964" & regexm(cr5id, "T1") //1 change
replace resident=2 if pid=="20140964" & regexm(cr5id, "T1") //1 change
replace slc=1 if pid=="20140964" & regexm(cr5id, "T1") //1 change
replace dlc=d(14mar2014) if pid=="20140964" & regexm(cr5id, "T1") //1 change

replace notesseen=3 if pid=="20141010" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun2005) if pid=="20141010" & regexm(cr5id, "T1") //2 changes
replace dxyr=2005 if pid=="20141010" & regexm(cr5id, "T1") //2 changes

replace cstatus=1 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace init="99" if pid=="20141012" & regexm(cr5id, "T1") //0 changes
replace resident=1 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace slc=1 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace dlc=d(22jan2014) if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace mpseq=0 if pid=="20141012" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20141012" & regexm(cr5id, "T1") //0 changes
replace parish=99 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace addr="99" if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace age=66 if pid=="20141012" & regexm(cr5id, "T1") //0 changes
replace primarysite="SKIN-CHEST" if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace topography=445 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace top="445" if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace topcat=39 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace hx="FOCALLY INVASIVE MALIGNANT MELANOMA ARISING IN IN-SITU MELANOMA" if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace morph=8720 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace morphcat=16 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace lat=1 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace latcat=24 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace beh=3 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace basis=7 if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace dot=d(22jan2014) if pid=="20141012" & regexm(cr5id, "T1") //1 change
replace consultant="C WARNER" if pid=="20141012" & regexm(cr5id, "T1") //1 change

replace notesseen=3 if pid=="20141037" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2002) if pid=="20141037" & regexm(cr5id, "T1") //1 change
replace dxyr=2002 if pid=="20141037" & regexm(cr5id, "T1") //1 change

replace grade=9 if pid=="20141130" & regexm(cr5id, "T1") //2 changes
replace staging=9 if pid=="20141130" & regexm(cr5id, "T1") //2 changes
replace dot=d(15nov2013) if pid=="20141130" & regexm(cr5id, "T1") //2 changes
replace dxyr=2013 if pid=="20141130" & regexm(cr5id, "T1") //2 changes
replace rx1=9 if pid=="20141130" & regexm(cr5id, "T1") //2 changes

replace notesseen=1 if pid=="20141153" & regexm(cr5id, "T1") //1 change
replace nsdate=d(27jun2018) if pid=="20141153" & regexm(cr5id, "T1") //1 change
replace resident=2 if pid=="20141153" & regexm(cr5id, "T1") //1 change
replace slc=1 if pid=="20141153" & regexm(cr5id, "T1") //1 change
replace dlc=d(04feb2014) if pid=="20141153" & regexm(cr5id, "T1") //1 cha

replace nsdate=d(26jun2018) if pid=="20141163" & regexm(cr5id, "T1") //3 changes
replace staging=2 if pid=="20141163" & regexm(cr5id, "T1") //3 changes

replace dot=d(30jun2012) if pid=="20141164" & regexm(cr5id, "T1") //1 change
replace dxyr=2012 if pid=="20141164" & regexm(cr5id, "T1") //1 change

** Below case was missed merge in CR5db as pt already abstracted in 20130865
replace nsdate=d(24jul2018) if pid=="20141171" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2012) if pid=="20141171" & regexm(cr5id, "T1") //1 change
replace dxyr=2012 if pid=="20141171" & regexm(cr5id, "T1") //1 change

replace notesseen=3 if pid=="20141282" & regexm(cr5id, "T1") //3 changes
replace dot=d(30jun2011) if pid=="20141282" & regexm(cr5id, "T1") //3 changes
replace dxyr=2011 if pid=="20141282" & regexm(cr5id, "T1") //3 changes

replace grade=1 if pid=="20141309" & regexm(cr5id, "T1") //1 change

replace hx="SQUAMOUS CELL CARCINOMA, KERATINIZING" if pid=="20141392" & regexm(cr5id, "T1") //2 changes
replace morph=8071 if pid=="20141392" & regexm(cr5id, "T1") //2 changes
replace morphcat=3 if pid=="20141392" & regexm(cr5id, "T1") //0 changes

replace primarysite="BREAST-SUPRAAREOLAR" if pid=="20141404" & regexm(cr5id, "T1") //2 changes
replace topography=501 if pid=="20141404" & regexm(cr5id, "T1") //2 changes
replace top="501" if pid=="20141404" & regexm(cr5id, "T1") //2 changes
replace topcat=43 if pid=="20141404" & regexm(cr5id, "T1") //0 changes

replace nsdate=d(24jul2018) if pid=="20141442" & regexm(cr5id, "T1") //3 changes
replace dot=d(04apr2012) if pid=="20141442" & regexm(cr5id, "T1") //3 changes
replace dxyr=2012 if pid=="20141442" & regexm(cr5id, "T1") //3 changes

replace nsdate=d(13jul2018) if pid=="20141496" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun2010) if pid=="20141496" & regexm(cr5id, "T1") //2 changes
replace dxyr=2010 if pid=="20141496" & regexm(cr5id, "T1") //2 changes

replace basis=6 if pid=="20141509" & regexm(cr5id, "T1") //2 changes

replace notesseen=1 if pid=="20141538" & regexm(cr5id, "T1") //2 changes
replace nsdate=d(10jul2018) if pid=="20141538" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun2012) if pid=="20141538" & regexm(cr5id, "T1") //2 changes
replace dxyr=2012 if pid=="20141538" & regexm(cr5id, "T1") //2 changes

replace notesseen=1 if pid=="20141539" & regexm(cr5id, "T1") //1 change
replace nsdate=d(10jul2018) if pid=="20141539" & regexm(cr5id, "T1") //1 change
replace beh=0 if pid=="20141539" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20141540" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20141540" & regexm(cr5id, "T1") //1 change
replace notesseen=1 if pid=="20141540" & regexm(cr5id, "T1") //1 change
replace nsdate=d(10jul2018) if pid=="20141540" & regexm(cr5id, "T1") //1 change
replace basis=7 if pid=="20141540" & regexm(cr5id, "T1") //1 change
replace staging=9 if pid=="20141540" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2013) if pid=="20141540" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20141540" & regexm(cr5id, "T1") //1 change
replace rx1=9 if pid=="20141540" & regexm(cr5id, "T1") //1 change
replace rx1d=. if pid=="20141540" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace nsdate=d(23jul2018) if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace mpseq=0 if pid=="20141542" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20141542" & regexm(cr5id, "T1") //0 changes
replace addr="99" if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace age=71 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace primarysite="KIDNEY" if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace topography=649 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace top="649" if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace topcat=56 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace hx="RENAL CELL CARCINOMA" if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace morph=8312 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace morphcat=6 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace lat=9 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace latcat=37 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace beh=3 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace basis=9 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace staging=9 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace dot=d(26sep2013) if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace consultant="W CLARKE" if pid=="20141542" & regexm(cr5id, "T1") //1 change
replace rx1=9 if pid=="20141542" & regexm(cr5id, "T1") //1 change

replace dot=d(06nov2012) if pid=="20141551" & regexm(cr5id, "T1") //1 change
replace dxyr=2012 if pid=="20141551" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20141553" & regexm(cr5id, "T1") //2 changes
replace nsdate=d(24jul2018) if pid=="20141553" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20141553" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20141553" & regexm(cr5id, "T1") //0 changes
replace mpseq=0 if pid=="20141553" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20141553" & regexm(cr5id, "T1") //0 changes
replace staging=9 if pid=="20141553" & regexm(cr5id, "T1") //2 changes
replace dot=d(22jul2013) if pid=="20141553" & regexm(cr5id, "T1") //2 changes
replace dxyr=2013 if pid=="20141553" & regexm(cr5id, "T1") //2 changes
replace rx1=9 if pid=="20141553" & regexm(cr5id, "T1") //2 changes
replace rx1d=. if pid=="20141553" & regexm(cr5id, "T1") //2 changes

replace cstatus=1 if pid=="20141558" & regexm(cr5id, "T1") //1 change
replace notesseen=1 if pid=="20141558" & regexm(cr5id, "T1") //1 change
replace nsdate=d(26jun2018) if pid=="20141558" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20141558" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20141558" & regexm(cr5id, "T1") //0 changes
replace mpseq=0 if pid=="20141558" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20141558" & regexm(cr5id, "T1") //0 changes
replace lat=0 if pid=="20141558" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20141558" & regexm(cr5id, "T1") //0 changes
replace staging=9 if pid=="20141558" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2013) if pid=="20141558" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20141558" & regexm(cr5id, "T1") //1 change
replace rx1=9 if pid=="20141558" & regexm(cr5id, "T1") //1 change
replace rx1d=. if pid=="20141558" & regexm(cr5id, "T1") //1 change

replace notesseen=1 if pid=="20141562" & regexm(cr5id, "T1") //2 changes
replace nsdate=d(06jul2018) if pid=="20141562" & regexm(cr5id, "T1") //2 changes
replace morph=8342 if pid=="20141562" & regexm(cr5id, "T1") //2 changes

replace notesseen=1 if pid=="20141563" & regexm(cr5id, "T1") //2 changes
replace nsdate=d(24jan2017) if pid=="20141563" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun2012) if pid=="20141563" & regexm(cr5id, "T1") //2 changes
replace dxyr=2012 if pid=="20141563" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2010) if pid=="20141564" & regexm(cr5id, "T1") //2 changes
replace dxyr=2010 if pid=="20141564" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2012) if pid=="20141566" & regexm(cr5id, "T1") //2 changes
replace dxyr=2012 if pid=="20141566" & regexm(cr5id, "T1") //2 changes

replace cstatus=1 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace recstatus=1 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace checkstatus=1 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace mpseq=0 if pid=="20145009" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20145009" & regexm(cr5id, "T1") //0 changes
replace primarysite="RECTUM" if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace topography=209 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace top="209" if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace topcat=21 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace hx="ADENOCARCINOMA" if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace morph=8140 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace morphcat=6 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace lat=0 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace latcat=0 if pid=="20145009" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace grade=9 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace basis=7 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace staging=9 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace dot=d(24dec2013) if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace dxyr=2013 if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace consultant="M WALROND/S GRIFFITH" if pid=="20145009" & regexm(cr5id, "T1") //3 changes
replace rx1=9 if pid=="20145009" & regexm(cr5id, "T1") //3 changes

replace notesseen=1 if pid=="20145101" & regexm(cr5id, "T1") //1 change
replace nsdate=d(28jun2018) if pid=="20145101" & regexm(cr5id, "T1") //1 change
replace mpseq=0 if pid=="20145101" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20145101" & regexm(cr5id, "T1") //0 changes
replace lat=0 if pid=="20145101" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20145101" & regexm(cr5id, "T1") //0 changes
replace staging=7 if pid=="20145101" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2013) if pid=="20145101" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20145101" & regexm(cr5id, "T1") //1 change
replace rx1=9 if pid=="20145101" & regexm(cr5id, "T1") //1 change

replace resident=1 if pid=="20145118" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace notesseen=3 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace lname="SCANTLEBURY" if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace recstatus=1 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace checkstatus=1 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace mpseq=0 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace mptot=1 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace primarysite="ENDOMETRIUM" if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace topography=541 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace top="541" if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace topcat=47 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace hx="VILLOGLANDULAR CARCINOMA" if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace morph=8262 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace morphcat=6 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace lat=0 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace latcat=0 if pid=="20145138" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace grade=9 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace basis=7 if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace dot=d(12mar2014) if pid=="20145138" & regexm(cr5id, "T1") //3 changes
replace consultant="C CHASE" if pid=="20145138" & regexm(cr5id, "T1") //3 changes


*********************
** TT Check Status **
*********************
** This is auto-generated by CR5 while simultaneously allowing for manual input so
** there will never be any records with missing recstatus

** Check 50 - invalid (checkstatus=notdone;recstatus=pend/confirm;primarysite<>blank)
count if checkstatus==0 & recstatus<2 & primarysite!="" //0
list pid dxyr checkstatus recstatus cr5id if checkstatus==0 & recstatus<2 & primarysite!=""

** Check 51 - invalid (checkstatus=invalid;recstatus=pend/confirm;primarysite<>blank)
count if checkstatus==3 & recstatus<2 & primarysite!="" //3 - no age/DOB and not in death data so cannot confirm
list pid dxyr checkstatus recstatus cr5id if checkstatus==3 & recstatus<2 & primarysite!=""

** MP Sequence
** Auto-generated by CR5 but may be need later on.

** MP Total
** Auto-generated by CR5 but may be need later on.

** Tumour record updated by
** Auto-generated by CR5 but may be needed when assigning who last accessed record.

** Date tumour record updated
** Auto-generated by CR5 but may be needed when assigning who last accessed record.

************************
** TT Data Abstractor **
************************
** Check 52 - missing
count if ttda==. & primarysite!="" //0

** Length check not needed as this field is numeric
** Check 53 - invalid code
count if ttda!=. & ttda>14 & (ttda!=22 & ttda!=88 & ttda!=98 & ttda!=99) //0
list pid ttda cr5id if ttda!=. & ttda>14 & (ttda!=22 & ttda!=88 & ttda!=98 & ttda!=99)

**********************
** Abstraction Date **
**********************
** Check 54 - missing
count if ttdoa==. & primarysite!="" //0

** Check 55 - invalid (future date)
gen currentd=c(current_date)
gen double currentdatett=date(currentd, "DMY", 2017)
drop currentd
format currentdatett %dD_m_CY
label var currentdatett "Current date TT"
count if ttdoa!=. & ttdoa>currentdatett //0
list pid eid ttdoa currentdatett cr5id if ttdoa!=. & ttdoa>currentdatett

************
** Parish **
************
** Check 56 - missing
count if parish==. & addr!="" //0
list pid parish addr cr5id if parish==. & addr!=""

*************
** Address **
*************
** Check 57 - missing
count if addr=="" & parish!=. & cstatus!=0 & cr5id=="T1S1" //10
list pid parish addr sourcename recstatus cr5id if addr=="" & parish!=. & cstatus!=0 & cr5id=="T1S1"
** JC 24sep18: Address corrections done using Electoral list
replace addr="2 BUSH HILL" if pid=="20140803" & regexm(cr5id, "T1") //3 changes
replace parish=08 if pid=="20140803" & regexm(cr5id, "T1") //3 changes
replace addr="22 HOTHERSAL TERRACE" if pid=="20140805" & regexm(cr5id, "T1") //3 changes
replace parish=08 if pid=="20140805" & regexm(cr5id, "T1") //3 changes
replace addr="FAIRVIEW" if pid=="20145097" & regexm(cr5id, "T1") //2 changes
replace parish=10 if pid=="20145097" & regexm(cr5id, "T1") //2 changes
** JC 24sep18: Address changed to "99" where recstatus=inelig.
replace addr="99" if addr=="" & parish!=. & cstatus!=0 & cr5id=="T1S1" & recstatus==3 //7 changes

**********	
**	Age **
**********
** Check 58 - missing
count if (age==-1 | age==.) & dot!=. //3-no age/DOB and not in death data so cannot confirm (20141167, 20141510, 20145025)
list pid cr5id if (age==-1 | age==.) & dot!=.
replace age=999 if pid=="20141167" & regexm(cr5id, "T1") //1 change
replace age=999 if pid=="20141510" //1 change
replace age=999 if pid=="20145025" //1 change

** Check 59 - invalid (age<>incidencedate-dob); checked no errors
** Age (at INCIDENCE - to nearest year)
gen ageyrs = (dot - dob)/365.25 //
gen checkage=int(ageyrs)
drop ageyrs
label var checkage "Age in years at INCIDENCE"
count if dob!=. & dot!=. & age!=checkage //4 - these correct according to CR5 as same day & month for dob & dot
count if (dobday!=dotday & dobmonth!=dotmonth) & dob!=. & dot!=. & age!=checkage //0
list pid dotday dobday dotmonth dobmonth if (dobday!=dotday & dobmonth!=dotmonth) & dob!=. & dot!=. & age!=checkage
list pid dot dob dotday dobday dotmonth dobmonth age checkage cr5id if dob!=. & dot!=. & age!=checkage


******************
** Primary Site **
******************
** Check 61 - missing
count if primarysite=="" & topography!=. //0
list pid primarysite topography cr5id if primarysite=="" & topography!=.

** Check 63 - invalid(primarysite<>top)
** Used category created in 1_prep_cancer.do for this check but
** will need to update when the below list code is re-run to ensure all possible
** errors are checked
sort topography pid
count if topcheckcat!=. //48
list pid primarysite topography cr5id if topcheckcat!=.

/* 
Below cases are incorrect data that have been cleaned in Stata or MPs that were missed by cancer team at abstraction and should have been abstracted.
JC 25sep2018 corrected below as NS instructed for 2014 data cleaning I will clean data but for the future SDA to clean data:
*/
** List #1
list pid primarysite topography cr5id if ///
		regexm(primarysite, "LIP") & !(strmatch(strupper(primarysite), "*SKIN*")|strmatch(strupper(primarysite), "*CERVIX*")) & (topography>9&topography!=148) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==8 ///
		| regexm(primarysite, "TONGUE") & (topography<19|topography>29) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==28 ///
		| regexm(primarysite, "GUM") & (topography<30|topography>39) & !(strmatch(strupper(primarysite), "*SKIN*")) ///
		| regexm(primarysite, "MOUTH") & (topography<40|topography>69) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==48 ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==58 ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==68 ///
		| regexm(primarysite, "GLAND") & (topography<79|topography>89) & !(strmatch(strupper(primarysite), "*MINOR*")|strmatch(strupper(primarysite), "*PROSTATE*")|strmatch(strupper(primarysite), "*THYROID*")|strmatch(strupper(primarysite), "*PINEAL*")|strmatch(strupper(primarysite), "*PITUITARY*")) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==88 ///
		| regexm(primarysite, "TONSIL") & (topography<90|topography>99) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==98 ///
		| regexm(primarysite, "OROPHARYNX") & (topography<100|topography>109) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==108 ///
		| regexm(primarysite, "NASOPHARYNX") & (topography<110|topography>119) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==118 ///
		| regexm(primarysite, "PYRIFORM") & (topography!=129&topography!=148) ///
		| regexm(primarysite, "HYPOPHARYNX") & (topography<130|topography>139) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==138 ///
		| (regexm(primarysite, "PHARYNX") & regexm(primarysite, "OVERLAP")) & (topography!=140&topography!=148) ///		
		| regexm(primarysite, "WALDEYER") & topography!=142 ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==148 ///
		| regexm(primarysite, "PHAGUS") & !(strmatch(strupper(primarysite), "*JUNCT*")) & (topography<150|topography>159) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==158 ///
		| (regexm(primarysite, "GASTR") | regexm(primarysite, "STOMACH")) & !(strmatch(strupper(primarysite), "*GASTROINTESTINAL*")|strmatch(strupper(primarysite), "*ABDOMEN*")) & (topography<160|topography>169) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==168 ///
		| (regexm(primarysite, "NUM") | regexm(primarysite, "SMALL")) & !(strmatch(strupper(primarysite), "*STERNUM*")|strmatch(strupper(primarysite), "*MEDIA*")|strmatch(strupper(primarysite), "*POSITION*")) & (topography<170|topography>179) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==178 ///
		| regexm(primarysite, "COLON") & !(strmatch(strupper(primarysite), "*RECT*")) & (topography<180|topography>189) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==188 ///
		| regexm(primarysite, "RECTO") & topography!=199 ///
		| regexm(primarysite, "RECTUM") & !(strmatch(strupper(primarysite), "*AN*")) & topography!=209 ///
		| regexm(primarysite, "ANUS") & !(strmatch(strupper(primarysite), "*RECT*")) & (topography<210|topography>212) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")|strmatch(strupper(primarysite), "*RECT*")|strmatch(strupper(primarysite), "*AN*")|strmatch(strupper(primarysite), "*JUNCT*")) & topography==218 ///
		| (regexm(primarysite, "LIVER")|regexm(primarysite, "HEPTO")) & !(strmatch(strupper(primarysite), "*GLAND*")) & (topography<220|topography>221) ///
		| regexm(primarysite, "GALL") & topography!=239 ///
		| (regexm(primarysite, "BILI")|regexm(primarysite, "VATER")) & !(strmatch(strupper(primarysite), "*INTRAHEP*")) & (topography<240|topography>241&topography!=249) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==248 ///
		| regexm(primarysite, "PANCREA") & !(strmatch(strupper(primarysite), "*ABDOMEN*")) & (topography<250|topography>259) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==258 ///
		| (regexm(primarysite, "BOWEL") | regexm(primarysite, "INTESTIN")) & !(strmatch(strupper(primarysite), "*SMALL*")|strmatch(strupper(primarysite), "*GASTRO*")) & (topography!=260&topography!=269) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==268 ///
		| regexm(primarysite, "NASAL") & !(strmatch(strupper(primarysite), "*SIN*")) & topography!=300 ///
		| regexm(primarysite, "EAR") & !(strmatch(strupper(primarysite), "*SKIN*")|strmatch(strupper(primarysite), "*FOREARM*")) & topography!=301 ///
		| regexm(primarysite, "SINUS") & !(strmatch(strupper(primarysite), "*INTRA*")|strmatch(strupper(primarysite), "*PHARYN*")) & (topography<310|topography>319) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==318 ///
		| (regexm(primarysite, "GLOTT") | regexm(primarysite, "CORD")) & !(strmatch(strupper(primarysite), "*TRANS*")|strmatch(strupper(primarysite), "*CNS*")|strmatch(strupper(primarysite), "*SPINAL*")) & (topography<320|topography>329) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==328 ///
		| regexm(primarysite, "TRACH") & topography!=339 ///
		| (regexm(primarysite, "LUNG") | regexm(primarysite, "BRONCH")) & (topography<340|topography>349) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==348 ///
		| regexm(primarysite, "THYMUS") & topography!=379 
** JC 25sep18: Corrections for above list:
replace primarysite="STOMACH-BODY" if pid=="20130162" & regexm(cr5id, "T2") //1 change
replace topography=162 if pid=="20130162" & regexm(cr5id, "T2") //1 change
replace top="162" if pid=="20130162" & regexm(cr5id, "T2") //1 change
replace topcat=17 if pid=="20130162" & regexm(cr5id, "T2") //0 changess
replace grade=2 if pid=="20130162" & regexm(cr5id, "T2") //1 change

replace primarysite="LARGE INTESTINE-COLON,NOS" if pid=="20141073" //1 change

replace topography=259 if pid=="20145101" //1 change
replace top="259" if pid=="20145101" //1 change
replace topcat=26 if pid=="20145101" //1 change

** List #2
sort topography pid
list pid primarysite topography cr5id if ///
		(regexm(primarysite, "HEART")|regexm(primarysite, "CARD")|regexm(primarysite, "STINUM")|regexm(primarysite, "PLEURA")) & !(strmatch(strupper(primarysite), "*GASTR*")|strmatch(strupper(primarysite), "*STOMACH*")) & (topography<380|topography>384) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==388 ///
		| regexm(primarysite, "RESP") & topography!=390 ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==398 ///
		| regexm(primarysite, "RESP") & topography!=399 ///
		| regexm(primarysite, "BONE") & !(strmatch(strupper(primarysite), "*MARROW*")) & (topography<400|topography>419) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==408 ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==418 ///
		| regexm(primarysite, "BLOOD") & !(strmatch(strupper(primarysite), "*MARROW*")) & topography!=420 ///
		| regexm(primarysite, "MARROW") & topography!=421 ///
		| regexm(primarysite, "SPLEEN") & topography!=422 ///
		| regexm(primarysite, "RETICU") & topography!=423 ///
		| regexm(primarysite, "POIETIC") & topography!=424 ///
		| regexm(primarysite, "SKIN") & (topography<440|topography>449) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==448 ///
		| regexm(primarysite, "NERV") & (topography<470|topography>479) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==478 ///
		| regexm(primarysite, "PERITON") & !(strmatch(strupper(primarysite), "*NODE*")) & (topography<480|topography>482) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==488 ///
		| regexm(primarysite, "TISSUE") & (topography<490|topography>499) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==498 ///
		| regexm(primarysite, "BREAST") & !(strmatch(strupper(primarysite), "*SKIN*")) & (topography<500|topography>509) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==508 ///
		| regexm(primarysite, "VULVA") & (topography<510|topography>519) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==518 ///
		| regexm(primarysite, "VAGINA") & topography!=529 ///
		| regexm(primarysite, "CERVIX") & (topography<530|topography>539) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==538 ///
		| (regexm(primarysite, "UTERI")|regexm(primarysite, "METRIUM")) & !(strmatch(strupper(primarysite), "*CERVIX*")|strmatch(strupper(primarysite), "*UTERINE*")|strmatch(strupper(primarysite), "*OVARY*")) & (topography<540|topography>549) ///
		| regexm(primarysite, "UTERINE") & !(strmatch(strupper(primarysite), "*CERVIX*")|strmatch(strupper(primarysite), "*CORPUS*")) & topography!=559 ///
		| regexm(primarysite, "OVARY") & topography!=569 ///
		| (regexm(primarysite, "FALLOPIAN")|regexm(primarysite, "LIGAMENT")|regexm(primarysite, "ADNEXA")|regexm(primarysite, "FEMALE")) & (topography<570|topography>579) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==578 ///
		| regexm(primarysite, "PLACENTA") & topography!=589 ///
		| (regexm(primarysite, "PENIS")|regexm(primarysite, "FORESKIN")) & (topography<600|topography>609) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==608 ///
		| regexm(primarysite, "PROSTATE") & topography!=619 ///
		| regexm(primarysite, "TESTIS") & (topography<620|topography>629) ///
		| (regexm(primarysite, "EPI")|regexm(primarysite, "SPERM")|regexm(primarysite, "SCROT")|regexm(primarysite, "MALE")) & !(strmatch(strupper(primarysite), "*FEMALE*")) & (topography<630|topography>639) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==638 ///
		| regexm(primarysite, "KIDNEY") & topography!=649 ///
		| regexm(primarysite, "RENAL") & topography!=659 ///
		| regexm(primarysite, "URETER") & !(strmatch(strupper(primarysite), "*BLADDER*")) & topography!=669 ///
		| regexm(primarysite, "BLADDER") & !(strmatch(strupper(primarysite), "*GALL*")) & (topography<670|topography>679) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==678 ///
		| (regexm(primarysite, "URETHRA")|regexm(primarysite, "URINARY")) & !(strmatch(strupper(primarysite), "*BLADDER*")) & (topography<680|topography>689) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==688 ///
		| (regexm(primarysite, "EYE")|regexm(primarysite, "RETINA")|regexm(primarysite, "CORNEA")|regexm(primarysite, "LACRIMAL")|regexm(primarysite, "CILIARY")|regexm(primarysite, "CHOROID")|regexm(primarysite, "ORBIT")|regexm(primarysite, "CONJUNCTIVA")) & !(strmatch(strupper(primarysite), "*SKIN*")) & (topography<690|topography>699) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==698 ///
		| regexm(primarysite, "MENINGE") & (topography<700|topography>709) ///
		| regexm(primarysite, "BRAIN") & !strmatch(strupper(primarysite), "*MENINGE*") & (topography<710|topography>719) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==718 ///
		| (regexm(primarysite, "SPIN")|regexm(primarysite, "CAUDA")|regexm(primarysite, "NERV")) & (topography<720|topography>729) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==728 ///
		| regexm(primarysite, "THYROID") & topography!=739 ///
		| regexm(primarysite, "ADRENAL") & (topography<740|topography>749)
** JC 25sep18: Corrections for above list:
replace primarysite="BONE MARROW" if pid=="20140498" //1 change

replace primarysite="SKIN-THIGH" if pid=="20140716" & regexm(cr5id, "T1") //3 changes
replace grade=5 if pid=="20140716" & regexm(cr5id, "T1") //3 changes

replace primarysite="BONE MARROW" if pid=="20080677" & regexm(cr5id, "T2") //2 changes
replace topography=421 if pid=="20080677" & regexm(cr5id, "T2") //2 changes
replace top="421" if pid=="20080677" & regexm(cr5id, "T2") //2 changes
replace topcat=38 if pid=="20080677" & regexm(cr5id, "T2") //2 changes
replace hx="MYELOMA" if pid=="20080677" & regexm(cr5id, "T2") //2 changes
replace morph=9732 if pid=="20080677" & regexm(cr5id, "T2") //2 changes
replace morphcat=46 if pid=="20080677" & regexm(cr5id, "T2") //0 changes
replace grade=6 if pid=="20080677" & regexm(cr5id, "T2") //2 changes

replace primarysite="BREAST-OVERLAP-LOWER POLE" if pid=="20140429" & regexm(cr5id, "T1") //2 changes

replace primarysite="BREAST-OVERLAP-MEDIAL" if pid=="20140690" & regexm(cr5id, "T1") //1 change

replace primarysite="BREAST-OVERLAP-MIDLINE" if pid=="20140804" & regexm(cr5id, "T1") //1 change

replace primarysite="BREAST-RETROAREOLAR" if pid=="20140806" & regexm(cr5id, "T1") //2 changes
replace topography=501 if pid=="20140806" & regexm(cr5id, "T1") //2 changes
replace top="501" if pid=="20140806" & regexm(cr5id, "T1") //2 changes
replace topcat=43 if pid=="20140806" & regexm(cr5id, "T1") //0 changess
replace grade=2 if pid=="20140806" & regexm(cr5id, "T1") //2 changes

replace primarysite="BREAST-OVERLAP-MIDLINE" if pid=="20140809" & regexm(cr5id, "T1") //1 change

replace primarysite="BREAST-OVERLAP-MIDLINE" if pid=="20140811" & regexm(cr5id, "T1") //1 change

replace primarysite="BREAST-OVERLAP-MIDLINE" if pid=="20140854" & regexm(cr5id, "T1") //1 change

replace primarysite="BREAST-OQ OF RETROAREOLAR" if pid=="20141029" & regexm(cr5id, "T1") //1 change
replace topography=501 if pid=="20141029" & regexm(cr5id, "T1") //1 change
replace top="501" if pid=="20141029" & regexm(cr5id, "T1") //1 change
replace topcat=43 if pid=="20141029" & regexm(cr5id, "T1") //0 changess

replace primarysite="BREAST-OVERLAP-OUTER QUADRANT" if pid=="20141052" & regexm(cr5id, "T1") //1 change

replace primarysite="BREAST-SUBAREOLAR" if pid=="20141059" & regexm(cr5id, "T1") //1 change
replace topography=501 if pid=="20141059" & regexm(cr5id, "T1") //1 change
replace top="501" if pid=="20141059" & regexm(cr5id, "T1") //1 change
replace topcat=43 if pid=="20141059" & regexm(cr5id, "T1") //0 changess

replace primarysite="BREAST-OVERLAP-MIDLINE" if pid=="20141097" & regexm(cr5id, "T1") //2 changes
replace hx="INVASIVE DUCTAL CARCINOMA, MEDULLARY PHENOTYPE" if pid=="20141097" & regexm(cr5id, "T1") //2 changes
replace morph=8523 if pid=="20141097" & regexm(cr5id, "T1") //2 changes
replace morphcat=10 if pid=="20141097" & regexm(cr5id, "T1") //0 changess

replace primarysite="BREAST-OVERLAP-OUTER HALF" if pid=="20141131" & regexm(cr5id, "T1") //1 change
replace hx="INVASIVE DUCTAL CARCINOMA, SOLID PAPILLARY,CRIBRIFORM" if pid=="20141131" & regexm(cr5id, "T1") //1 change
replace morph=8523 if pid=="20141131" & regexm(cr5id, "T1") //1 change
replace morphcat=10 if pid=="20141131" & regexm(cr5id, "T1") //0 changess

replace primarysite="BREAST-OVERLAP-INNER QUADRANT" if pid=="20141237" & regexm(cr5id, "T1") //3 changes
replace grade=3 if pid=="20141237" & regexm(cr5id, "T1") //3 changes

replace primarysite="BREAST-UOQ" if pid=="20141238" & regexm(cr5id, "T1") //2 changes
replace topography=504 if pid=="20141238" & regexm(cr5id, "T1") //2 changes
replace top="504" if pid=="20141238" & regexm(cr5id, "T1") //2 changes
replace topcat=43 if pid=="20141238" & regexm(cr5id, "T1") //0 changess
replace hx="INVASIVE DUCTAL CARCINOMA, METAPLASTIC PHENOTYPE" if pid=="20141238" & regexm(cr5id, "T1") //2 changes
replace morph=8523 if pid=="20141238" & regexm(cr5id, "T1") //2 changes
replace morphcat=10 if pid=="20141238" & regexm(cr5id, "T1") //0 changess

replace primarysite="BREAST-OVERLAP-UPPER QUADRANT" if pid=="20141338" & regexm(cr5id, "T1") //3 changes

replace primarysite="BREAST-OVERLAP-MIDLINE" if pid=="20141367" & regexm(cr5id, "T1") //4 changes

replace primarysite="BREAST-OVERLAP-MIDLINE" if pid=="20141391" & regexm(cr5id, "T1") //3 changes

replace primarysite="BREAST-CENTRAL/UNDER AREOLAR" if pid=="20141412" & regexm(cr5id, "T1") //1 change
replace topography=501 if pid=="20141412" & regexm(cr5id, "T1") //1 change
replace top="501" if pid=="20141412" & regexm(cr5id, "T1") //1 change
replace topcat=43 if pid=="20141412" & regexm(cr5id, "T1") //0 changess

replace primarysite="BREAST-OVERLAP-UPPER QUADRANT" if pid=="20145021" & regexm(cr5id, "T1") //3 changes

replace topography=619 if pid=="20140845" & regexm(cr5id, "T1") //1 change
replace top="619" if pid=="20140845" & regexm(cr5id, "T1") //1 change
replace topcat=53 if pid=="20140845" & regexm(cr5id, "T1") //0 changess

replace topography=509 if pid=="20140920" & regexm(cr5id, "T1") //2 changes
replace top="509" if pid=="20140920" & regexm(cr5id, "T1") //2 changes
replace topcat=43 if pid=="20140920" & regexm(cr5id, "T1") //2 changes


** List #3
list pid ttda primarysite topography cr5id if ///
		(regexm(primarysite, "PARATHYROID")|regexm(primarysite, "PITUITARY")|regexm(primarysite, "CRANIOPHARYNGEAL")|regexm(primarysite, "CAROTID")|regexm(primarysite, "ENDOCRINE")) & (topography<750|topography>759) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==758 ///
		| (regexm(primarysite, "NOS")|regexm(primarysite, "DEFINED")) & !(strmatch(strupper(primarysite), "*SKIN*")|strmatch(strupper(primarysite), "*NOSE*")|strmatch(strupper(primarysite), "*NOSTRIL*")|strmatch(strupper(primarysite), "*STOMACH*")|strmatch(strupper(primarysite), "*GENITAL*")|strmatch(strupper(primarysite), "*PENIS*")) & (topography<760|topography>767) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==768 ////
		| regexm(primarysite, "NODE") & (topography<770|topography>779) ///
		| !(strmatch(strupper(primarysite), "*OVERLAP*")) & topography==778 ///
		| regexm(primarysite, "UNKNOWN") & topography!=809
** JC 25sep18: Corrections for above list:
replace primarysite="BREAST" if pid=="20140980" & regexm(cr5id, "T1") //1 change
replace topography=509 if pid=="20140980" & regexm(cr5id, "T1") //1 change
replace top="509" if pid=="20140980" & regexm(cr5id, "T1") //1 change
replace topcat=43 if pid=="20140980" & regexm(cr5id, "T1") //1 change
replace lat=9 if pid=="20140980" & regexm(cr5id, "T1") //1 change
replace latcat=31 if pid=="20140980" & regexm(cr5id, "T1") //1 change
replace grade=3 if pid=="20140980" & regexm(cr5id, "T1") //1 change
replace hx="POORLY DIFFERENTIATED CARCINOMA" if pid=="20140980" & regexm(cr5id, "T1") //1 change

****************
** Topography **
****************
** Check 64 - missing
count if topography==. & primarysite!=""  //0
list pid primarysite topography cr5id if topography==. & primarysite!=""

** Check 65 - length
** Need to change all top=="." to top==""
replace top="" if top=="." //0 changess
count if top!="" & length(top)!=3 //0
list pid top topography cr5id if top!="" & length(top)!=3

** No other checks needed as covered in primarysite checks 62 & 63

****************************
** Histology & Morphology **
****************************
** Check 66 - Histology missing
count if (hx==""|hx=="99"|hx=="9999"|regexm(hx, "UNK")) & morph!=. //0
list pid hx morph cr5id if (hx==""|hx=="99"|hx=="9999"|regexm(hx, "UNK")) & morph!=.

** Check 67 - Morphology missing
count if (morph==.|morph==99|morph==9999) & hx!="" //0
list pid hx morph cr5id if (morph==.|morph==99|morph==9999) & hx!=""

** Check 68 - Morphology length
** Need to create string variable for morphology
gen morphology=morph
tostring morphology, replace
** Need to change all morphology=="." to morphology==""
replace morphology="" if morphology=="." //778 changes
count if morphology!="" & length(morphology)!=4 //0
list pid morphology morph cr5id if morphology!="" & length(morphology)!=4

** Check 70 - possibly invalid (hx vs beh)
sort pid	
count if (beh==2|beh==3) & !(strmatch(strupper(hx), "*MALIG*")|strmatch(strupper(hx), "*CANCER*")|strmatch(strupper(hx), "*OMA*") ///
		 |strmatch(strupper(hx), "*SUSPICIOUS*")|strmatch(strupper(hx), "*CIN*")|strmatch(strupper(hx), "*LEU*")|strmatch(strupper(hx), "*META*") ///
		 |strmatch(strupper(hx), "*INVAS*")|strmatch(strupper(hx), "*CARC*")|strmatch(strupper(hx), "*HIGH GRADE*")|strmatch(strupper(hx), "*ESSENTIAL*") ///
		 |strmatch(strupper(hx), "*KLATSKIN*")|strmatch(strupper(hx), "*MYELODYSPLAS*")|strmatch(strupper(hx), "*MYELOPROLIFER*") ///
		 |strmatch(strupper(hx), "*CHRONIC IDIOPATHIC*")|strmatch(strupper(hx), "*BOWEN*")|strmatch(strupper(hx), "*POLYCYTHEMIA*") ///
		 |strmatch(strupper(hx), "*WILMS*")|strmatch(strupper(hx), "*MULLERIAN*")|strmatch(strupper(hx), "*YOLK*")|strmatch(strupper(hx), "*REFRACTORY*") ///
		 |strmatch(strupper(hx), "*ACUTE MYELOID*")|strmatch(strupper(hx), "*PAGET*")|strmatch(strupper(hx), "*PLASMA CELL*") ///
		 |strmatch(strupper(hx), "*PIN III*")|strmatch(strupper(hx), "*NEUROENDOCRINE*")|strmatch(strupper(hx), "*TERATOID/RHABOID*") ///
		 |strmatch(strupper(hx), "*INTRA-EPITHELIAL NEOPLASIA*")) & hx!="CLL" & hx!="PIN" & hx!="HGCGIN /  AIS" //14
list pid hx beh cr5id if (beh==2|beh==3) & !(strmatch(strupper(hx), "*MALIG*")|strmatch(strupper(hx), "*CANCER*")|strmatch(strupper(hx), "*OMA*") ///
						 |strmatch(strupper(hx), "*SUSPICIOUS*")|strmatch(strupper(hx), "*CIN*")|strmatch(strupper(hx), "*LEU*")|strmatch(strupper(hx), "*META*") ///
						 |strmatch(strupper(hx), "*INVAS*")|strmatch(strupper(hx), "*CARC*")|strmatch(strupper(hx), "*HIGH GRADE*") ///
						 |strmatch(strupper(hx), "*ESSENTIAL*")|strmatch(strupper(hx), "*KLATSKIN*")|strmatch(strupper(hx), "*MYELODYSPLAS*") ///
						 |strmatch(strupper(hx), "*MYELOPROLIFER*")|strmatch(strupper(hx), "*CHRONIC IDIOPATHIC*")|strmatch(strupper(hx), "*BOWEN*") ///
						 |strmatch(strupper(hx), "*POLYCYTHEMIA*")|strmatch(strupper(hx), "*WILMS*")|strmatch(strupper(hx), "*MULLERIAN*") ///
						 |strmatch(strupper(hx), "*YOLK*")|strmatch(strupper(hx), "*REFRACTORY*")|strmatch(strupper(hx), "*ACUTE MYELOID*") ///
						 |strmatch(strupper(hx), "*PAGET*")|strmatch(strupper(hx), "*PLASMA CELL*")|strmatch(strupper(hx), "*PIN III*") ///
						 |strmatch(strupper(hx), "*NEUROENDOCRINE*")|strmatch(strupper(hx), "*TERATOID/RHABOID*") ///
						 |strmatch(strupper(hx), "*INTRA-EPITHELIAL NEOPLASIA*")) & hx!="CLL" & hx!="PIN" & hx!="HGCGIN /  AIS"
/* 
Below cases are incorrect data that have been cleaned in Stata or MPs that were missed by cancer team at abstraction and should have been abstracted.
JC 27sep2018 corrected below as NS instructed for 2014 data cleaning I will clean data but for the future SDA to clean data:
*/
replace beh=1 if pid=="20140060" //1 change
replace recstatus=3 if pid=="20140060" //1 change
replace cstatus=3 if pid=="20140060" //1 change
replace beh=1 if pid=="20140073" //1 change
replace recstatus=3 if pid=="20140073" //1 change
replace cstatus=3 if pid=="20140073" //1 change
replace beh=1 if pid=="20140120" //1 change
replace basis=5 if pid=="20140683" //2 changes
replace morph=9975 if pid=="20140683" //2 changes
replace morphcat=55 if pid=="20140683" //2 changes
replace recstatus=3 if pid=="20140769" //1 change
replace cstatus=3 if pid=="20140769" //1 change
replace comments="JC 27SEP18: case ineligible as VIN 3 not a reportable cancer for BNR-C.  No F/U needed. 3AUG18_SF Found in MasterDb - 2433. NF DxDAte: 20140815. DLC and INcDate changed from 20149999 to 20140515.Hosp # added. BOD changed from 9 to 5 as patient had Colpo. F/U Needed with Qeh Colposcopy Clinic for DLC, IncidenceDate and Basis of Dx." if pid=="20140769" //1 change

** Check 72 - invalid (morph vs basis)
count if morph==8000 & (basis==6|basis==7|basis==8) //0
list pid hx basis cr5id if morph==8000 & (basis==6|basis==7|basis==8)

** Check 74 - invalid(hx<>morph)
sort pid

** morphcheckcat 1: Hx=Undifferentiated Ca & Morph!=8020
count if morphcheckcat==1 //0
list pid hx morph basis cfdx cr5id if morphcheckcat==1

** morphcheckcat 2: Hx!=Undifferentiated Ca & Morph==8020
count if morphcheckcat==2 //0
list pid hx morph basis cfdx cr5id if morphcheckcat==2

** morphcheckcat 3: Hx=Papillary ca & Morph!=8050
count if morphcheckcat==3 //3
list pid hx morph top basis beh cr5id if morphcheckcat==3
replace hx="PAPILLARY CARCINOMA, FOLLICULAR VARIANT" if pid=="20141502" //3 changes

** morphcheckcat 4: Hx=Papillary serous adenoca & Morph!=8460 & Top!=ovary/peritoneum
count if morphcheckcat==4 //2 (thyroid/renal=M8260 & ovary/peritoneum=M8461 & endometrium=M8460); 0 04jul18
list pid top hx morph top basis beh cr5id if morphcheckcat==4
replace hx="SEROUS CARCINOMA" if pid=="20140707" & regexm(cr5id, "T1") //2 changes
replace morph=8441 if pid=="20140707" & regexm(cr5id, "T1") //2 changes
replace morphcat=9 if pid=="20140707" & regexm(cr5id, "T1") //2 changes
replace grade=3 if pid=="20140707" & regexm(cr5id, "T1") //2 changes

** morphcheckcat 5: Hx=Papillary & intraduct/intracyst & Morph!=8503
count if morphcheckcat==5 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==5

** morphcheckcat 6: Hx=Keratoacanthoma & Morph!=8070
count if morphcheckcat==6 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==6

** morphcheckcat 7: Hx=Squamous & microinvasive & Morph!=8076
count if morphcheckcat==7 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==7

** morphcheckcat 8: Hx=Bowen excluding clinical & basis==6/7/8 & morph!=8081 (want to check skin SCCs that have bowen disease is coded to M8081) 
count if morphcheckcat==8 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==8

** morphcheckcat 9: Hx=adenoid BCC & morph!=8098
count if morphcheckcat==9 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==9

** morphcheckcat 10: Hx=infiltrating BCC excluding nodular & morph!=8092
count if morphcheckcat==10 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==10

** morphcheckcat 11: Hx=superficial BCC excluding nodular & basis=6/7/8 & morph!=8091
count if morphcheckcat==11 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==11

** morphcheckcat 12: Hx=sclerotic/sclerosing BCC excluding nodular & morph!=8091
count if morphcheckcat==12 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==12

** morphcheckcat 13: Hx=nodular BCC excluding clinical & morph!=8097
count if morphcheckcat==13 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==13

** morphcheckcat 14: Hx!=nodular BCC excluding clinical & morph==8097
count if morphcheckcat==14 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==14

** morphcheckcat 15: Hx=BCC & SCC excluding basaloid & morph!=8094
count if morphcheckcat==15 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==15

** morphcheckcat 16: Hx!=BCC & SCC & morph==8094
count if morphcheckcat==16 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==16

** morphcheckcat 17: Hx!=transitional/urothelial & morph==8120
count if morphcheckcat==17 //1
list pid primarysite hx morph basis beh cr5id if morphcheckcat==17
replace hx="TRANSITIONAL CELL CARCINOMA" if pid=="20141309" //1 change

** morphcheckcat 18: Hx=transitional/urothelial excluding papillary & morph!=8120
count if morphcheckcat==18 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==18

** morphcheckcat 19: Hx=transitional/urothelial & papillary & morph!=8130
count if morphcheckcat==19 //0
list pid primarysite hx morph basis beh  cr5id if morphcheckcat==19

** morphcheckcat 20: Hx=villous & adenoma excluding tubulo & morph!=8261
count if morphcheckcat==20 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==20

** morphcheckcat 21: Hx=intestinal excl. stromal (GISTs) & morph!=8144
count if morphcheckcat==21 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==21

** morphcheckcat 22: Hx=villoglandular & morph!=8263
count if morphcheckcat==22 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==22

** morphcheckcat 23: Hx!=clear cell & morph==8310
count if morphcheckcat==23 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==23

** morphcheckcat 24: Hx==clear cell & morph!=8310
count if morphcheckcat==24 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==24

** morphcheckcat 25: Hx==cyst & renal & morph!=8316
count if morphcheckcat==25 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==25

** morphcheckcat 26: Hx==chromophobe & renal & morph!=8317
count if morphcheckcat==26 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==26

** morphcheckcat 27: Hx==sarcomatoid & renal & morph!=8318
count if morphcheckcat==27 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==27

** morphcheckcat 28: Hx==follicular excl.minimally invasive & morph!=8330
count if morphcheckcat==28 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==28

** morphcheckcat 29: Hx==follicular & minimally invasive & morph!=8335
count if morphcheckcat==29 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==29

** morphcheckcat 30: Hx==microcarcinoma & morph!=8341
count if morphcheckcat==30 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==30

** morphcheckcat 31: Hx!=endometrioid & morph==8380
count if morphcheckcat==31 //1 - 20140739 alredy corrected in Check 11 above.
list pid primarysite hx morph basis beh cr5id if morphcheckcat==31

** morphcheckcat 32: Hx==poroma & morph!=8409 & mptot<2
count if morphcheckcat==32 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==32

** morphcheckcat 33: Hx==serous excl. papillary & morph!=8441
count if morphcheckcat==33 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==33

** morphcheckcat 34: Hx==mucinous excl. endocervical,producing,secreting,infiltrating duct & morph!=8480
count if morphcheckcat==34 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==34

** morphcheckcat 35: Hx!=mucinous/pseudomyxoma peritonei & morph==8480
count if morphcheckcat==35 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==35

** morphcheckcat 36: Hx==acinar & duct & morph!=8552
count if morphcheckcat==36 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==36

** morphcheckcat 37: Hx==intraduct & micropapillary or intraduct & clinging & morph!=8507
count if morphcheckcat==37 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==37

** morphcheckcat 38: Hx!=intraduct & micropapillary or intraduct & clinging & morph==8507
count if morphcheckcat==38 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==38

** morphcheckcat 39: Hx!=ductular & morph==8521
count if morphcheckcat==39 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==39

** morphcheckcat 40: Hx!=duct & Hx==lobular & morph!=8520
count if morphcheckcat==40 //2 - 20141481 already corrected in Check 11
list pid primarysite hx morph basis beh cr5id if morphcheckcat==40

** morphcheckcat 41: Hx==duct & lobular & morph!=8522
count if morphcheckcat==41 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==41

** morphcheckcat 42: Hx!=acinar & morph==8550
count if morphcheckcat==42 //1 
list pid primarysite hx morph basis beh cr5id if morphcheckcat==42
replace primarysite="PROSTATE" if pid=="20140186" //1 change
replace morph=8140 if pid=="20140186" //1 change
replace morphcat=6 if pid=="20140186" //1 change

** morphcheckcat 43: Hx!=adenosquamous & morph==8560
count if morphcheckcat==43 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==43

** morphcheckcat 44: Hx!=thecoma & morph==8600
count if morphcheckcat==44 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==44

** morphcheckcat 45: Hx!=sarcoma & morph==8800
count if morphcheckcat==45 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==45

** morphcheckcat 46: Hx=spindle & sarcoma & morph!=8801
count if morphcheckcat==46 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==46

** morphcheckcat 47: Hx=undifferentiated & sarcoma & morph!=8805
count if morphcheckcat==47 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==47

** morphcheckcat 48: Hx=fibrosarcoma & Hx!=myxo/dermato/mesothelioma & morph!=8810
count if morphcheckcat==48 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==48

** morphcheckcat 49: Hx=fibrosarcoma & Hx=myxo & morph!=8811
count if morphcheckcat==49 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==49

** morphcheckcat 50: Hx=fibro & histiocytoma & morph!=8830 (see morphcheckcat=92 also!)
count if morphcheckcat==50 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==50

** morphcheckcat 51: Hx!=dermatofibrosarcoma & morph==8832
count if morphcheckcat==51 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==51

** morphcheckcat 52: Hx==stromal sarcoma high grade & morph!=8930
count if morphcheckcat==52 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==52

** morphcheckcat 53: Hx==stromal sarcoma low grade & morph!=8931
count if morphcheckcat==53 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==53

** morphcheckcat 54: Hx==gastrointestinal stromal tumour & morph!=8936
count if morphcheckcat==54 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==54

** morphcheckcat 55: Hx==mixed mullerian tumour & Hx!=mesodermal & morph!=8950
count if morphcheckcat==55 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==55

** morphcheckcat 56: Hx==mesodermal mixed & morph!=8951
count if morphcheckcat==56 //0 20mar18; 0 04jul18
list pid primarysite hx morph basis beh cr5id if morphcheckcat==56

** morphcheckcat 57: Hx==wilms or nephro & morph!=8960
count if morphcheckcat==57 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==57

** morphcheckcat 58: Hx==mesothelioma & Hx!=fibrous or sarcoma or epithelioid/papillary or cystic & morph!=9050
count if morphcheckcat==58 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==58

** morphcheckcat 59: Hx==fibrous or sarcomatoid mesothelioma & Hx!=epithelioid/papillary or cystic & morph!=9051
count if morphcheckcat==59 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==59

** morphcheckcat 60: Hx==epitheliaoid or papillary mesothelioma & Hx!=fibrous or sarcomatoid or cystic & morph!=9052
count if morphcheckcat==60 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==60

** morphcheckcat 61: Hx==biphasic mesothelioma & morph!=9053
count if morphcheckcat==61 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==61

** morphcheckcat 62: Hx==adenomatoid tumour & morph!=9054
count if morphcheckcat==62 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==62

** morphcheckcat 63: Hx==cystic mesothelioma & morph!=9055
count if morphcheckcat==63 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==63

** morphcheckcat 64: Hx==yolk & morph!=9071
count if morphcheckcat==64 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==64

** morphcheckcat 65: Hx==teratoma & morph!=9080
count if morphcheckcat==65 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==65

** morphcheckcat 66: Hx==teratoma & Hx!=metastatic or malignant or embryonal or teratoblastoma or immature & morph==9080
count if morphcheckcat==66 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==66

** morphcheckcat 67: Hx==complete hydatidiform mole & Hx!=choriocarcinoma & beh==3 & morph==9100
count if morphcheckcat==67 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==67

** morphcheckcat 68: Hx==choriocarcinoma & morph!=9100
count if morphcheckcat==68 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==68

** morphcheckcat 69: Hx==epithelioid hemangioendothelioma & Hx!=malignant & morph==9133
count if morphcheckcat==69 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==69

** morphcheckcat 70: Hx==osteosarcoma & morph!=9180
count if morphcheckcat==70 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==70

** morphcheckcat 71: Hx==chondrosarcoma & morph!=9220
count if morphcheckcat==71 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==71

** morphcheckcat 72: Hx=myxoid and Hx!=chondrosarcoma & morph==9231
count if morphcheckcat==72 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==72

** morphcheckcat 73: Hx=retinoblastoma and poorly or undifferentiated & morph==9511
count if morphcheckcat==73 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==73

** morphcheckcat 74: Hx=meningioma & Hx!=meningothelial/endotheliomatous/syncytial & morph==9531
count if morphcheckcat==74 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==74

** morphcheckcat 75: Hx=mantle cell lymphoma & morph!=9673
count if morphcheckcat==75 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==75

** morphcheckcat 76: Hx=T-cell lymphoma & Hx!=leukemia & morph!=9702
count if morphcheckcat==76 //2
list pid primarysite hx morph basis beh cr5id if morphcheckcat==76
replace hx="ADULT T-CELL LYMPHOMA HTLV-1 ASSOCIATED" if pid=="20140390" //2 changes
replace grade=5 if pid=="20140390" //2 changes

** morphcheckcat 77: Hx=non-hodgkin lymphoma & Hx!=cell (to excl. mantle, large, cleaved, small, etc) & morph!=9591
count if morphcheckcat==77 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==77

** morphcheckcat 78: Hx=precursor t-cell acute lymphoblastic leukemia & morph!=9837
** note: ICD-O-3 has another matching code (M9729) but WHO Classification notes that M9837 more accurate
count if morphcheckcat==78 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==78

** morphcheckcat 79: Hx=CML (chronic myeloid/myelogenous leukemia) & Hx!=genetic studies & morph==9863
** note: HemeDb under CML, NOS notes 'Presumably myelogenous leukemia without genetic studies done would be coded to M9863.'
count if morphcheckcat==79 //2
list pid primarysite hx morph basis beh cr5id if morphcheckcat==79
replace hx="CHRONIC MYELOID LEUKAEMIA BCR-ABL POSITIVE" if pid=="20140681" //2 changes
replace morph=9875 if pid=="20140681" //2 changes
replace morphcat=52 if pid=="20140681" //0 changess

** morphcheckcat 80: Hx=CML (chronic myeloid/myelogenous leukemia) & Hx!=BCR/ABL1 & morph==9875
** note: HemeDb under CML, NOS notes 'Presumably myelogenous leukemia without genetic studies done would be coded to M9863.'
count if morphcheckcat==80 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==80

** morphcheckcat 81: Hx=acute myeloid leukemia & Hx!=myelodysplastic/down syndrome & basis==cyto/heme/histology... & morph!=9861
count if morphcheckcat==81 //1
list pid primarysite hx morph basis beh cr5id if morphcheckcat==81
replace morph=9861 if pid=="20140826" & regexm(cr5id,"T1") //1 change
replace morphcat=52 if pid=="20140826" & regexm(cr5id,"T1") //0 changess

** morphcheckcat 82: Hx=acute myeloid leukemia & down syndrome & morph!=9898
count if morphcheckcat==82 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==82

** morphcheckcat 83: Hx=secondary myelofibrosis & recstatus!=3 & morph==9931 or 9961
count if morphcheckcat==83 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==83

** morphcheckcat 84: Hx=polycythemia & Hx!=vera/proliferative/primary & morph==9950
count if morphcheckcat==84 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==84

** morphcheckcat 85: Hx=myeloproliferative & Hx!=essential & dxyr<2010 & morph==9975
count if morphcheckcat==85 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==85

** morphcheckcat 86: Hx=myeloproliferative & Hx!=essential & dxyr>2009 & morph==9960
count if morphcheckcat==86 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==86
replace morph=9975 if pid=="20140622" //1 change
replace morphcat=55 if pid=="20140622" //1 change
replace hx="ESSENTIAL THROMBOCYTHEMIA" if pid=="20140715" //2 changes
replace morph=9962 if pid=="20140715" //2 changes
replace morphcat=54 if pid=="20140715" //0 changess
replace morph=9975 if pid=="20141573" //1 change
replace morphcat=55 if pid=="20141573" //1 change

** morphcheckcat 87: Hx=refractory anemia & Hx!=sideroblast or blast & morph!=9980
count if morphcheckcat==87 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==87

** morphcheckcat 88: Hx=refractory anemia & sideroblast & Hx!=excess blasts & morph!=9982
count if morphcheckcat==88 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==88

** morphcheckcat 89: Hx=refractory anemia & excess blasts &  Hx!=sidero & morph!=9983
count if morphcheckcat==89 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==89

** morphcheckcat 90: Hx=myelodysplasia & Hx!=syndrome & recstatus!=inelig. & morph==9989
count if morphcheckcat==90 //0
list pid primarysite hx morph basis beh cr5id if morphcheckcat==90

** morphcheckcat 91: Hx=acinar & top!=619 & morph!=8550
count if morphcheckcat==91 //35 - on 22oct18 JC added in top!=619 to this code so now count=0
list pid primarysite hx morph cr5id if morphcheckcat==91
** JC 22oct18: removed replace code that is now irrelevant but kept replace code for valid corrections which were found on initial list!
replace grade=3 if pid=="20140868" //2 changes
replace grade=2 if pid=="20140896" //2 changes
replace hx="ADENOCARCINOMA" if pid=="20140977" //2 changes
replace grade=1 if pid=="20140977" //2 changes

** morphcheckcat 92: Hx!=fibro & histiocytoma & morph=8830 (see morphcheckcat=50 also!)
count if morphcheckcat==92 //1
list pid primarysite hx morph basis beh cr5id if morphcheckcat==92
replace hx="MALIGNANT FIBROUS HISTIOCYTOMA, STORIFORM-PLEOMORPHIC TYPE" if pid=="20141179" //1 change

** morphcheckcat 93: Hx=acinar & top=619 & morph!=8140
/*
This check added on 22oct18 after update re morphcheckcat 91 above.  
*/
count if morphcheckcat==93 //128
list pid primarysite hx morph cr5id if morphcheckcat==93
replace morph=8140 if morphcheckcat==93 //128 changes
replace morphcat=6 if morphcheckcat==93 //128 changes

** morphcheckcat 94: Hx=hodgkin & morph=non-hodgkin
count if morphcheckcat==94 //3 - corrected in Check 76 subcheck 1 below
list pid hx morph cr5id if morphcheckcat==94

** morphcheckcat 95: Hx=leukaemia & morph=9729
count if morphcheckcat==95 //0
list pid hx morph cr5id if morphcheckcat==95

** morphcheckcat 96: Hx=lymphoma & morph=9837
count if morphcheckcat==96 //0
list pid hx morph cr5id if morphcheckcat==96

** Check 76 - invalid(primarysite vs hx)

** hxcheckcat 1: PrimSite=Blood/Bone Marrow & Hx=Lymphoma 
count if hxcheckcat==1 //37
list pid top hx morph cr5id if hxcheckcat==1
** Correct data for above list
replace primarysite="99" if pid=="20140125" & regexm(cr5id,"T1") //1 change
replace topography=809 if pid=="20140125" & regexm(cr5id,"T1") //1 change
replace top="809" if pid=="20140125" & regexm(cr5id,"T1") //1 change
replace topcat=70 if pid=="20140125" & regexm(cr5id,"T1") //1 change
replace basis=6 if pid=="20140125" & regexm(cr5id,"T1") //1 change

replace primarysite="LYMPH NODE-UNKNOWN" if pid=="20140327" & regexm(cr5id,"T1") //2 changes
replace topography=779 if pid=="20140327" & regexm(cr5id,"T1") //2 changes
replace top="779" if pid=="20140327" & regexm(cr5id,"T1") //2 changes
replace topcat=69 if pid=="20140327" & regexm(cr5id,"T1") //2 changes
replace grade=6 if pid=="20140327" & regexm(cr5id,"T1") //2 changes

replace primarysite="LYMPH NODE-UNKNOWN" if pid=="20140475" & regexm(cr5id,"T1") //2 changes
replace topography=779 if pid=="20140475" & regexm(cr5id,"T1") //2 changes
replace top="779" if pid=="20140475" & regexm(cr5id,"T1") //2 changes
replace topcat=69 if pid=="20140475" & regexm(cr5id,"T1") //2 changes

replace primarysite="LYMPH NODE-UNKNOWN" if pid=="20140558" & regexm(cr5id,"T1") //1 change
replace topography=779 if pid=="20140558" & regexm(cr5id,"T1") //1 change
replace top="779" if pid=="20140558" & regexm(cr5id,"T1") //1 change
replace topcat=69 if pid=="20140558" & regexm(cr5id,"T1") //1 change
replace grade=6 if pid=="20140558" & regexm(cr5id,"T1") //1 change

replace primarysite="LYMPH NODE-UNKNOWN" if pid=="20140577" & regexm(cr5id,"T1") //1 change
replace topography=779 if pid=="20140577" & regexm(cr5id,"T1") //1 change
replace top="779" if pid=="20140577" & regexm(cr5id,"T1") //1 change
replace topcat=69 if pid=="20140577" & regexm(cr5id,"T1") //1 change

replace primarysite="LYMPH NODE-RETROPERITONEAL" if pid=="20140592" & regexm(cr5id,"T1") //4 changes
replace topography=772 if pid=="20140592" & regexm(cr5id,"T1") //4 changes
replace top="772" if pid=="20140592" & regexm(cr5id,"T1") //4 changes
replace topcat=69 if pid=="20140592" & regexm(cr5id,"T1") //4 changes
replace hx="DIFFUSE LARGE B-CELL LYMPHOMA,NON-GERMINAL CENTER SUBTYPE" if pid=="20140592" & regexm(cr5id,"T1") //4 changes
replace morph=9680 if pid=="20140592" & regexm(cr5id,"T1") //4 changes
replace morphcat=43 if pid=="20140592" & regexm(cr5id,"T1") //4 changes
replace grade=6 if pid=="20140592" & regexm(cr5id,"T1") //4 changes

/* See dofile 3 corrections at end of this dofile for 20140659 corrections
replace primarysite="LYMPH NODE-RETROPERITONEAL" if pid=="20140659" & regexm(cr5id,"T1") //2 changes
replace topography=772 if pid=="20140659" & regexm(cr5id,"T1") //2 changes
replace top="772" if pid=="20140659" & regexm(cr5id,"T1") //2 changes
replace topcat=69 if pid=="20140659" & regexm(cr5id,"T1") //2 changes
replace hx="DIFFUSE LARGE B-CELL LYMPHOMA,NON-GERMINAL CENTER SUBTYPE" if pid=="20140659" & regexm(cr5id,"T1") //2 changes
replace grade=6 if pid=="20140659" & regexm(cr5id,"T1") //2 changes
*/

replace primarysite="SKIN-ABDOMEN,AXILLA" if pid=="20140704" & regexm(cr5id,"T1") //3 changes
replace topography=445 if pid=="20140704" & regexm(cr5id,"T1") //3 changes
replace top="445" if pid=="20140704" & regexm(cr5id,"T1") //3 changes
replace topcat=39 if pid=="20140704" & regexm(cr5id,"T1") //3 changes
replace lat=1 if pid=="20140704" & regexm(cr5id,"T1") //3 changes
replace latcat=24 if pid=="20140704" & regexm(cr5id,"T1") //3 changes
replace grade=6 if pid=="20140704" & regexm(cr5id,"T1") //3 changes

replace primarysite="STOMACH" if pid=="20140722" & regexm(cr5id,"T1") //2 changes
replace topography=169 if pid=="20140722" & regexm(cr5id,"T1") //2 changes
replace top="169" if pid=="20140722" & regexm(cr5id,"T1") //2 changes
replace topcat=17 if pid=="20140722" & regexm(cr5id,"T1") //2 changes
replace hx="EBV-POSITIVE DIFFUSE LARGE B-CELL LYMPHOMA" if pid=="20140722" & regexm(cr5id,"T1") //2 changes
replace grade=6 if pid=="20140722" & regexm(cr5id,"T1") //2 changes

replace cstatus=3 if pid=="20140782" & regexm(cr5id,"T1") //2 changes
replace comments="JC 06NOV18: Emailed SAF cc NS,KWG as this path dx not alone an eligible dx (unsure where DA obtained the hx/morph MALIGNANT LYMPHOMA SMALL B LYMPHOCYTIC)-case dropped from 2014 cleaning dofile. 26JUN18_TH F/U completed. DLC, BOD, InciDate updated. F/U Needed with Qeh Medical Records for DLC, Basis of Dx and IncidenceDate." if pid=="20140782" & regexm(cr5id,"T1") //2 changes
replace recstatus=3 if pid=="20140782" & regexm(cr5id,"T1") //2 changes
replace primarysite="EYE-LACRIMAL GLAND" if pid=="20140782" & regexm(cr5id,"T1") //2 changes
replace topography=695 if pid=="20140782" & regexm(cr5id,"T1") //2 changes
replace top="695" if pid=="20140782" & regexm(cr5id,"T1") //2 changes
replace topcat=61 if pid=="20140782" & regexm(cr5id,"T1") //2 changes
replace hx="ATYPICAL PREDOMINANTLY SMALL B CELL LYMPHOCYTIC INFILTRATE" if pid=="20140782" & regexm(cr5id,"T1") //2 changes
replace beh=1 if pid=="20140782" & regexm(cr5id,"T1") //2 changes
**replace grade=6 if pid=="20140782" & regexm(cr5id,"T1") //2 changes

replace primarysite="LYMPH NODE-CERVICAL/NECK" if pid=="20140783" & regexm(cr5id,"T1") //2 changes
replace topography=770 if pid=="20140783" & regexm(cr5id,"T1") //2 changes
replace top="770" if pid=="20140783" & regexm(cr5id,"T1") //2 changes
replace topcat=69 if pid=="20140783" & regexm(cr5id,"T1") //2 changes
replace grade=6 if pid=="20140783" & regexm(cr5id,"T1") //2 changes

replace mpseq=1 if pid=="20140786" & regexm(cr5id, "T1") //5 changes
replace mptot=2 if pid=="20140786" & regexm(cr5id, "T1") //5 changes
replace primarysite="LYMPH NODE-RT POSTERIOR CERVICAL" if pid=="20140786" & regexm(cr5id,"T1") //5 changes
replace topography=770 if pid=="20140786" & regexm(cr5id,"T1") //5 changes
replace top="770" if pid=="20140786" & regexm(cr5id,"T1") //5 changes
replace topcat=69 if pid=="20140786" & regexm(cr5id,"T1") //5 changes
replace hx="NON-HODGKIN'S LYMPHOMA,MIXED SMALL AND LARGE CELL TYPE" if pid=="20140786" & regexm(cr5id,"T1") //5 changes
replace morph=9675 if pid=="20140786" & regexm(cr5id,"T1") //5 changes
replace morphcat=43 if pid=="20140786" & regexm(cr5id,"T1") //5 changes
replace grade=6 if pid=="20140786" & regexm(cr5id,"T1") //5 changes
** 20140786 is missed MP case so need to duplicate above observation then update cr5id and lat
expand=2 if pid=="20140786" & cr5id=="T1S5", gen (dupobs76c1)
replace cr5id="T2S1" if pid=="20140786" & dupobs76==1 //1 change
replace mpseq=2 if pid=="20140786" & regexm(cr5id, "T2") //1 change
replace primarysite="SPINE" if pid=="20140786" & regexm(cr5id,"T2") //1 change
replace topography=412 if pid=="20140786" & regexm(cr5id,"T2") //1 change
replace top="412" if pid=="20140786" & regexm(cr5id,"T2") //1 change
replace topcat=37 if pid=="20140786" & regexm(cr5id,"T2") //1 change
replace hx="SARCOMA" if pid=="20140786" & regexm(cr5id,"T2") //1 change
replace morph=8800 if pid=="20140786" & regexm(cr5id,"T2") //1 change
replace morphcat=17 if pid=="20140786" & regexm(cr5id,"T2") //1 change
replace grade=9 if pid=="20140786" & regexm(cr5id,"T2") //1 change

replace primarysite="LYMPH NODE-UNKNOWN" if pid=="20140825" & regexm(cr5id,"T1") //2 changes
replace topography=779 if pid=="20140825" & regexm(cr5id,"T1") //2 changes
replace top="779" if pid=="20140825" & regexm(cr5id,"T1") //2 changes
replace topcat=69 if pid=="20140825" & regexm(cr5id,"T1") //2 changes
replace hx="ACUTE T-CELL LYMPHOMA" if pid=="20140825" & regexm(cr5id,"T1") //2 changes
replace morph=9827 if pid=="20140825" & regexm(cr5id,"T1") //2 changes
replace morphcat=51 if pid=="20140825" & regexm(cr5id,"T1") //2 changes
replace grade=5 if pid=="20140825" & regexm(cr5id,"T1") //2 changes

replace primarysite="LYMPH NODES-LT INGUINAL" if pid=="20140839" & regexm(cr5id,"T1") //1 change
replace topography=774 if pid=="20140839" & regexm(cr5id,"T1") //1 change
replace top="774" if pid=="20140839" & regexm(cr5id,"T1") //1 change
replace topcat=69 if pid=="20140839" & regexm(cr5id,"T1") //1 change
replace grade=6 if pid=="20140839" & regexm(cr5id,"T1") //1 change

replace primarysite="LYMPH NODES-CERVICAL,MEDIASTINAL" if pid=="20141306" & regexm(cr5id,"T1") //2 changes
replace topography=778 if pid=="20141306" & regexm(cr5id,"T1") //2 changes
replace top="778" if pid=="20141306" & regexm(cr5id,"T1") //2 changes
replace topcat=69 if pid=="20141306" & regexm(cr5id,"T1") //2 changes
replace hx="MALIGNANT LYMPHOMA, SMALL B-CELL TYPE" if pid=="20141306" & regexm(cr5id,"T1") //2 changes
replace morph=9670 if pid=="20141306" & regexm(cr5id,"T1") //2 changes
replace morphcat=43 if pid=="20141306" & regexm(cr5id,"T1") //2 changes
replace grade=6 if pid=="20141306" & regexm(cr5id,"T1") //2 changes

replace primarysite="LYMPH NODES-MEDIASTINAL" if pid=="20141572" & regexm(cr5id,"T1") //3 changes
replace topography=771 if pid=="20141572" & regexm(cr5id,"T1") //3 changes
replace top="771" if pid=="20141572" & regexm(cr5id,"T1") //3 changes
replace topcat=69 if pid=="20141572" & regexm(cr5id,"T1") //3 changes
replace hx="HODGKIN LYMPHOMA,NODULAR SCLEROSIS" if pid=="20141572" & regexm(cr5id,"T1") //3 changes
replace morph=9663 if pid=="20141572" & regexm(cr5id,"T1") //3 changes
replace morphcat=42 if pid=="20141572" & regexm(cr5id,"T1") //3 changes

** hxcheckcat 2: PrimSite=Thymus & MorphCat!=13 (Thymic epithe. neo.) & Hx!=carcinoma
count if hxcheckcat==2 //0
list pid primarysite top hx morph cr5id if hxcheckcat==2

** hxcheckcat 3: PrimSite!=Bone Marrow & MorphCat==56 (Myelodysplastic Syn.)
count if hxcheckcat==3 //0
list pid primarysite top hx morph cr5id if hxcheckcat==3

** hxcheckcat 4: PrimSite!=thyroid & Hx=Renal & Hx=Papillary ca & Morph!=8260
count if hxcheckcat==4 //3
list pid primarysite hx morph cr5id if hxcheckcat==4
replace morph=8260 if pid=="20140648" //3 changes
replace morphcat=6 if pid=="20140648" //3 changes

** hxcheckcat 5: PrimSite==thyroid & Hx!=Renal & Hx=Papillary ca & adenoca & Morph!=8260
count if hxcheckcat==5 //0
list pid primarysite hx morph cr5id if hxcheckcat==5

** hxcheckcat 6: PrimSite==ovary or peritoneum & Hx=Papillary & Serous & Morph!=8461
count if hxcheckcat==6 //0
list pid hx morph cr5id if hxcheckcat==6

** hxcheckcat 7: PrimSite==endometrium & Hx=Papillary & Serous & Morph!=8460
count if hxcheckcat==7 //2 - 20140707 already corrected in Check 74(sub-check 4)
list pid primarysite hx morph cr5id if hxcheckcat==7

** hxcheckcat 8: PrimSite!=bone; Hx=plasmacytoma & Morph==9731(bone)
count if hxcheckcat==8 //4 - 20080677 T2 already corrected in Check 63
list pid primarysite hx morph cr5id if hxcheckcat==8
replace primarysite="BONE-LT SUPRACONDYLAR FEMUR" if pid=="20140727" //2 changes
replace topography=402 if pid=="20140727" //2 changes
replace top="402" if pid=="20140727" //2 changes
replace topcat=36 if pid=="20140727" //2 changes

** hxcheckcat 9: PrimSite==bone; Hx=plasmacytoma & Morph==9734(not bone)
count if hxcheckcat==9 //0
list pid primarysite hx morph cr5id if hxcheckcat==9

** hxcheckcat 10: PrimSite!=meninges; Hx=meningioma
count if hxcheckcat==10 //3
list pid primarysite hx morph cr5id if hxcheckcat==10
replace primarysite="BRAIN-MENINGES FRONTAL LOBE" if pid=="20140340" //1 change
replace topography=700 if pid=="20140340" //1 change
replace top="700" if pid=="20140340" //1 change
replace topcat=62 if pid=="20140340" //1 change
replace lat=5 if pid=="20140340" //1 change
replace latcat=41 if pid=="20140340" //1 change
replace beh=1 if pid=="20140340" //1 change
replace recstatus=3 if pid=="20140340" //1 change
replace cstatus=3 if pid=="20140340" //1 change
replace primarysite="BRAIN-MENINGES" if pid=="20141564" //2 changes
replace topography=700 if pid=="20141564" //2 changes
replace top="700" if pid=="20141564" //2 changes
replace topcat=62 if pid=="20141564" //2 changes
replace lat=5 if pid=="20141564" //2 changes
replace latcat=41 if pid=="20141564" //2 changes

** hxcheckcat 11: PrimSite=Blood/Bone Marrow & Hx=HTLV+T-cell Lymphoma 
count if hxcheckcat==11 //5
list pid top hx morph cr5id if hxcheckcat==11

replace primarysite="LYMPH NODE" if pid=="20140259" //1 change - See CR5db comments & abstractor notes in HemeDb under M9827 re peripheral blood involvement
replace topography=779 if pid=="20140259" //1 change
replace top="779" if pid=="20140259" //1 change
replace topcat=69 if pid=="20140259" //1 change
replace hx="ADULT T-CELL LEUKAEMIA/LYMPHOMA" if pid=="20140259" //1 change
replace grade=5 if pid=="20140259" //1 change
** 20140259 is missed multiple source so need to duplicate above observation then update cr5id and source fields with flow cytometry info - need to add source for assessing registry completeness
expand=2 if pid=="20140259", gen (dupobs76c11)
replace cr5id="T1S2" if pid=="20140259" & dupobs76c11==1 //1 change
replace stda=14 if pid=="20140259" & cr5id=="T1S2" //1 change
replace stdoa=d(21aug2018) if pid=="20140259" & cr5id=="T1S2" //1 change
replace nftype=5 if pid=="20140259" & cr5id=="T1S2" //1 change
replace sourcename=1 if pid=="20140259" & cr5id=="T1S2" //1 change
replace sampledate=d(17apr2014) if pid=="20140259" & cr5id=="T1S2" //1 change
replace cytofinds="FINDINGS: The flow cytometry results are compatible with a mature (peripheral/ post thymic) T- cell lymphoproliferative disorder. The immunophenotypic features of the atypical T-cell favour adult T-cell leukemia/lymphoma. Peripheral Blood: Abnormal CD 4 plus/CD7-/CD2 plus T-cell population (90%)." if pid=="20140259" & cr5id=="T1S2" //1 change
replace cr5cod="99" if pid=="20140259" & cr5id=="T1S2" //1 change
replace duration="99" if pid=="20140259" & cr5id=="T1S2" //1 change
replace onsetint="99" if pid=="20140259" & cr5id=="T1S2" //1 change
replace certifier="99" if pid=="20140259" & cr5id=="T1S2" //1 change

replace primarysite="LYMPH NODE-SUBMENTAL" if pid=="20140296" //2 changes
replace topography=770 if pid=="20140296" //2 changes
replace top="770" if pid=="20140296" //2 changes
replace topcat=69 if pid=="20140296" //2 changes
replace hx="Precursor T-CELL LYMPHOBLASTIC LYMPHOMA" if pid=="20140296" //2 changes
replace morph=9729 if pid=="20140296" & regexm(cr5id,"T1") //2 changes
replace morphcat=45 if pid=="20140296" & regexm(cr5id,"T1") //2 changes
replace grade=5 if pid=="20140296" //2 changes

replace primarysite="LYMPH NODE-BREAST" if pid=="20140390" //2 changes - hx & grade corrected in Check 74 subcheck 76
replace topography=773 if pid=="20140390" //2 changes
replace top="773" if pid=="20140390" //2 changes
replace topcat=69 if pid=="20140390" //2 changes

** Check 78 - invalid(age/site/histology)

** agecheckcat 1: Age<3 & Hx=Hodgkin Lymphoma
count if agecheckcat==1 //0
list pid cr5id age hx morph dxyr if agecheckcat==1

** agecheckcat 2: Age 10-14 & Hx=Neuroblastoma
count if agecheckcat==2 //0
list pid cr5id age hx morph dxyr if agecheckcat==2

** agecheckcat 3: Age 6-14 & Hx=Retinoblastoma
count if agecheckcat==3 //0
list pid cr5id age hx morph dxyr if agecheckcat==3

** agecheckcat 4: Age 9-14 & Hx=Wilm's Tumour
count if agecheckcat==4 //0
list pid cr5id age hx morph dxyr if agecheckcat==4

** agecheckcat 5: Age 0-8 & Hx=Renal carcinoma
count if agecheckcat==5 //0
list pid cr5id age hx morph dxyr if agecheckcat==5

** agecheckcat 6: Age 6-14 & Hx=Hepatoblastoma
count if agecheckcat==6 //0
list pid cr5id age hx morph dxyr if agecheckcat==6

** agecheckcat 7: Age 0-8 & Hx=Hepatic carcinoma
count if agecheckcat==7 //0
list pid cr5id age hx morph dxyr if agecheckcat==7

** agecheckcat 8: Age 0-5 & Hx=Osteosarcoma
count if agecheckcat==8 //0
list pid cr5id age hx morph dxyr if agecheckcat==8

** agecheckcat 9: Age 0-5 & Hx=Chondrosarcoma
count if agecheckcat==9 //0
list pid cr5id age hx morph dxyr if agecheckcat==9

** agecheckcat 10: Age 0-3 & Hx=Ewing sarcoma
count if agecheckcat==10 //0
list pid cr5id age hx morph dxyr if agecheckcat==10

** agecheckcat 11: Age 8-14 & Hx=Non-gonadal germ cell
count if agecheckcat==11 //3 - no corrections needed
list pid cr5id age hx morph dxyr if agecheckcat==11

** agecheckcat 12: Age 0-4 & Hx=Gonadal carcinoma
count if agecheckcat==12 //0
list pid cr5id age hx morph dxyr if agecheckcat==12

** agecheckcat 13: Age 0-5 & Hx=Thyroid carcinoma
count if agecheckcat==13 //0
list pid cr5id age hx morph dxyr if agecheckcat==13

** agecheckcat 14: Age 0-5 & Hx=Nasopharyngeal carcinoma
count if agecheckcat==14 //0
list pid cr5id age hx morph dxyr if agecheckcat==14

** agecheckcat 15: Age 0-4 & Hx=Skin carcinoma
count if agecheckcat==15 //0
list pid cr5id age hx morph dxyr if agecheckcat==15

** agecheckcat 16: Age 0-4 & Hx=Carcinoma, NOS
count if agecheckcat==16 //0
list pid cr5id age hx morph dxyr if agecheckcat==16

** agecheckcat 17: Age 0-14 & Hx=Mesothelial neoplasms
count if agecheckcat==17 //0
list pid cr5id age hx morph dxyr if agecheckcat==17

** agecheckcat 18: Age <40 & Hx=814_ & Top=61_
count if agecheckcat==18 //0
list pid cr5id age hx morph dxyr if agecheckcat==18

** agecheckcat 19: Age <20 & Top=15._,19._,20._,21._,23._,24._,38.4,50._53._,54._,55._
count if agecheckcat==19 //1 - 20145025 missing dob: no correction needed
list pid cr5id age primarysite top hx morph dxyr if agecheckcat==19

** agecheckcat 20: Age <20 & Top=17._ & Morph<9590(ie.not lymphoma)
count if agecheckcat==20 //0
list pid cr5id age hx morph dxyr if agecheckcat==20

** agecheckcat 21: Age <20 & Top=33._ or 34._ or 18._ & Morph!=824_(ie.not carcinoid)
count if agecheckcat==21 //0
list pid cr5id age hx morph dxyr if agecheckcat==21

** agecheckcat 22: Age >45 & Top=58._ & Morph==9100(chorioca.)
count if agecheckcat==22 //0
list pid cr5id age hx morph dxyr if agecheckcat==22

** agecheckcat 23: Age <26 & Morph==9732(myeloma) or 9823(BCLL)
count if agecheckcat==23 //0
list pid cr5id age hx morph dxyr if agecheckcat==23

** agecheckcat 24: Age >15 & Morph==8910/8960/8970/8981/8991/9072/9470/9490/9500/951_/9687
count if agecheckcat==24 //0
list pid cr5id age hx morph dxyr if agecheckcat==24

** agecheckcat 25: Age <15 & Morph==9724
count if agecheckcat==25 //0
list pid cr5id age hx morph dxyr if agecheckcat==25


** Check 80 - invalid(sex/histology)
** sexcheckcat 1: Sex=male & Hx family=23,24,25,26,27
count if sexcheckcat==1 //0
list pid cr5id age hx morph hxfamcat dxyr if sexcheckcat==1

** sexcheckcat 2: Sex=female & Hx family=28 or 29
count if sexcheckcat==2 //0
list pid cr5id age hx morph hxfamcat dxyr if sexcheckcat==2


** Check 82 - invalid(site/histology)
** sitecheckcat 1: NOT haem. tumours
count if sitecheckcat==1 //0
list pid cr5id age hx morph dxyr if sitecheckcat==1

** sitecheckcat 2: NOT site-specific carcinomas
count if sitecheckcat==2 //3 - 20145112 no corrections needed
list pid cr5id age hx morph dxyr if sitecheckcat==2

** sitecheckcat 3: NOT site-specific sarcomas
count if sitecheckcat==3 //0
list pid cr5id age hx morph dxyr if sitecheckcat==3

** sitecheckcat 4: Top=Bone; Hx=Giant cell sarc. except bone
count if sitecheckcat==4 //0
list pid cr5id age hx morph dxyr if sitecheckcat==4

** sitecheckcat 5: NOT sarcomas affecting CNS
count if sitecheckcat==5 //0
list pid cr5id age hx morph dxyr if sitecheckcat==5

** sitecheckcat 6: NOT sites for Kaposi sarcoma
count if sitecheckcat==6 //0
list pid cr5id age hx morph dxyr if sitecheckcat==6

** sitecheckcat 7: Top=Bone; Hx=extramedullary plasmacytoma
count if sitecheckcat==7 //0
list pid cr5id age hx morph dxyr if sitecheckcat==7


****************
** Laterality **
****************
** Check 83 - Laterality missing
count if lat==. & primarysite!="" //0
list pid lat primarysite cr5id if lat==. & primarysite!=""
count if latcat==. & lat!=. //0 - some latcats may change due to corrections in clean dofile being run after prep dofile
list pid lat primarysite cr5id if latcat==. & lat!=.
count if lat==8 //981 - lat should=0(not paired site) if latcat=0 or blank
list pid lat primarysite latcat cr5id if lat==8
count if lat==8 & (latcat==0|latcat==.) //967; 969 - replace (KWG updated main CR5db on 30oct18)
list pid lat top latcat cr5id if lat==8 & (latcat==0|latcat==.)
replace lat=0 if lat==8 & (latcat==0|latcat==.) //967; 969 changes

** Check 84 - Laterality length
** Need to create string variable for laterality
gen laterality=lat
tostring laterality, replace
** Need to change all laterality=="." to laterality==""
replace laterality="" if laterality=="." //778 changes made
count if laterality!="" & length(laterality)!=1 //0
list pid laterality lat cr5id if laterality!="" & length(laterality)!=1
 

** Check 86 - invalid(laterality)
sort pid

** latcheckcat 1: COD='left'; COD=cancer (codcat!=1); latcat>0; lat!=left
count if latcheckcat==1 //1 - this is not an error as 'left' refers to stroke COD
list pid cr5id primarysite lat cr5cod dxyr if latcheckcat==1

** latcheckcat 2: COD='right'; COD=cancer (codcat!=1); latcat>0; lat!=right
count if latcheckcat==2 //0
list pid cr5id primarysite lat cr5cod dxyr if latcheckcat==2

** latcheckcat 3: CFdx='left'; latcat>0; lat!=left
count if latcheckcat==3 //5 - 20145030 already corrected in check 11 and the other 2 no correction needed
list pid cr5id primarysite lat cfdx dxyr if latcheckcat==3
replace lat=4 if pid=="20140851" //1 change
replace lat=0 if pid=="20141181" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20141181" & regexm(cr5id, "T1") //2 changes

** latcheckcat 4: CFdx='right'; latcat>0; lat!=right
count if latcheckcat==4 //1-no correction needed as all other source info indicate left.
list pid cr5id primarysite lat cfdx dxyr if latcheckcat==4

** latcheckcat 5: topog==809 & lat!=0-paired site (in accord with SEER Prog. Coding manual 2016 pg 82 #1.a.)
count if latcheckcat==5 //44
list pid cr5id primarysite topography lat dxyr if latcheckcat==5
replace lat=0 if latcheckcat==5 & topography==809 //42 changes - other 2 changed in earlier check
replace latcat=0 if latcheckcat==5 & topography==809 //42 changes
count if lat!=0 & topography==809 //12
list pid cr5id primarysite topography lat dxyr if lat!=0 & topography==809

** latcheckcat 6: latcat>0 & lat==0 or 8 (in accord with SEER Prog. Coding manual 2016 pg 82 #2)
count if latcheckcat==6 //2
list pid cr5id topography lat latcat dxyr if latcheckcat==6
replace primarysite="SKIN-UPPER BACK, LT AXILLA" if pid=="20141015" & regexm(cr5id,"T1") //2 changes
replace lat=5 if pid=="20141015" & regexm(cr5id, "T1") //2 changes

** latcheckcat 7: latcat!=ovary,lung,eye,kidney & lat==4 (in accord with SEER Prog. Coding manual 2016 pg 82 #4 & IARC MP recommendations for recording #1)
count if latcheckcat==7 //2 - 20140555 already corrected above in check 11
list pid cr5id primarysite topography lat latcat dxyr if latcheckcat==7

** latcheckcat 8: latcat=meninges/brain/CNS/skin-face,trunk & dxyr>2009 & lat!=5 & lat=NA (in accord with SEER Prog. Coding manual 2016 pg 83 #5) (lat 5-midline only for 2010 onwards dx)
count if latcheckcat==8 //0
list pid cr5id primarysite topography lat latcat dxyr if latcheckcat==8

** latcheckcat 9: latcat!=meninges/brain/CNS/skin-face,trunk & dxyr>2009 & lat==5 (in accord with SEER Prog. Coding manual 2016 pg 83 #5.a.i.) (lat 5-midline only for 2010 onwards dx)
count if latcheckcat==9 //0
list pid cr5id primarysite topography lat latcat dxyr if latcheckcat==9

** latcheckcat 10: latcat!=0,8,12,19,20 & basis==0 & lat=NA (in accord with SEER Prog. Coding manual 2016 pg 83 #6.b.)
count if latcheckcat==10 //0
list pid cr5id primarysite topography lat latcat dxyr if latcheckcat==10

** latcheckcat 11: primsite=thyroid and lat!=NA
count if latcheckcat==11 //0
list pid cr5id primarysite topography lat latcat dxyr if latcheckcat==11

** latcheckcat 12: latcat=no lat cat (i.e. laterality n/a); topog!=809; lat!=N/A; latcheckcat==. (this can capture any that have not already been corrected in above latcheckcats)
count if latcheckcat==12 //19
list pid cr5id topography lat latcat dxyr if latcheckcat==12
replace lat=0 if latcheckcat==12 //19 changes

** latcheckcat 13: lat=N/A & dxyr>2013 (cases dx>2013 should use code '0-not paired site')
count if latcheckcat==13 //987 - check 83 already corrected 967 records; 969 records
list pid cr5id topography lat latcat if latcheckcat==13
count if lat==8 & dxyr>2013 //14 - flagged and corrected in below latcheckcat 14
list pid cr5id topography lat latcat if lat==8 & dxyr>2013

** latcheckcat 14: lat=N/A & latcat!=0
count if latcheckcat==14 //19 - 5 already corrected in above checks
list pid cr5id topography lat latcat if latcheckcat==14
replace lat=9 if pid=="20140120" & regexm(cr5id, "T1") //1 change
replace lat=2 if pid=="20140403" & regexm(cr5id, "T1") //2 changes
replace lat=2 if pid=="20140716" & regexm(cr5id, "T1") //3 changes
replace lat=0 if pid=="20140845" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140845" & regexm(cr5id, "T1") //1 change
replace lat=1 if pid=="20140945" & regexm(cr5id, "T1") //1 change
replace lat=1 if pid=="20140951" & regexm(cr5id, "T1") //1 change
replace lat=5 if pid=="20141021" & regexm(cr5id, "T2") //1 change
replace lat=1 if pid=="20141280" & regexm(cr5id, "T1") //2 changes
replace lat=2 if pid=="20141399" & regexm(cr5id, "T1") //2 changes

***************
** Behaviour **
***************
** Check 87 - Behaviour missing
count if beh==. & primarysite!="" //0
list pid beh primarysite cr5id if beh==. & primarysite!=""

** Check 88 - Behaviour length
** Need to create string variable for behaviour
gen behaviour=beh
tostring behaviour, replace
** Need to change all behaviour=="." to behaviour==""
replace behaviour="" if behaviour=="." //779 changes made
count if behaviour!="" & length(behaviour)!=1 //0
list pid behaviour beh cr5id if behaviour!="" & length(behaviour)!=1
 
 
** Check 90 - invalid(behaviour)

** behcheckcat 1: Beh!=2 & Morph==8503
count if behcheckcat==5 //0
list pid hx morph basis beh cr5id if behcheckcat==5

** behcheckcat 2: Beh!=2 & Morph==8077
count if behcheckcat==2 //16 - 20140690 already corrected in check 11.
list pid primarysite hx morph basis beh cr5id if behcheckcat==2
replace beh=2 if behcheckcat==2 //15 changes

** behcheckcat 3: Hx=Squamous & microinvasive & Beh=2 & Morph!=8076
count if behcheckcat==3 //0
list pid primarysite hx morph basis beh cr5id if behcheckcat==3

** behcheckcat 4: Hx=Bowen & Beh!=2 (want to check skin SCCs that have bowen disease is coded to beh=in-situ)
count if behcheckcat==4 //0
list pid primarysite hx morph basis beh cr5id if behcheckcat==4

** behcheckcat 5: PrimSite==appendix & Morph==8240 & Beh!=1
count if behcheckcat==5 //0
list pid primarysite hx morph basis beh cr5id if behcheckcat==5

** behcheckcat 6: Hx=adenoma excl. adenocarcinoma & invasion & Morph==8263 & Beh!=2
count if behcheckcat==6 //0
list pid hx morph beh cr5id if behcheckcat==6

** behcheckcat 7: Morph not listed in ICD-O-3 (IARCcrgTools Check pg 8)
count if behcheckcat==7 //0
list pid hx morph beh cr5id if behcheckcat==7

** behcheckcat 8: Hx=tumour & beh>1
count if behcheckcat==8 //2 - 20140120 already corrected earlier.
list pid hx morph beh recstatus cr5id if behcheckcat==8
replace beh=1 if pid=="20140529" & regexm(cr5id, "T1") //1 change
replace cstatus=3 if pid=="20140529" & regexm(cr5id, "T1") //1 change
replace recstatus=3 if pid=="20140529" & regexm(cr5id, "T1") //1 change


** Below checks taken from IARCcrgTools pg 8.
** behsitecheckcat 1: Beh==2 & Top==C40._(bone)
count if behsitecheckcat==1 //0
list pid primarysite topography beh cr5id if behsitecheckcat==1

** behsitecheckcat 2: Beh==2 & Top==C41._(bone,NOS)
count if behsitecheckcat==2 //0
list pid primarysite topography beh cr5id if behsitecheckcat==2

** behsitecheckcat 3: Beh==2 & Top==C42._(haem)
count if behsitecheckcat==3 //0
list pid primarysite topography beh cr5id if behsitecheckcat==3

** behsitecheckcat 4: Beh==2 & Top==C47._(ANS)
count if behsitecheckcat==4 //0
list pid primarysite topography beh cr5id if behsitecheckcat==4

** behsitecheckcat 5: Beh==2 & Top==C49._(tissues)
count if behsitecheckcat==5 //0
list pid primarysite topography beh cr5id if behsitecheckcat==5

** behsitecheckcat 6: Beh==2 & Top==C70._(meninges)
count if behsitecheckcat==6 //0
list pid primarysite topography beh cr5id if behsitecheckcat==6

** behsitecheckcat 7: Beh==2 & Top==C71._(brain)
count if behsitecheckcat==7 //0
list pid primarysite topography beh cr5id if behsitecheckcat==7

** behsitecheckcat 8: Beh==2 & Top==C72._(CNS)
count if behsitecheckcat==8 //0
list pid primarysite topography beh cr5id if behsitecheckcat==8


***********
** Grade **
***********
** Check 91 - Grade missing
count if grade==. & primarysite!="" //0
list pid grade primarysite cr5id if grade==. & primarysite!=""

** Check 92 - Grade length
** Need to create string variable for grade
gen str_grade=grade
tostring str_grade, replace
** Need to change all grade=="." to grade==""
replace str_grade="" if str_grade=="." //779 changes made
count if str_grade!="" & length(str_grade)!=1 //0
list pid str_grade grade cr5id if str_grade!="" & length(str_grade)!=1
 

** Check 94 - invalid(grade)

** Below code only applies to 2014 data as 2008 & 2013 data did not collect grade.
** Taken from IACRcrgTools pg 9
** gradecheckcat 1: Beh<3 & Grade<9 & DxYr>2013
count if gradecheckcat==1 //0
list pid grade beh morph cr5id if gradecheckcat==1

** gradecheckcat 2: Grade>=5 & <=8 & Hx<9590 & DxYr>2013
count if gradecheckcat==2 //0
list pid grade beh morph cr5id if gradecheckcat==2

** gradecheckcat 3: Grade>=1 & <=4 & Hx>=9590 & DxYr>2013
count if gradecheckcat==3 //0
list pid grade beh morph cr5id if gradecheckcat==3

** gradecheckcat 4: Grade!=5 & Hx=9702-9709,9716-9726(!=9719),9729,9827,9834,9837 & DxYr>2013
count if gradecheckcat==4 //10
list pid grade beh morph cr5id if gradecheckcat==4
replace grade=5 if gradecheckcat==4 //5 changes - 5 already corrected in earlier checks.

** gradecheckcat 5: Grade!=5 or 7 & Hx=9714 & DxYr>2013
count if gradecheckcat==5 //5
list pid grade beh morph cr5id if gradecheckcat==5
replace grade=7 if pid=="20141311" & regexm(cr5id, "T1") //5 changes

** gradecheckcat 6: Grade!=5 or 8 & Hx=9700/9701/9719/9831 & DxYr>2013
count if gradecheckcat==6 //0
list pid grade beh morph cr5id if gradecheckcat==6

** gradecheckcat 7: Grade!=6 & Hx=>=9670,<=9699,9712,9728,9737,9738,>=9811,<=9818,9823,9826,9833,9836 & DxYr>2013
count if gradecheckcat==7 //12
list pid grade beh morph cr5id if gradecheckcat==7
replace grade=6 if gradecheckcat==7 //12 changes

** gradecheckcat 8: Grade!=8 & Hx=9948 & DxYr>2013
count if gradecheckcat==8 //0
list pid grade beh morph cr5id if gradecheckcat==8

** gradecheckcat 9: Grade!=1 & Hx=8331/8851/9187/9511 & DxYr>2013
count if gradecheckcat==9 //0
list pid grade beh morph cr5id if gradecheckcat==9

** gradecheckcat 10: Grade!=2 & Hx=8249/8332/8858/9083/9243/9372 & DxYr>2013
count if gradecheckcat==10 //0
list pid grade beh morph cr5id if gradecheckcat==10

** gradecheckcat 11: Grade!=3 & HX=8631/8634 & DxYr>2013
count if gradecheckcat==11 //2
list pid grade beh morph cr5id if gradecheckcat==11
replace grade=3 if gradecheckcat==11 //2 changes

** gradecheckcat 12: Grade!=4 & Hx=8020/8021/8805/9062/9082/9392/9401/9451/9505/9512 & DxYr>2013
count if gradecheckcat==12 //7
list pid grade beh morph cr5id if gradecheckcat==12
replace grade=4 if gradecheckcat==12 //7 changes

** gradecheckcat 13: Grade=9 & cfdx/md/consrpt=Gleason & DxYr>2013
count if gradecheckcat==13 //16 - 2 already corrected in earlier checks
** list pid grade cfdx md consrpt cr5id if gradecheckcat==13
list pid grade cr5id if gradecheckcat==13
replace grade=2 if pid=="20080690" & regexm(cr5id, "T3") //2 changes
replace grade=2 if pid=="20140780" & regexm(cr5id, "T1") //2 changes
replace grade=2 if pid=="20140843" & regexm(cr5id, "T1") //1 change
replace grade=2 if pid=="20140846" & regexm(cr5id, "T1") //2 changes
replace grade=2 if pid=="20140853" & regexm(cr5id, "T1") //2 changes
replace grade=2 if pid=="20140856" & regexm(cr5id, "T1") //1 change
replace grade=2 if pid=="20140862" & regexm(cr5id, "T1") //1 change
replace grade=3 if pid=="20140970" & regexm(cr5id, "T1") //1 change
replace grade=2 if pid=="20141000" & regexm(cr5id, "T1") //1 change
replace grade=3 if pid=="20141005" & regexm(cr5id, "T1") //1 change
replace grade=2 if pid=="20141013" & regexm(cr5id, "T1") //1 change
replace grade=1 if pid=="20141017" & regexm(cr5id, "T1") //1 change
replace grade=2 if pid=="20141018" & regexm(cr5id, "T1") //1 change

** gradecheckcat 14: Grade=9 & cfdx/md/consrpt=Nottingham/Bloom & DxYr>2013
count if gradecheckcat==14 //2
list pid grade cfdx md consrpt cr5id if gradecheckcat==14
replace grade=1 if pid=="20141272" & regexm(cr5id, "T1") //1 change
replace grade=3 if pid=="20141274" & regexm(cr5id, "T1") //3 changes

** gradecheckcat 15: Grade=9 & cfdx/md/consrpt=Fuhrman & DxYr>2013
count if gradecheckcat==15 //0
list pid grade cfdx md consrpt cr5id if gradecheckcat==15

** gradecheckcat 16: Grade!=6 & Hx=9732 & DxYr>2013 (see MM in HemeDb for grade)
count if gradecheckcat==16 //46
list pid grade beh morph cr5id if gradecheckcat==16
replace grade=6 if gradecheckcat==16 //46 changes

** gradecheckcat 17: Grade!=9/blank & DxYr<2014
count if (grade!=9&grade!=.) & dxyr<2014 //0
list pid cr5id if (grade!=9&grade!=.) & dxyr<2014
replace grade=9 if (grade!=9&grade!=.) & dxyr<2014 //0 changes



************************
** Basis of Diagnosis **
************************
** Check 95 - Basis missing
count if basis==. & primarysite!="" //0
list pid basis primarysite cr5id if basis==. & primarysite!=""

** Check 96 - Basis length
** Need to create string variable for basis
gen bas=basis
tostring bas, replace
** Need to change all bas=="." to bas==""
replace bas="" if bas=="." //779 changes made
count if bas!="" & length(bas)!=1 //0
list pid bas basis cr5id if bas!="" & length(bas)!=1

** Check 98 - invalid(basis)

** bascheckcat 1: morph==8000 & (basis==6|basis==7|basis==8)
count if bascheckcat==1 //0
list pid cr5id hx basis dxyr if bascheckcat==1

** bascheckcat 2: hx=...OMA & basis!=6/7/8
count if bascheckcat==2 //0
list pid cr5id hx basis dxyr if bascheckcat==2

** bascheckcat 3: Basis not missing & basis!=cyto/heme/histology... & Hx!=...see BOD/Hx Control pg 47,48 of IARCcrgTools Check Program
count if bascheckcat==3 //0
list pid primarysite hx morph basis cr5id if bascheckcat==3

** bascheckcat 4: Hx=mass; Basis=DCO; Morph==8000 - If topog=CNS then terms such as neoplasm & tumour eligible criteria (see Eligibility SOP)
count if bascheckcat==4 //0
list pid cr5id primarysite hx morph basis dxyr if bascheckcat==4

** bascheckcat 5: Basis=DCO; Comments='Notes seen'
count if bascheckcat==5 //108
list pid basis dxyr cr5id if bascheckcat==5
** Check in main CR5 db to see if true DCO then dot=dlc or if to correct basis,dot,dxyr (e.g. if notes seen by DA etc.)
replace dot=d(30jun2012) if pid=="20140034" & regexm(cr5id, "T1") //1 change
replace basis=9 if pid=="20140034" & regexm(cr5id, "T1") //1 change
replace dxyr=2012 if pid=="20140034" & regexm(cr5id, "T1") //1 change

replace primarysite="PERIAMPULLARY MALIGNANCY" if pid=="20140044" & regexm(cr5id, "T1") //1 change
replace topography=241 if pid=="20140044" & regexm(cr5id, "T1") //1 change
replace top="241" if pid=="20140044" & regexm(cr5id, "T1") //1 change
replace topcat=25 if pid=="20140044" & regexm(cr5id, "T1") //1 change
replace basis=9 if pid=="20140044" & regexm(cr5id, "T1") //1 change
replace dot=d(19jan2014) if pid=="20140044" & regexm(cr5id, "T1") //1 change

replace basis=9 if pid=="20140063" & regexm(cr5id, "T1") //2 changes

replace dot=d(02nov2011) if pid=="20140065" & regexm(cr5id, "T1") //2 changes
replace dxyr=2011 if pid=="20140065" & regexm(cr5id, "T1") //2 changes
replace basis=7 if pid=="20140065" & regexm(cr5id, "T1") //2 changes

replace basis=9 if pid=="20140068" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2007) if pid=="20140101" & regexm(cr5id, "T1") //2 changes
replace basis=9 if pid=="20140101" & regexm(cr5id, "T1") //2 changes
replace dxyr=2007 if pid=="20140101" & regexm(cr5id, "T1") //2 changes

replace comments="JC 01NOV18: case ineligible as COD does not indicate behaviour of tumour so beh=1(uncertain). 23AUG18_TH Notes seen, case ineligilble. Pt diagnosed by CT scan on 06DEC13. Record status updated. No F/U Needed. Abstracted from Database." if pid=="20140120" //1 change
replace cstatus=3 if pid=="20140120" & regexm(cr5id, "T1") //0 changes - Check 70 has beh=1 so case ineligible for that reason not because it's 2013
replace recstatus=3 if pid=="20140120" & regexm(cr5id, "T1") //0 changes - Check 70 has beh=1 so case ineligible for that reason not because it's 2013
replace dot=d(06dec2013) if pid=="20140120" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20140120" & regexm(cr5id, "T1") //1 change
replace basis=2 if pid=="20140120" & regexm(cr5id, "T1") //1 change
replace rx1=9 if pid=="20140120" & regexm(cr5id, "T1") //1 change

replace basis=1 if pid=="20140123" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20140140" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140140" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140140" & regexm(cr5id, "T1") //0 changes
replace basis=9 if pid=="20140140" & regexm(cr5id, "T1") //2 changes
replace dot=d(15oct2013) if pid=="20140140" & regexm(cr5id, "T1") //2 changes
replace dxyr=2013 if pid=="20140140" & regexm(cr5id, "T1") //2 changes
replace rx1=9 if pid=="20140140" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2013) if pid=="20140157" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20140157" & regexm(cr5id, "T1") //1 change
replace cstatus=1 if pid=="20140157" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140157" & regexm(cr5id, "T1") //1 change
replace basis=9 if pid=="20140157" & regexm(cr5id, "T1") //1 change
replace staging=9 if pid=="20140157" & regexm(cr5id, "T1") //0 changes
replace rx1=9 if pid=="20140157" & regexm(cr5id, "T1") //1 change

replace basis=9 if pid=="20140164" & regexm(cr5id, "T1") //2 changes

replace dot=d(11oct2007) if pid=="20140187" & regexm(cr5id, "T1") //2 changes
replace basis=7 if pid=="20140187" & regexm(cr5id, "T1") //2 changes
replace dxyr=2007 if pid=="20140187" & regexm(cr5id, "T1") //2 changes

replace primarysite="PERIAMPULLARY TUMOUR" if pid=="20140188" & regexm(cr5id, "T1") //1 change
replace topography=241 if pid=="20140188" & regexm(cr5id, "T1") //1 change
replace top="241" if pid=="20140188" & regexm(cr5id, "T1") //1 change
replace topcat=25 if pid=="20140188" & regexm(cr5id, "T1") //1 change
replace beh=1 if pid=="20140188" & regexm(cr5id, "T1") //1 change
replace basis=9 if pid=="20140188" & regexm(cr5id, "T1") //1 change
replace cstatus=3 if pid=="20140188" & regexm(cr5id, "T1") //1 change
replace recstatus=3 if pid=="20140188" & regexm(cr5id, "T1") //1 change

replace basis=9 if pid=="20140210" & regexm(cr5id, "T1") //1 change
replace dot=d(13nov2013) if pid=="20140210" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20140210" & regexm(cr5id, "T1") //1 change
replace staging=9 if pid=="20140210" & regexm(cr5id, "T1") //0 changes
replace rx1=0 if pid=="20140210" & regexm(cr5id, "T1") //1 change
replace norx1=0 if pid=="20140210" & regexm(cr5id, "T1") //1 change

replace basis=1 if pid=="20140231" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2009) if pid=="20140241" & regexm(cr5id, "T1") //2 changes
replace basis=9 if pid=="20140241" & regexm(cr5id, "T1") //2 changes
replace dxyr=2009 if pid=="20140241" & regexm(cr5id, "T1") //2 changes

replace basis=9 if pid=="20140244" & regexm(cr5id, "T1") //2 changes

replace basis=1 if pid=="20140255" & regexm(cr5id, "T1") //1 change

replace basis=1 if pid=="20140290" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun1985) if pid=="20140303" & regexm(cr5id, "T1") //1 change
replace basis=9 if pid=="20140303" & regexm(cr5id, "T1") //1 change
replace dxyr=1985 if pid=="20140303" & regexm(cr5id, "T1") //1 change

replace basis=9 if pid=="20140332" & regexm(cr5id, "T1") //1 change

replace basis=9 if pid=="20140337" & regexm(cr5id, "T1") //2 changes

replace dot=d(09aug2010) if pid=="20140341" & regexm(cr5id, "T1") //2 changes
replace basis=7 if pid=="20140341" & regexm(cr5id, "T1") //2 changes
replace dxyr=2010 if pid=="20140341" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2007) if pid=="20140342" & regexm(cr5id, "T1") //2 changes
replace basis=9 if pid=="20140342" & regexm(cr5id, "T1") //2 changes
replace dxyr=2007 if pid=="20140342" & regexm(cr5id, "T1") //2 changes

replace basis=1 if pid=="20140346" & regexm(cr5id, "T1") //1 change

replace basis=9 if pid=="20140369" & regexm(cr5id, "T1") //3 changes

replace dot=d(30jun2012) if pid=="20140372" & regexm(cr5id, "T1") //2 changes
replace basis=1 if pid=="20140372" & regexm(cr5id, "T1") //2 changes
replace dxyr=2012 if pid=="20140372" & regexm(cr5id, "T1") //2 changes

replace basis=1 if pid=="20140374" & regexm(cr5id, "T1") //2 changes

replace basis=9 if pid=="20140379" & regexm(cr5id, "T1") //2 changes
replace resident=9 if pid=="20140379" & regexm(cr5id, "T1") //2 changes

replace cstatus=1 if pid=="20140381" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140381" & regexm(cr5id, "T1") //2 changes
replace basis=9 if pid=="20140381" & regexm(cr5id, "T1") //2 changes
replace staging=9 if pid=="20140381" & regexm(cr5id, "T1") //2 changes
replace dot=d(15nov2013) if pid=="20140381" & regexm(cr5id, "T1") //2 changes
replace dxyr=2013 if pid=="20140381" & regexm(cr5id, "T1") //2 changes
replace rx1=9 if pid=="20140381" & regexm(cr5id, "T1") //2 changes

replace basis=9 if pid=="20140397" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun1999) if pid=="20140397" & regexm(cr5id, "T1") //2 changes
replace dxyr=1999 if pid=="20140397" & regexm(cr5id, "T1") //2 changes

replace basis=7 if pid=="20140401" & regexm(cr5id, "T1") //2 changes
replace dot=d(11jul2007) if pid=="20140401" & regexm(cr5id, "T1") //2 changes
replace dxyr=2007 if pid=="20140401" & regexm(cr5id, "T1") //2 changes

replace basis=1 if pid=="20140420" & regexm(cr5id, "T1") //1 change

replace basis=1 if pid=="20140426" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace recstatus=1 if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace nsdate=d(04apr2017) if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace primarysite="BREAST-UPPER INNER & OUTER QUADRANTS" if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace topography=508 if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace top="508" if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace topcat=43 if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace hx="INVASIVE CARCINOMA WITH DUCTAL AND LOBULAR FEATURES" if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace morph=8522 if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace morphcat=10 if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace lat=1 if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace grade=9 if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace basis=7 if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace staging=4 if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace dot=d(08mar2013) if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace dxyr=2013 if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace consultant="S FERDINAND" if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace rx1=1 if pid=="20140427" & regexm(cr5id, "T1") //4 changes
replace rx1d=d(28nov2013) if pid=="20140427" & regexm(cr5id, "T1") //4 changes

replace basis=2 if pid=="20140432" & regexm(cr5id, "T1") //2 changes

replace basis=9 if pid=="20140435" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun2010) if pid=="20140435" & regexm(cr5id, "T1") //2 changes
replace dxyr=2010 if pid=="20140435" & regexm(cr5id, "T1") //2 changes

replace primarysite="UNKNOWN" if pid=="20140442" & regexm(cr5id, "T1") //1 change
replace topography=809 if pid=="20140442" & regexm(cr5id, "T1") //1 change
replace top="809" if pid=="20140442" & regexm(cr5id, "T1") //1 change
replace topcat=70 if pid=="20140442" & regexm(cr5id, "T1") //1 change
replace basis=1 if pid=="20140442" & regexm(cr5id, "T1") //1 change

replace basis=9 if pid=="20140450" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun2006) if pid=="20140450" & regexm(cr5id, "T1") //2 changes
replace dxyr=2006 if pid=="20140450" & regexm(cr5id, "T1") //2 changes

replace basis=1 if pid=="20140451" & regexm(cr5id, "T1") //1 change

replace basis=9 if pid=="20140453" & regexm(cr5id, "T1") //2 changes
replace dot=d(15sep2011) if pid=="20140453" & regexm(cr5id, "T1") //2 changes
replace dxyr=2011 if pid=="20140453" & regexm(cr5id, "T1") //2 changes

replace basis=9 if pid=="20140480" & regexm(cr5id, "T1") //2 changes

replace basis=1 if pid=="20140482" & regexm(cr5id, "T1") //1 change

replace basis=9 if pid=="20140485" & regexm(cr5id, "T1") //2 changes
replace resident=2 if pid=="20140485" & regexm(cr5id, "T1") //2 changes

replace basis=9 if pid=="20140486" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun1995) if pid=="20140486" & regexm(cr5id, "T1") //1 change
replace dxyr=1995 if pid=="20140486" & regexm(cr5id, "T1") //1 change

replace basis=9 if pid=="20140487" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun1995) if pid=="20140487" & regexm(cr5id, "T1") //2 changes
replace dxyr=1995 if pid=="20140487" & regexm(cr5id, "T1") //2 changes

replace basis=1 if pid=="20140492" & regexm(cr5id, "T1") //2 changes

replace basis=9 if pid=="20140499" & regexm(cr5id, "T1") //2 changes

replace basis=9 if pid=="20140504" & regexm(cr5id, "T1") //2 changes

replace basis=9 if pid=="20140505" & regexm(cr5id, "T1") //2 changes

replace basis=1 if pid=="20140510" & regexm(cr5id, "T1") //1 change

replace basis=1 if pid=="20140523" & regexm(cr5id, "T1") //2 changes

replace basis=7 if pid=="20140530" & regexm(cr5id, "T1") //2 changes
replace dot=d(27jul2010) if pid=="20140530" & regexm(cr5id, "T1") //2 changes
replace dxyr=2010 if pid=="20140530" & regexm(cr5id, "T1") //2 changes

replace cstatus=1 if pid=="20140534" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140534" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140534" & regexm(cr5id, "T1") //0 changes
replace basis=1 if pid=="20140534" & regexm(cr5id, "T1") //2 changes
replace staging=7 if pid=="20140534" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun2013) if pid=="20140534" & regexm(cr5id, "T1") //2 changes
replace dxyr=2013 if pid=="20140534" & regexm(cr5id, "T1") //2 changes
replace rx1=9 if pid=="20140534" & regexm(cr5id, "T1") //2 changes

replace basis=1 if pid=="20140551" & regexm(cr5id, "T1") //2 changes

replace basis=1 if pid=="20140568" & regexm(cr5id, "T1") //1 change

replace basis=9 if pid=="20140609" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun2000) if pid=="20140609" & regexm(cr5id, "T1") //2 changes
replace dxyr=2000 if pid=="20140609" & regexm(cr5id, "T1") //2 changes

replace basis=1 if pid=="20140620" & regexm(cr5id, "T1") //1 change

replace basis=9 if pid=="20140622" & regexm(cr5id, "T1") //1 change

replace basis=1 if pid=="20140623" & regexm(cr5id, "T1") //2 changes

replace basis=2 if pid=="20140624" & regexm(cr5id, "T1") //2 changes
replace dot=d(18jan2012) if pid=="20140624" & regexm(cr5id, "T1") //2 changes
replace dxyr=2012 if pid=="20140624" & regexm(cr5id, "T1") //2 changes

replace basis=1 if pid=="20140629" & regexm(cr5id, "T1") //1 change

replace basis=7 if pid=="20140630" & regexm(cr5id, "T1") //2 changes
replace dot=d(27aug2006) if pid=="20140630" & regexm(cr5id, "T1") //2 changes
replace dxyr=2006 if pid=="20140630" & regexm(cr5id, "T1") //2 changes

replace basis=7 if pid=="20140652" & regexm(cr5id, "T1") //2 changes
replace dot=d(03jan2011) if pid=="20140652" & regexm(cr5id, "T1") //2 changes
replace dxyr=2011 if pid=="20140652" & regexm(cr5id, "T1") //2 changes

replace basis=9 if pid=="20140654" & regexm(cr5id, "T1") //2 changes

replace basis=7 if pid=="20141536" & regexm(cr5id, "T1") //2 changes
replace dot=d(07dec2005) if pid=="20141536" & regexm(cr5id, "T1") //2 changes
replace dxyr=2005 if pid=="20141536" & regexm(cr5id, "T1") //2 changes


*********************
** Summary Staging **
*********************
** NOTE 1: Staging only done at 5 year intervals so staging done on 2013 data then 2018 and so on;
** NOTE 2: In upcoming years of data collection (2018 dc year), more stagecheckcat checks will be compiled based on site in SEER Summary Staging manual.

** Check 99 - For 2014 data, replace blank and non-blank stage with code 'NA'
count if staging==. & dxyr==2014 //2,324
replace staging=8 if staging==. & dxyr==2014 //2,324 changes
count if staging!=8 & dxyr==2014 //132
replace staging=8 if staging!=8 & dxyr==2014 //132 changes

********************
** Incidence Date **
********************
** Check 103 - InciDate missing
count if dot==. & primarysite!="" //22
list pid dotyear dotmonth dotday cr5id if dot==. & primarysite!=""
** replace missing incidence dates using dotyear, dotmonth, dotday and
** checking main CR5 to ensure missing day and month (30jun) is logical
** in terms of CR5 comments and other dates e.g. admdate, dlc, treatment dates, etc.
replace dot=d(15may2014) if pid=="20140340" & regexm(cr5id, "T1") //1 change
replace dot=d(09apr2014) if pid=="20140685" & regexm(cr5id, "T1") //1 change
replace dot=d(30may2014) if pid=="20140700" & regexm(cr5id, "T1") //1 change
replace dot=d(30may2014) if pid=="20140701" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2014) if pid=="20140773" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2012) if pid=="20140777" & regexm(cr5id, "T1") //1 change
replace dxyr=2012 if pid=="20140777" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2014) if pid=="20140801" & regexm(cr5id, "T1") //1 change
replace dlc=d(02nov2015) if pid=="20140801" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2014) if pid=="20140808" & regexm(cr5id, "T1") //2 changes
replace dlc=d(30jun2014) if pid=="20140808" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun2014) if pid=="20140817" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2014) if pid=="20140827" & regexm(cr5id, "T1") //2 changes
replace dot=d(15jul2014) if pid=="20140829" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun2014) if pid=="20140841" & regexm(cr5id, "T1") //2 changes

replace comments="JC 01NOV18: MasterDb comments #2641 indicated dxyr=2011 but clin dets of both path rpts show clinical dx=goitre so case eligible as 2013. 03AUG18_KWG Case ineligible. Had Clerk in lab search Pt and Pt was diagnosed previously and had surgery in 2013. 2014 report is a follow-on of initial findings. Record status updated. 27JUL18_SF Changed FRSource from RT to QEH to see when original Path Rpt was done.  F/U Needed with Qeh Medical Records for Dx date and Basis of Diagnosis. 05Jan18_KWG Pt registered in RT Dept with definite diagnosis. ? Final dx." if pid=="20141150" & regexm(cr5id, "T1") //3 changes
replace cstatus=1 if pid=="20141150" & regexm(cr5id, "T1") //0 changes - MasterDb indicated dxyr=2011 but clin dets of both path rpts show clinical dx=goitre so case eligible as 2013.
replace recstatus=1 if pid=="20141150" & regexm(cr5id, "T1") //0 changes - MasterDb indicated dxyr=2011 but clin dets of both path rpts show clinical dx=goitre so case eligible as 2013.
replace nsdate=d(06mar2017) if pid=="20141150" & regexm(cr5id, "T1") //3 changes
replace primarysite="THYROID-RT LOWER LOBE" if pid=="20141150" & regexm(cr5id, "T1") //3 changes
replace topography=739 if pid=="20141150" & regexm(cr5id, "T1") //0 changes
replace top="739" if pid=="20141150" & regexm(cr5id, "T1") //0 changes
replace topcat=65 if pid=="20141150" & regexm(cr5id, "T1") //0 changes
replace hx="PAPILLARY CARCINOMA, FOLLICULAR VARIANT" if pid=="20141150" & regexm(cr5id, "T1") //3 changes
replace morph=8340 if pid=="20141150" & regexm(cr5id, "T1") //3 changes
replace morphcat=6 if pid=="20141150" & regexm(cr5id, "T1") //3 changes
replace lat=0 if pid=="20141150" & regexm(cr5id, "T1") //0 changes
replace grade=9 if pid=="20141150" & regexm(cr5id, "T1") //0 changes
replace basis=7 if pid=="20141150" & regexm(cr5id, "T1") //3 changes
replace staging=1 if pid=="20141150" & regexm(cr5id, "T1") //3 changes
replace dot=d(27nov2013) if pid=="20141150" & regexm(cr5id, "T1") //3 changes
replace dxyr=2013 if pid=="20141150" & regexm(cr5id, "T1") //3 changes
replace consultant="V CLARKE" if pid=="20141150" & regexm(cr5id, "T1") //3 changes
replace rx1=1 if pid=="20141150" & regexm(cr5id, "T1") //3 changes
replace rx1d=d(27nov2013) if pid=="20141150" & regexm(cr5id, "T1") //3 changes

replace dot=d(30jun2014) if pid=="20150175" & regexm(cr5id, "T1") //2 changes

** Check 104 - InciDate (future date)
count if dot!=. & dot>currentdatett //0

** Check 106 - invalid(InciDate)

** dotcheckcat 1: InciDate before DOB
count if dotcheckcat==1 //0
list pid cr5id dot dob ttda dxyr if dotcheckcat==1

** dotcheckcat 2: InciDate after DLC
count if dotcheckcat==2 //1
list pid cr5id dot dlc ttda dxyr if dotcheckcat==2
replace dot=d(13may2014) if pid=="20140703" & regexm(cr5id, "T3") //1 change

** dotcheckcat 3: Basis=DCO & InciDate!=DLC
/* Since errors corrected in bascheckcat 5 above then to get true list for dotcheckcat 3 need to write code
count if dotcheckcat==3 //112
list pid cr5id dot dlc basis ttda cstatus recstatus dxyr if dotcheckcat==3
*/
count if dot!=. & dlc!=. & basis==0 & dot!=dlc //45
list pid dot dlc basis ttda cstatus recstatus cr5id if dot!=. & dlc!=. & basis==0 & dot!=dlc

** Check in main CR5 db to see if true DCO then dot=dlc or if to correct basis,dot,dxyr (e.g. if notes seen by DA etc.)
replace basis=1 if pid=="20140077" & regexm(cr5id, "T3") //2 changes
replace dot=dlc if pid=="20140087" & regexm(cr5id, "T1") //2 changes
replace dot=dlc if pid=="20140117" & regexm(cr5id, "T1") //2 changes
replace dot=d(01oct2011) if pid=="20140129" & regexm(cr5id, "T1") //1 change
replace dxyr=2011 if pid=="20140129" & regexm(cr5id, "T1") //1 change
replace basis=7 if pid=="20140129" & regexm(cr5id, "T1") //1 change
replace dxyr=2011 if pid=="20140129" & regexm(cr5id, "T2") //1 change
replace recstatus=4 if pid=="20140129" & regexm(cr5id, "T2") //1 change
replace dot=d(30jun2010) if pid=="20140130" & regexm(cr5id, "T1") //2 changes
replace basis=7 if pid=="20140130" & regexm(cr5id, "T1") //2 changes
replace dxyr=2010 if pid=="20140130" & regexm(cr5id, "T1") //2 changes
replace dot=d(22apr2012) if pid=="20140134" & regexm(cr5id, "T1") //2 changes
replace basis=7 if pid=="20140134" & regexm(cr5id, "T1") //2 changes
replace dxyr=2012 if pid=="20140134" & regexm(cr5id, "T1") //2 changes
replace dot=dlc if pid=="20140159" & regexm(cr5id, "T1") //2 changes
replace basis=7 if pid=="20140232" & regexm(cr5id, "T1") //2 changes
replace basis=5 if pid=="20140324" & regexm(cr5id, "T1") //3 changes
replace dot=dlc if pid=="20140370" & regexm(cr5id, "T1") //2 changes
replace dot=dlc if pid=="20140385" & regexm(cr5id, "T1") //2 changes
replace dot=dlc if pid=="20140424" & regexm(cr5id, "T1") //2 changes
replace dot=dlc if pid=="20140446" & regexm(cr5id, "T1") //2 changes
replace dot=d(27mar2012) if pid=="20140496" & regexm(cr5id, "T1") //2 changes
replace basis=9 if pid=="20140496" & regexm(cr5id, "T1") //2 changes
replace dxyr=2012 if pid=="20140496" & regexm(cr5id, "T1") //2 changes
replace dot=d(30jun2007) if pid=="20140509" & regexm(cr5id, "T1") //2 changes
replace basis=9 if pid=="20140509" & regexm(cr5id, "T1") //2 changes
replace dxyr=2007 if pid=="20140509" & regexm(cr5id, "T1") //2 changes
replace dot=dlc if pid=="20140535" & regexm(cr5id, "T1") //2 changes
replace basis=9 if pid=="20140539" & regexm(cr5id, "T1") //2 changes
replace basis=9 if pid=="20140573" & regexm(cr5id, "T1") //3 changes
replace dot=dlc if pid=="20140597" & regexm(cr5id, "T1") //2 changes
replace cstatus=0 if pid=="20140778" & regexm(cr5id, "T1") //2 changes - JC 01nov18 didn't correct in main CR5db; will leave team to correct when 2014 corrections list generated
replace dot=dlc if pid=="20140778" & regexm(cr5id, "T1") //2 changes - JC 01nov18 didn't correct in main CR5db; will leave team to correct when 2014 corrections list generated
replace dxyr=2015 if pid=="20140778" & regexm(cr5id, "T1") //2 changes - JC 01nov18 didn't correct in main CR5db; will leave team to correct when 2014 corrections list generated
replace basis=9 if pid=="20141535" & regexm(cr5id, "T1") //2 changes
replace basis=9 if pid=="20141547" & regexm(cr5id, "T1") //2 changes

** dotcheckcat 4: InciDate<>DFC/AdmDate/RTdate/SampleDate/ReceiveDate/RptDate/DLC (2014 onwards)
count if dotcheckcat==4 //29
**list pid dot dfc admdate rtdate sampledate recvdate rptdate dlc cr5id if dotcheckcat==4
list pid dot dfc admdate rtdate sampledate recvdate rptdate cr5id if dotcheckcat==4
replace admdate=d(22oct2014) if pid=="20140555" & regexm(cr5id, "T2") //1 change - also updated main CR5 db on 24oct2018 as I abstracted this case

** dotcheckcat 5: InciDate=DFC; DFC after AdmDate/RTdate/SampleDate/ReceiveDate/RptDate (2014 onwards)
count if dotcheckcat==5 //0
list pid cr5id dot dfc admdate rtdate sampledate recvdate rptdate ttda dxyr if dotcheckcat==5

** dotcheckcat 6: InciDate=AdmDate; AdmDate after DFC/RTdate/SampleDate/ReceiveDate/RptDate (2014 onwards)
count if dotcheckcat==6 //0
list pid cr5id dot dfc admdate rtdate sampledate recvdate rptdate ttda dxyr if dotcheckcat==6

** dotcheckcat 7: InciDate=RTdate; RTdate after DFC/AdmDate/SampleDate/ReceiveDate/RptDate (2014 onwards)
count if dotcheckcat==7 //0
list pid cr5id dot dfc admdate rtdate sampledate recvdate rptdate ttda dxyr if dotcheckcat==7

** dotcheckcat 8: InciDate=SampleDate; SampleDate after DFC/AdmDate/RTdate/ReceiveDate/RptDate (2014 onwards)
count if dotcheckcat==8 //3
list pid cr5id dot dfc admdate rtdate sampledate recvdate rptdate ttda dxyr if dotcheckcat==8
replace recvdate=d(30jul2014) if pid=="20141391" & cr5id=="T1S2" //1 change
replace sampledate=d(04feb2014) if pid=="20145012" & cr5id=="T1S1" //1 change
replace recvdate=d(07feb2014) if pid=="20145012" & cr5id=="T1S1" //1 change
replace rptdate=d(10feb2014) if pid=="20145012" & cr5id=="T1S1" //1 change
replace dot=d(04feb2014) if pid=="20145012" & regexm(cr5id, "T1") //2 changes
replace recvdate=d(24feb2014) if pid=="20145035" & cr5id=="T1S1" //1 change

** dotcheckcat 9: InciDate=ReceiveDate; ReceiveDate after DFC/AdmDate/RTdate/SampleDate/RptDate (2014 onwards)
count if dotcheckcat==9 //0
list pid cr5id dot dfc admdate rtdate sampledate recvdate rptdate ttda dxyr if dotcheckcat==9

** dotcheckcat 10: InciDate=RptDate; RptDate after DFC/AdmDate/RTdate/SampleDate/ReceiveDate (2014 onwards)
count if dotcheckcat==10 //1
list pid cr5id dot dfc admdate rtdate sampledate recvdate rptdate ttda dxyr if dotcheckcat==10
replace dot=d(10jan2014) if pid=="20140085" & regexm(cr5id, "T1") //2 changes


********************
** Diagnosis Year **
********************
** Check 107 - DxYr missing
count if dxyr==. //0 - already corrected in 1_prep_cancer_dc.do
list pid ptdoa stdoa dot dxyr cr5id if dxyr==.

** Check 108 - DxYr length
** Need to create string variable for DxYr
gen diagyr=dxyr
tostring diagyr, replace
** Need to change all diagyr=="." to diagyr==""
replace diagyr="" if diagyr=="." //0 changess made
count if diagyr!="" & length(diagyr)!=4 //0
list pid diagyr dxyr cr5id if diagyr!="" & length(diagyr)!=4
 

** Check 110 - invalid(dxyr)

** dxyrcheckcat 1: dotyear!=dxyr
** 20080706 T4: JC 11JUL2018 changed dxyr from 2011 to 2010
count if dxyrcheckcat==1 //0
list pid cr5id dot dotyear dxyr ttda if dxyrcheckcat==1

** dxyrcheckcat 2: admyear!=dxyr & dxyr>2013
count if dxyrcheckcat==2 //7
list pid cr5id admdate admyear dxyr ttda if dxyrcheckcat==2
replace admdate=d(19feb2014) if pid=="20130162" & regexm(cr5id, "T2") //1 change - incidental finding of cancer so dot=rptdate
replace admdate=dot if pid=="20130175" & regexm(cr5id, "T2") //1 change
replace dxyr=2013 if pid=="20130692" & regexm(cr5id, "T3") //2 changes

replace cstatus=1 if pid=="20140002" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140002" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140002" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140002" & regexm(cr5id, "T1") //0 changes
replace basis=9 if pid=="20140002" & regexm(cr5id, "T1") //2 changes
replace staging=7 if pid=="20140002" & regexm(cr5id, "T1") //2 changes
replace dot=d(20dec2013) if pid=="20140002" & regexm(cr5id, "T1") //2 changes
replace dxyr=2013 if pid=="20140002" & regexm(cr5id, "T1") //2 changes
replace consultant=certifier if pid=="20140002" & regexm(cr5id, "T1") //2 changes
replace rx1=9 if pid=="20140002" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2012) if pid=="20140006" & regexm(cr5id, "T1") //2 changes
replace basis=9 if pid=="20140006" & regexm(cr5id, "T1") //2 changes
replace dxyr=2012 if pid=="20140006" & regexm(cr5id, "T1") //2 changes

replace cstatus=1 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace mpseq=0 if pid=="20140015" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20140015" & regexm(cr5id, "T1") //0 changes
replace primarysite="CERVIX" if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace topography=539 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace top="539" if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace topcat=46 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace hx="CANCER" if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace morph=8000 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace morphcat=1 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140015" & regexm(cr5id, "T1") //2 changes - 0 changess as already done in earlier check
replace beh=3 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace basis=9 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace stage=7 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace dot=d(30dec2013) if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace dxyr=2013 if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace consultant="A MAYNARD" if pid=="20140015" & regexm(cr5id, "T1") //2 changes
replace rx1=9 if pid=="20140015" & regexm(cr5id, "T1") //2 changes

replace cstatus=1 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace recstatus=1 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace notesseen=1 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace nsdate=d(04aug2016) if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace checkstatus=1 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace mpseq=0 if pid=="20140062" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20140062" & regexm(cr5id, "T1") //0 changes
replace primarysite="STOMACH-POSTERIOR WALL" if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace topography=168 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace top="168" if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace topcat=17 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace hx="ADENOCARCINOMA" if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace morph=8140 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace morphcat=6 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace lat=0 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace latcat=0 if pid=="20140062" & regexm(cr5id, "T1") //0 changes - 0 changess as already done in earlier check
replace beh=3 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace grade=9 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace basis=9 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace staging=4 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace dot=d(23oct2013) if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace dxyr=2013 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace consultant="S GRIFFITH/M WALROND" if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace rx1=1 if pid=="20140062" & regexm(cr5id, "T1") //4 changes
replace rx1d=d(29nov2013) if pid=="20140062" & regexm(cr5id, "T1") //4 changes

** dxyrcheckcat 3: dfcyear!=dxyr & dxyr>2013
count if dxyrcheckcat==3 //0
list pid cr5id dfc dfcyear dxyr ttda if dxyrcheckcat==3

** dxyrcheckcat 4: rtyear!=dxyr & dxyr>2013
count if dxyrcheckcat==4 //0
list pid cr5id rtdate rtyear dxyr ttda if dxyrcheckcat==4


****************
** Consultant **
****************
** No checks on this as checks done under 'Doctor' variable


********************
** Treatments 1-5 **
********************
** NOTE 1: Treatment only collected at 5 year intervals so treatment collected on 2013 data then 2018 and so on;
** NOTE 2: In upcoming years of data collection (2018 dc year), more rxcheckcat checks will be compiled based on data.

** Check 111 - For 2014 data, replace blank and non-blank treatment with code 'ND'
count if rx1==. & dxyr==2014 //1,658
replace rx1=9 if rx1==. & dxyr==2014 //1,658 changes
count if (rx1!=. & rx1!=9) & dxyr==2014 //814
list pid rx1 dxyr cr5id if (rx1!=. & rx1!=9) & dxyr==2014
replace rx1=9 if (rx1!=. & rx1!=9) & dxyr==2014 //814 changes

count if rx2!=. & dxyr==2014 //249
list pid rx2 cr5id if rx2!=. & dxyr==2014
replace rx2=. if rx2!=. & dxyr==2014 //249 changes

count if rx3!=. //0
count if rx4!=. //0
count if rx5!=. //0

*************************
** Treatments 1-5 Date **
*************************
** Missing dates already captured in checkflags in Rx1-5

** Check 115 - For 2014 data, replace non-blank treatment dates with missing value
count if rx1d!=. & dxyr==2014 //796
replace rx1d=. if rx1d!=. & dxyr==2014 //796 changes

count if rx2d!=. & dxyr==2014 //246
list pid rx2d cr5id if rx2d!=. & dxyr==2014
replace rx2d=. if rx2d!=. & dxyr==2014 //246 changes

count if rx3d!=. & dxyr==2014 //0
count if rx4d!=. & dxyr==2014 //0
count if rx5d!=. & dxyr==2014 //0

***************************
** Other Treatment 1 & 2 **
***************************
** NOTE 1: Treatment only collected at 5 year intervals so treatment collected on 2013 data then 2018 and so on;
** NOTE 2: In upcoming years of data collection (2018 dc year), more rxcheckcat checks will be compiled based on data.

** Check 116 - For 2014 data, replace non-blank other treatment with missing value
count if orx1!=. & dxyr==2014 //0

count if orx2!="" & dxyr==2014 //3
list pid orx2 dxyr cr5id if orx2!="" & dxyr==2014
replace orx2="" if orx2!="" & dxyr==2014 //3 changes


***************************
** No Treatments 1 and 2 **
***************************
** NOTE 1: Treatment only collected at 5 year intervals so treatment collected on 2013 data then 2018 and so on;
** NOTE 2: In upcoming years of data collection (2018 dc year), more rxcheckcat checks will be compiled based on data.


** Check 119 - For 2014 data, replace non-blank no treatment with missing value
count if norx1!=. & dxyr==2014 //5
list pid norx1 dxyr cr5id if norx1!=. & dxyr==2014
replace norx1=. if norx1!=. & dxyr==2014 //5 changes

count if norx2!=. & dxyr==2014 //0


**********************************************************
** BLANK & INCONSISTENCY CHECKS - SOURCE TABLE
** CHECKS 120 - 173
** (1) FLAG POSSIBLE INCONSISTENCIES 
** (2) EXPORT TO EXCEL FOR CANCER TEAM TO CORRECT
**********************************************************

*********************
** Unique SourceID **
*********************
count if sid=="" //0

************************
** ST Data Abstractor **
************************
** Check 120 - missing
count if stda==. //2 - leave blank until email reply from KWG/SAF re 20141529, 20145093 & 20145099; KWG corrected in main CR5db on 30oct18
list pid cr5id if stda==.
/*
replace stda=13 if pid=="20141529" & cr5id=="T1S1" //1 change
replace stda=98 if pid=="20145099" & cr5id=="T1S1" //1 change
*/

** Length check not needed as this field is numeric
** Check 121 - invalid code
count if stda!=. & stda>14 & (stda!=22 & stda!=88 & stda!=98 & stda!=99) //0
list pid stda cr5id if stda!=. & stda>14 & (stda!=22 & stda!=88 & stda!=98 & stda!=99)

*****************
** Source Date **
*****************
** Check 122 - missing
count if stdoa==. //3 - one corrected, awaiting email reply from KWG/SAF re 20141529 & 20145099
list pid cr5id if stdoa==.
replace stda=13 if pid=="20141351" & cr5id=="T2S1" //1 change
replace stdoa=d(11oct2017) if pid=="20141351" & cr5id=="T2S1" //1 change
replace nftype=03 if pid=="20141351" & cr5id=="T2S1" //1 change
replace sourcename=1 if pid=="20141351" & cr5id=="T2S1" //1 change
replace doctor="M OSHEA / N YHAP" if pid=="20141351" & cr5id=="T2S1" //1 change
replace docaddr="B7" if pid=="20141351" & cr5id=="T2S1" //1 change
replace cfdx="Subtotal colectomy specimen: - Adenocarcinomata (x2). - 17/17 Lymph nodes, negative for metastasis. - Tubular adenomata (x2). - See microscopic description." if pid=="20141351" & cr5id=="T2S1" //1 change
replace labnum="14185415" if pid=="20141351" & cr5id=="T2S1" //1 change
replace specimen="Subtotal colectomy specimen" if pid=="20141351" & cr5id=="T2S1" //1 change
replace sampledate=d(07oct2014) if pid=="20141351" & cr5id=="T2S1" //1 change
replace recvdate=d(08oct2014) if pid=="20141351" & cr5id=="T2S1" //1 change
replace rptdate=d(10oct2014) if pid=="20141351" & cr5id=="T2S1" //1 change
replace clindets="Previous surg. No 14165933. 85 y/o with LGIB previously had colonoscopy Sept 2014 - showed 3 mass in caecum plus descending colon and polyp w/transverse colon. Had subtotal colectomy. Clinical diagnosis: Colonic carcinoma." if pid=="20141351" & cr5id=="T2S1" //1 change
replace md="Sections taken of both tumours described in the gross show adenocarcinomata arising from the mucosa and invading the wall only as deep as the muscularis propria in the distal tumour but extending through the full thickness to reach pericolic tissue in the caecal tumour. The caecal tumour displays focally prominent extra-cellular mucin production. No blood vascular or lymphatic permeation is obvious. A total of seventeen (17) lymph nodes are identified microscopically and all are negative for malignancy. The teo mucosal polyps are tubular adenomata with mild to moderate epithelial dysplastic change and there is no evidence of invasive malignancy. The vermiform appendix, random sections and longitudinal resection margins are free of tumour." if pid=="20141351" & cr5id=="T2S1" //1 change

** Check 123 - invalid (future date)
** Need to create a variable with current date;
** to be used when cleaning dates
gen currentdst=c(current_date)
gen double currentdatest=date(currentdst, "DMY", 2017)
drop currentdst
format currentdatest %dD_m_CY
label var currentdatest "Current date ST"
count if stdoa!=. & stdoa>currentdatest //0


*************
** NF Type **
*************
** Check 124 - NFtype missing
count if nftype==. //4 - one corrected, awaiting email reply from KWG/SAF re 20141529, 20145093 & 20145099
list pid nftype dxyr cr5id if nftype==.
replace nftype=3 if pid=="20140186" & regexm(cr5id, "T1") //1 change

** Check 125 - NFtype length
** Need to create string variable for nftype
gen notiftype=nftype
tostring notiftype, replace
** Need to change all notiftype"." to notiftype""
replace notiftype="" if notiftype=="." //4 changes made
count if notiftype!="" & length(notiftype)>2 //0
list pid notiftype nftype dxyr cr5id if notiftype!="" & length(notiftype)>2

** Check 126 - NFtype=Other(possibly invalid)
count if nftype==13 //0
list pid nftype dxyr cr5id if nftype==13


*****************
** Source Name **
*****************
** NOTE 1: Patient notes only to be seen at 5 year intervals so e.g. notes seen on 2013 data then 2018 and so on;
** NOTE 2: In upcoming years of data collection (2018 dc year), more checks may be compiled based on data.

** Check 127 - Source Name missing (NB: some may have been since corrected in main CR5 by cancer team as this was first run on 24apr18 using 05mar2018 data)
count if sourcename==. //4 - one corrected, awaiting email reply from KWG/SAF re 20141529, 20145093 & 20145099
list pid nftype sourcename dxyr cr5id if sourcename==.
replace sourcename=9 if pid=="20140186" & regexm(cr5id, "T1") //1 change

** Check 129 - invalid(sourcename)

** sourcecheckcat 1: SourceName invalid length
count if sourcecheckcat==1 //0
list pid cr5id sname sourcename dxyr stda if sourcecheckcat==1

** sourcecheckcat 2: SourceName!=QEH/BVH; NFType=Hospital; dxyr>2013
count if sourcecheckcat==2 //0
list pid cr5id nftype sourcename dxyr stda if sourcecheckcat==2

** sourcecheckcat 3: SourceName=IPS-ARS; NFType!=Pathology; dxyr>2013
count if sourcecheckcat==3 //0
list pid cr5id nftype sourcename dxyr stda if sourcecheckcat==3

** sourcecheckcat 4: SourceName=DeathRegistry; NFType!=Death Certif/PM; dxyr>2013
count if sourcecheckcat==4 //0
list pid cr5id nftype sourcename dxyr stda if sourcecheckcat==4

** sourcecheckcat 5: SourceName!=QEH; NFType=QEH Death Rec/RT bk; dxyr>2013
count if sourcecheckcat==5 //0
list pid cr5id nftype sourcename dxyr stda if sourcecheckcat==5

** sourcecheckcat 6: SourceName!=BVH; NFType=BVH bk; dxyr>2013
count if sourcecheckcat==6 //0
list pid cr5id nftype sourcename dxyr stda if sourcecheckcat==6

** sourcecheckcat 7: SourceName!=Polyclinic; NFType=Poly/Dist.Hosp; dxyr>2013
count if sourcecheckcat==7 //0
list pid cr5id nftype sourcename dxyr stda if sourcecheckcat==7

** sourcecheckcat 8: SourceName=Other(possibly invalid)
count if sourcecheckcat==8 //25 - 4 no correction needed
list pid cr5id nftype sourcename dxyr stda if sourcecheckcat==8
replace sourcename=5 if sourcename==8 & nftype==8 //21 changes


************
** Doctor **
************
** NOTE 1: Patient notes only to be seen at 5 year intervals so e.g. notes seen on 2013 data then 2018 and so on;
** NOTE 2: In upcoming years of data collection (2018 dc year), more checks may be compiled based on data.

** Check 130 - Doctor missing
count if doctor=="" //80
list pid consultant doctor dxyr cr5id if doctor==""
replace doctor=consultant if doctor=="" & consultant!="" //17 changes
replace doctor="99" if doctor=="" //63 changes
							
** Check 132 - invalid(doctor)

** doccheckcat 1: Doctor invalid ND code
count if doccheckcat==1 //210
list pid cr5id doctor dxyr stda if doccheckcat==1
replace doctor="99" if doccheckcat==1 //210


**********************
** Doctor's Address **
**********************
** NOTE 1: Patient notes only to be seen at 5 year intervals so e.g. notes seen on 2013 data then 2018 and so on;
** NOTE 2: In upcoming years of data collection (2018 dc year), more checks may be compiled based on data.

** Check 133 - Doctor's Address missing
count if docaddr=="" //51
list pid consultant doctor docaddr dxyr cr5id if docaddr==""
replace docaddr="99" if docaddr=="" //51 changes

					
** Check 135 - invalid(docaddr)

** docaddrcheckcat 1: Doc Address invalid ND code
count if docaddrcheckcat==1 //65
list pid cr5id doctor docaddr dxyr stda if docaddrcheckcat==1
replace docaddr="99" if docaddrcheckcat==1 //65 changes


******************
** CF Diagnosis **
******************
** NOTE 1: Patient notes only to be seen at 5 year intervals so e.g. notes seen on 2013 data then 2018 and so on;
** NOTE 2: In upcoming years of data collection (2018 dc year), more checks may be compiled based on data.

** Check 138 - CF Dx missing / CF Dx missing if nftype!=death~/cyto
** 20130361 JC 24MAY18 T2S1: Changed in main CR5 added 'BREAST, RIGHT, CORE BIOPSY : INVASIVE DUCTAL CARCINOMA'.
** Discussed with SAF & KWG on 22may2018 and determined that CFDx to change from blank to 99 if CFDiagnosis=''(total of 314 records changed);
** IMPORTANT: WHEN IMPORTING BATCH CORRECTIONS - UNTICK 'Do Checks' IN MAIN CR5! WHEN CHECKS ARE RUN THE RECORD STATUS CHANGES.
** saving excel workbook as .txt and then importing into main CR5
count if cfdx=="" //3 - one corrected, awaiting email reply from KWG/SAF re 20145093 & 20145099
list pid cfdx doctor dxyr cr5id if cfdx==""
replace cfdx="99" if pid=="20140427" & cr5id=="T1S2" //1 change
count if cfdx=="" & (nftype!=8 & nftype!=9) //2 - awaiting email reply from KWG/SAF re 20145093 & 20145099
list pid cfdx doctor dxyr cr5id if cfdx=="" & (nftype!=8 & nftype!=9)
count if cfdx=="" & (nftype!=4 & nftype!=8 & nftype!=9) //2 - awaiting email reply from KWG/SAF re 20145093 & 20145099
list pid nftype cfdx doctor dxyr cr5id if cfdx=="" & (nftype!=4 & nftype!=8 & nftype!=9)

** Check 139 - CF Dx invalid ND code
** (Checked data in main CR5 to determine invalid ND values by filtering in CR5 Browse/Edit by Source table, sorted by field, looking at all variables and scrolling through entire field column.)
count if cfdx=="Not Stated"|cfdx=="9" //0
list pid cfdx dxyr cr5id if cfdx=="Not Stated"|cfdx=="9"

** No more checks as difficult to perform standardized checks on this field as sometimes it has topographic info and sometimes has morphologic info so
** no consistency to perform a set of checks
** See visual lists in 'Specimen' category below

****************
** Lab Number **
****************

** Check 140 - Lab # missing / Lab # missing if nftype=Lab~
count if labnum=="" //737
list pid nftype labnum dxyr cr5id if labnum==""
count if labnum=="" & (nftype>2 & nftype<6) //3
list pid nftype labnum dxyr cr5id if labnum=="" & (nftype>2 & nftype<6)
replace labnum="99" if pid=="20140427" & cr5id=="T1S2" //1 change
replace labnum="99" if pid=="20140808" & cr5id=="T1S2" //1 change
replace labnum="99" if pid=="20150175" & cr5id=="T1S2" //1 change

** Check 141 - Lab # invalid ND code
** (Checked data in main CR5 to determine invalid ND values by filtering in CR5 Browse/Edit by Source table, sorted by field, looking at all variables and scrolling through entire field column.)
count if labnum=="Not Stated"|labnum=="9" //2
list pid labnum dxyr cr5id if labnum=="Not Stated"|labnum=="9"
replace labnum="99" if pid=="20140441" & cr5id=="T1S2" //1 change
replace labnum="99" if pid=="20140676" & cr5id=="T1S2" //1 change

** No more checks as difficult to perform standardized checks on this field as sometimes it has topographic info and sometimes has morphologic info so
** no consistency to perform a set of checks
** See visual lists in 'Specimen' category below

**************
** Specimen **
**************

** Check 142 - Specimen missing / Specimen missing if nftype=Lab~
count if specimen=="" //743
list pid nftype specimen dxyr cr5id if specimen==""
count if specimen=="" & (nftype>2 & nftype<6) //8
list pid nftype specimen dxyr cr5id if specimen=="" & (nftype>2 & nftype<6)
replace specimen="99" if pid=="20140427" & cr5id=="T1S2" //1 change
replace specimen="99" if pid=="20140808" & cr5id=="T1S2" //1 change
replace specimen="99" if pid=="20141059" & cr5id=="T2S1" //1 change
replace specimen="99" if pid=="20141250" & cr5id=="T1S2" //1 change
replace specimen="99" if pid=="20141268" & cr5id=="T1S2" //1 change
replace specimen="99" if pid=="20141538" & cr5id=="T1S2" //1 change
replace specimen="99" if pid=="20145077" & cr5id=="T1S1" //1 change
replace specimen="99" if pid=="20150175" & cr5id=="T1S2" //1 change

** Check 143 - Specimen invalid ND code
** (Checked data in main CR5 to determine invalid ND values by filtering in CR5 Browse/Edit by Source table, sorted by field, looking at all variables and scrolling through entire field column.)
count if specimen=="Not Stated"|specimen=="9" //0
list pid specimen dxyr cr5id if specimen=="Not Stated"|specimen=="9"


*******************************************
** Sample Taken, Received & Report Dates **
*******************************************
** Check 144 - Sample Date invalid(future date)
count if sampledate!=. & sampledate>currentdatest //0
list pid cr5id sampledate dxyr stda if sampledate!=. & sampledate>currentdatest

** Check 145 - Received Date invalid (future date)
count if recvdate!=. & recvdate>currentdatest //1
list pid cr5id recvdate dxyr stda if recvdate!=. & recvdate>currentdatest
replace recvdate=d(24apr2014) if pid=="20141481" & cr5id=="T2S2" //1 change

** Check 146 - Report Date invalid (future date)
count if rptdate!=. & rptdate>currentdatest //0
list pid cr5id rptdate dxyr stda if rptdate!=. & rptdate>currentdatest

				
** Check 148 - invalid(sampledate,recvdate,rptdate)

** rptcheckcat 1: Sample Date missing
count if rptcheckcat==1 //0
list pid cr5id nftype sampledate recvdate rptdate dxyr stda if rptcheckcat==1

** rptcheckcat 2: Received Date missing
count if rptcheckcat==2 //0
list pid cr5id nftype sampledate recvdate rptdate dxyr stda if rptcheckcat==2

** rptcheckcat 3: Report Date missing
count if rptcheckcat==3 //62
list pid cr5id nftype sampledate recvdate rptdate dxyr stda if rptcheckcat==3
replace rptdate=d(01jan2000) if rptcheckcat==3 //62 changes

** rptcheckcat 4: sampledate after recvdate
count if rptcheckcat==4 //2
list pid cr5id sampledate recvdate rptdate dxyr stda if rptcheckcat==4
replace recvdate=d(21may2014) if pid=="20140518" & cr5id=="T1S2" //1 change
replace sampledate=d(25nov2014) if pid=="20141297" & cr5id=="T1S1" //1 change
replace recvdate=d(26nov2014) if pid=="20141297" & cr5id=="T1S1" //1 change
replace basis=7 if pid=="20141297" & regexm(cr5id, "T1") //1 change
replace dot=d(30jun2011) if pid=="20141297" & regexm(cr5id, "T1") //1 change
replace dxyr=2011 if pid=="20141297" & regexm(cr5id, "T1") //1 change

** rptcheckcat 5: sampledate after rptdate
count if rptcheckcat==5 //19 - all sample dates are missing so use missing date value
list pid cr5id sampledate recvdate rptdate dxyr stda if rptcheckcat==5
list pid cr5id sampledate if rptcheckcat==5
replace sampledate=d(01jan2000) if rptcheckcat==5 //19 changes

** rptcheckcat 6: recvdate after rptdate
count if rptcheckcat==6 //4 - 20141481 T2S2 recvdate already corrected in check 145
list pid cr5id sampledate recvdate rptdate dxyr stda if rptcheckcat==6
replace recvdate=d(07may2014) if pid=="20140301" & cr5id=="T2S1" //1 change
replace rptdate=d(16jul2014) if pid=="20140739" & cr5id=="T2S1" //1 change
replace recvdate=d(15aug2014) if pid=="20140863" & cr5id=="T1S1" //1 change

** rptcheckcat 7: sampledate before InciD
count if rptcheckcat==7 //1
list pid cr5id dot sampledate recvdate rptdate dxyr stda if rptcheckcat==7
replace dot=d(21feb2014) if pid=="20140683" & regexm(cr5id, "T1") //2 changes

** rptcheckcat 8: recvdate before InciD
count if rptcheckcat==8 //7 - 20140085, 20141391, 20145035 already corrected in check 106
list pid cr5id dot sampledate recvdate rptdate dxyr stda if rptcheckcat==8
replace recvdate=d(28nov2014) if pid=="20140851" & cr5id=="T1S1" //1 change
replace dot=d(18feb2014) if pid=="20140924" & cr5id=="T1S1" //1 change
replace dot=d(10jan2014) if pid=="20141167" & regexm(cr5id, "T1") //1 change
replace dot=d(03nov2014) if pid=="20141311" & regexm(cr5id, "T1") //5 changes

** rptcheckcat 9: rptdate before InciD
count if rptcheckcat==9 //14
list pid cr5id dot sampledate recvdate rptdate dxyr stda if rptcheckcat==9
replace basis=7 if pid=="20140327" & regexm(cr5id, "T1") //2 changes
replace dot=d(27may2012) if pid=="20140327" & regexm(cr5id, "T1") //2 changes
replace dxyr=2012 if pid=="20140327" & regexm(cr5id, "T1") //2 changes
replace dot=d(12jun2014) if pid=="20140758" & regexm(cr5id, "T1") //4 changes
replace dot=d(23jun2014) if pid=="20140760" & regexm(cr5id, "T1") //3 changes
replace dot=d(13jun2014) if pid=="20140766" & regexm(cr5id, "T1") //3 changes
replace dot=d(30sep2014) if pid=="20140821" & regexm(cr5id, "T1") //3 changes
replace dot=d(26jul2014) if pid=="20140882" & regexm(cr5id, "T1") //2 changes
replace dot=d(15nov2013) if pid=="20141163" & regexm(cr5id, "T1") //3 changes
replace dxyr=2013 if pid=="20141163" & regexm(cr5id, "T1") //3 changes
replace dot=d(07aug2014) if pid=="20141287" & regexm(cr5id, "T1") //3 changes
replace rptdate=d(20jan2015) if pid=="20141287" & cr5id=="T1S1" //1 change
replace dot=d(14mar2014) if pid=="20141546" & regexm(cr5id, "T1") //2 changes
replace cstatus=1 if pid=="20141568" & regexm(cr5id, "T1") //3 changes
replace recstatus=1 if pid=="20141568" & regexm(cr5id, "T1") //3 changes
replace primarysite="APPENDIX" if pid=="20141568" & regexm(cr5id, "T1") //3 changes
replace topography=181 if pid=="20141568" & regexm(cr5id, "T1") //3 changes
replace top="181" if pid=="20141568" & regexm(cr5id, "T1") //3 changes
replace topcat=19 if pid=="20141568" & regexm(cr5id, "T1") //3 changes
replace basis=7 if pid=="20141568" & regexm(cr5id, "T1") //3 changes
replace dot=d(15aug2014) if pid=="20141568" & regexm(cr5id, "T1") //3 changes
replace dot=d(21feb2014) if pid=="20145027" & regexm(cr5id, "T1") //3 changes

** rptcheckcat 10: sampledate after DLC
count if rptcheckcat==10 //10
list pid cr5id dlc sampledate recvdate rptdate dxyr stda if rptcheckcat==10
replace dlc=d(17jan2014) if pid=="20080403" //1 change
replace dlc=d(23mar2014) if pid=="20130398" //1 change
replace comments="JC 06NOV18: T2 merged incorrectly with 20130398 instead of 20140398 so T2 of 20130398 to be deleted by KWG. JC 24OCT18: T2 does not belong to this patient as T2=endometrial ca but pt is male - incorrect merge but cancer team needs to call IPS (listed in T2S1 record) for correct pt info and abstract case. 20FEB18_KWG Incorrect merge. Pt is male, however tumour T2S1 is a Pth report for endometrium. Check made in death data and Pt is indeed male.None seen as notes cannot be retrieved.None seen as notes cannot be retrieved.None seen as notes cannot be retrievedNo F/U needed. Notes cannot be retrieved due to target date to complete 2013 cases. Abstracted from CFDb and electronic death data. Coroner's Inqueset, but PM report not seen in DB." if pid=="20130398" //1 change
drop if pid=="20130398" //1 obs deleted
replace dlc=d(03apr2014) if pid=="20140694" //3 changes
replace dlc=d(15may2015) if pid=="20140803" //4 changes
replace dlc=d(10feb2015) if pid=="20140843" //2 changes
replace dlc=d(27aug2014) if pid=="20141018" //2 changes
replace dlc=d(05feb2014) if pid=="20141150" //2 changes
replace dlc=d(04may2015) if pid=="20141266" //2 changes
replace dlc=d(11aug2015) if pid=="20141377" //3 changes
replace dlc=d(16dec2014) if pid=="20141568" //3 changes

** rptcheckcat 11: sampledate!=. & nftype!=lab~ & labnum=. (to filter out autopsies with hx)
count if rptcheckcat==11 //0
list pid cr5id nftype sampledate dxyr stda if rptcheckcat==11

** rptcheckcat 12: recvdate!=. & nftype!=lab~ & labnum=. (to filter out autopsies with hx)
count if rptcheckcat==12 //0
list pid cr5id nftype recvdate dxyr stda if rptcheckcat==12

** rptcheckcat 13: rptdate!=. & nftype!=lab~ & labnum=. (to filter out autopsies with hx)
count if rptcheckcat==13 //0
list pid cr5id nftype rptdate dxyr stda if rptcheckcat==13


**********************
** Clinical Details **
**********************
** Check 149 - Clinical Details missing / Clinical Details missing if nftype=Lab~
count if clindets=="" //745
list pid nftype clindets dxyr cr5id if clindets==""
count if clindets=="" & (nftype>2 & nftype<6) //8
list pid nftype clindets dxyr cr5id if clindets=="" & (nftype>2 & nftype<6)
replace clindets="99" if pid=="20140427" & cr5id=="T1S2" //1 change
replace clindets="99" if pid=="20140808" & cr5id=="T1S2" //1 change
replace clindets="99" if pid=="20141059" & cr5id=="T2S1" //1 change
replace clindets="99" if pid=="20141250" & cr5id=="T1S2" //1 change
replace clindets="99" if pid=="20141268" & cr5id=="T1S2" //1 change
replace clindets="99" if pid=="20141538" & cr5id=="T1S2" //1 change
replace clindets="99" if pid=="20145004" & cr5id=="T1S2" //1 change
replace clindets="99" if pid=="20150175" & cr5id=="T1S2" //1 change

** Check 150 - Clinical Details invalid ND code
** (Checked data in main CR5 to determine invalid ND values by filtering in CR5 Browse/Edit by Source table, sorted by field, looking at all variables and scrolling through entire field column.)
count if clindets=="Not Stated"|clindets=="NIL"|regexm(clindets, "NONE")|clindets=="9" //5
list pid clindets dxyr cr5id if clindets=="Not Stated"|clindets=="NIL"|regexm(clindets, "NONE")|clindets=="9"
replace clindets="99" if clindets=="Not Stated"|clindets=="NIL"|regexm(clindets, "NONE")|clindets=="9" //5 changes


**************************
** Cytological Findings **
**************************
** Check 151 - Cytological Findings missing / Cytological Findings missing if nftype=Lab-Cyto
count if cytofinds=="" //1,400
count if cytofinds=="" & (nftype>2 & nftype<6) //660
count if cytofinds=="" & nftype==4 //0
list pid nftype cytofinds dxyr cr5id if cytofinds=="" & nftype==4

** Check 152 - Cytological Findings invalid ND code
** (Checked data in main CR5 to determine invalid ND values by filtering in CR5 Browse/Edit by Source table, sorted by field, looking at all variables and scrolling through entire field column.)
count if cytofinds=="Not Stated"|cytofinds=="9" //0
list pid cytofinds dxyr cr5id if cytofinds=="Not Stated"|cytofinds=="9"


*****************************
** Microscopic Description **
*****************************
** Check 153 - MD missing / MD missing if nftype=Lab~
count if md=="" //790
count if md=="" & (nftype>2 & nftype<6) //59
count if md=="" & (nftype==3|nftype==5) //9
list pid nftype md dxyr cr5id if md=="" & (nftype==3|nftype==5)
replace md="99" if pid=="20140427" & cr5id=="T1S2" //1 change
replace md="99" if pid=="20140702" & cr5id=="T1S1" //1 change
replace dxyr=2009 if pid=="20140702" & cr5id=="T1S1" //1 change
replace md="99" if pid=="20140808" & cr5id=="T1S2" //1 change
replace md="99" if pid=="20141059" & cr5id=="T2S1" //1 change
replace md="99" if pid=="20141250" & cr5id=="T1S2" //1 change
replace md="99" if pid=="20141268" & cr5id=="T1S2" //1 change
replace md="99" if pid=="20141538" & cr5id=="T1S2" //1 change

replace cstatus=1 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace recstatus=1 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace notesseen=3 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace checkstatus=1 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace mpseq=0 if pid=="20145010" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20145010" & regexm(cr5id, "T1") //0 changes
replace dob=d(10jun1975) if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace natregno="750610-0101" if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace slc=1 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace dlc=d(15apr2014) if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace addr="3RD AVE NURSE LD TWEEDSIDE RD" if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace primarysite="BREAST-RT 7 & 10 OCLOCK" if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace topography=508 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace top="508" if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace topcat=43 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace hx="CARCINOMA" if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace morph=8522 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace morphcat=10 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace lat=1 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace latcat=31 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace beh=3 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace grade=2 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace basis=7 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace staging=4 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace dot=d(31dec2013) if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace dxyr=2013 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace consultant="M WALROND/D BARKER" if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace rx1=1 if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace rx1d=d(21mar2014) if pid=="20145010" & regexm(cr5id, "T1") //3 changes
replace md="99" if pid=="20145010" & cr5id=="T1S1" //1 change

replace md="99" if pid=="20150175" & cr5id=="T1S2" //1 change

** Check 154 - MD invalid ND code
** (Checked data in main CR5 to determine invalid ND values by filtering in CR5 Browse/Edit by Source table, sorted by field, looking at all variables and scrolling through entire field column.)
count if md=="Not Stated."|md=="Not Stated"|md=="9" //1
list pid md dxyr cr5id if md=="Not Stated."|md=="Not Stated"|md=="9"
replace md="99" if md=="Not Stated."|md=="Not Stated"|md=="9" //1 change


*************************
** Consultation Report **
*************************
** NOTE 1: Met with SAF and KWG on 22may18 and decision made to remove checks for this variable; also removed checkflags from excel export code below.

** Check 155 - Consult.Rpt missing / Consult.Rpt missing if nftype=Lab~
count if consrpt=="" & (nftype==3|nftype==5) //469
list pid nftype consrpt dxyr cr5id if consrpt=="" & (nftype==3|nftype==5)
replace consrpt="99" if consrpt=="" & (nftype==3|nftype==5) //469

** Check 156 - Consult.Rpt invalid ND code
** (Checked data in main CR5 to determine invalid ND values by filtering in CR5 Browse/Edit by Source table, sorted by field, looking at all variables and scrolling through entire field column.)
count if consrpt=="Not Stated"|consrpt=="Not Stated."|consrpt=="9" //74
list pid consrpt dxyr cr5id if consrpt=="Not Stated"|consrpt=="Not Stated."|consrpt=="9"
replace consrpt="99" if consrpt=="Not Stated"|consrpt=="Not Stated."|consrpt=="9" //74 changes


***********************
** Cause(s) of Death **
***********************

** Check 157a - Check below list if pid occurs more than once then check main CR5 db to see if sources have same/different CODs
/* 
JC 25oct18: I created below Check 157a as I incidentally found pid 20140047 has 2 source records with differing CODs (see T1S3 vs T1S4) 
possibly due to incorrect merging?
To quickly identify duplicates: 
(1) copy results list into excel sheet then 
(2) higlight column with pid in it and convert text to columns in data tab of excel using fixed width
(3) highlight pid column then using conditional formatting identify duplicates by clicking-->Highlight Cell Rules-->Duplicate Values
(4) all duplicate pids will be highlighted in red
(5) repeat above steps in different excel sheet for cr5cod list then copy next to pid column
(6) filter pid column by colour
(7) check each duplicate pid's COD and indicate if CODs match or do not match
(8) for those that do not  match then double check in main CR5 db and then email cancer team
*/
count if (cr5cod!="" & cr5cod!="99") & dxyr==2014 //936 - 20140047 T1S3 does not match T1S4 so emailed KWG/SAF for confirmation before dropping, no other mismatches found!
list pid cr5id cr5cod if (cr5cod!="" & cr5cod!="99") & dxyr==2014
list cr5cod if (cr5cod!="" & cr5cod!="99") & dxyr==2014
** JC 08nov18 - 20140047 T1S3 & T1S4 CODs do not match: I checked QEH Death bk and Cyto Lab rpt and same pt is on both so it seems the CODs in T1S3 were provisional so the final CODs are in S4 so add comments to CR5db indicating this.
replace comments="JC 11NOV18: T1S3 & T1S4 CODs do not match: I checked QEH Death bk and Cyto Lab rpt and same pt is on both so it seems the CODs in T1S3 were provisional so the final CODs are in S4. No F/U needed. Abs from notes. 16jan2018 JC: added in source as death info didn't import when XML updates were done." if pid=="20140047" & regexm(cr5id, "T1") //4 changes

** Check 157b - COD missing / COD missing if nftype=Death~
count if cr5cod=="" //1002
list pid nftype cr5cod dxyr cr5id if cr5cod==""
count if cr5cod=="" & (nftype==8|nftype==9) //10
list pid nftype cr5cod dxyr cr5id if cr5cod=="" & (nftype==8|nftype==9)
replace cr5cod="99" if pid=="20140289" & cr5id=="T1S4" //1 change
replace cr5cod="99" if pid=="20140299" & cr5id=="T1S2" //1 change
replace cr5cod="99" if pid=="20140308" & cr5id=="T1S3" //1 change
replace dot=d(31may2014) if pid=="20140308" & regexm(cr5id, "T1") //3 changes
replace cr5cod="99" if pid=="20140325" & cr5id=="T1S3" //1 change
replace dot=d(04jun2014) if pid=="20140325" & regexm(cr5id, "T1") //3 changes
replace cr5cod="99" if pid=="20140390" & cr5id=="T1S2" //1 change

replace primarysite="STOMACH-LESSER CURVATURE" if pid=="20140437" & regexm(cr5id, "T1") //5 changes
replace topography=165 if pid=="20140437" & regexm(cr5id, "T1") //5 changes
replace top="165" if pid=="20140437" & regexm(cr5id, "T1") //5 changes
replace topcat=17 if pid=="20140437" & regexm(cr5id, "T1") //0 changes
replace hx="ADENOCARCINOMA" if pid=="20140437" & regexm(cr5id, "T1") //5 changes
replace morph=8140 if pid=="20140437" & regexm(cr5id, "T1") //5 changes
replace morphcat=6 if pid=="20140437" & regexm(cr5id, "T1") //5 changes
replace cr5cod="99" if pid=="20140437" & cr5id=="T1S5" //1 change

replace cr5cod="99" if pid=="20140516" & cr5id=="T1S3" //1 change
replace cr5cod="99" if pid=="20140538" & cr5id=="T1S3" //1 change
replace cr5cod="99" if pid=="20140615" & cr5id=="T1S2" //1 change
replace cr5cod="99" if pid=="20145157" & cr5id=="T1S2" //1 change

** Check 158 - COD invalid ND code
** (Checked data in main CR5 to determine invalid ND values by filtering in CR5 Browse/Edit by Source table, sorted by field, looking at all variables and scrolling through entire field column.)
count if regexm(cr5cod, "Not")|regexm(cr5cod, "not")|cr5cod=="NIL."|cr5cod=="Not Stated"|cr5cod=="9" //8
list pid cr5cod dxyr cr5id if regexm(cr5cod, "Not")|regexm(cr5cod, "not")|cr5cod=="NIL."|cr5cod=="Not Stated"|cr5cod=="9"
replace cr5cod="99" if regexm(cr5cod, "Not")|regexm(cr5cod, "not")|cr5cod=="NIL."|cr5cod=="Not Stated"|cr5cod=="9" //8 changes

** Check 159 - COD invalid entry(lowercase)
count if cr5cod!="99" & cr5cod!="" & regexm(cr5cod, "[a-z]") //17
list pid cr5cod dxyr cr5id if cr5cod!="99" & cr5cod!="" & regexm(cr5cod, "[a-z]")
replace cr5cod=upper(cr5cod) if cr5cod!="99" & cr5cod!="" & regexm(cr5cod, "[a-z]") //17 changes


*************************
** Duration of Illness **
*************************
** Check 160 - Duration of Illness missing / Duration of Illness missing if nftype=Death~
count if duration=="" & nftype==8 //197 - 06nov18 SAF (by email) indicated to run code only on death certificates and not QEH death bks so removed 'nftype==9' from code.
list pid nftype duration onsetint dxyr cr5id if duration=="" & nftype==8
replace duration="99" if duration=="" & nftype==8 //197 changes

** Check 161 - Duration of Illness invalid ND code
** (Checked data in main CR5 to determine invalid ND values by filtering in CR5 Browse/Edit by Source table, sorted by field, looking at all variables and scrolling through entire field column.)
count if regexm(duration, "UNKNOWN")|regexm(duration, "Not")|regexm(duration, "not")|duration=="NIL."|duration=="Not Stated"|duration=="9" //3
list pid duration dxyr cr5id if regexm(duration, "UNKNOWN")|regexm(duration, "Not")|regexm(duration, "not")|duration=="NIL."|duration=="Not Stated"|duration=="9"
replace duration="99" if regexm(duration, "UNKNOWN")|regexm(duration, "Not")|regexm(duration, "not")|duration=="NIL."|duration=="Not Stated"|duration=="9" //3 changes

** Check 162 - Duration of Illness invalid entry(lowercase)
count if duration!="99" & duration!="" & regexm(duration, "[a-z]") //3
list pid duration dxyr cr5id if duration!="99" & duration!="" & regexm(duration, "[a-z]")
replace duration=upper(duration) if duration!="99" & duration!="" & regexm(duration, "[a-z]") //3 changes

*****************************
** Onset to Death Interval **
*****************************
** Check 163 - Onset to Death Interval missing / Onset to Death Interval missing if nftype=Death~
count if onsetint=="" & nftype==8 //197 - 06nov18 SAF (by email) indicated to run code only on death certificates and not QEH death bks so removed 'nftype==9' from code.
list pid nftype onsetint dxyr cr5id if onsetint=="" & nftype==8
replace onsetint="99" if onsetint=="" & nftype==8 //197 changes

** Check 164 - Onset to Death Interval invalid ND code
** (Checked data in main CR5 to determine invalid ND values by filtering in CR5 Browse/Edit by Source table, sorted by field, looking at all variables and scrolling through entire field column.)
count if regexm(onsetint, "UNKNOWN")|regexm(onsetint, "Not")|regexm(onsetint, "not")|onsetint=="NIL."|onsetint=="Not Stated"|onsetint=="9" //8
list pid onsetint dxyr cr5id if regexm(onsetint, "UNKNOWN")|regexm(onsetint, "Not")|regexm(onsetint, "not")|onsetint=="NIL."|onsetint=="Not Stated"|onsetint=="9"
replace onsetint="99" if regexm(onsetint, "UNKNOWN")|regexm(onsetint, "Not")|regexm(onsetint, "not")|onsetint=="NIL."|onsetint=="Not Stated"|onsetint=="9" //8 changes

** Check 165 - Onset to Death Interval invalid entry(lowercase)
count if onsetint!="99" & onsetint!="" & regexm(onsetint, "[a-z]") //1
list pid onsetint dxyr cr5id if onsetint!="99" & onsetint!="" & regexm(onsetint, "[a-z]")
replace onsetint=upper(onsetint) if onsetint!="99" & onsetint!="" & regexm(onsetint, "[a-z]") //1 change

***************
** Certifier **
***************
** NOTE 1: Met with SAF and KWG on 22may18 and decision made to remove checks for this variable from review/corrections code; also removed checkflags from excel export code below.

** Check 166 - Certifier missing / Certifier missing if nftype=Death~
count if certifier=="" & (nftype==8|nftype==9) //250
list pid nftype certifier dxyr cr5id if certifier=="" & (nftype==8|nftype==9)
replace certifier="99" if certifier=="" & (nftype==8|nftype==9) //250 changes

** Check 167 - Certifier invalid ND code
** (Checked data in main CR5 to determine invalid ND values by filtering in CR5 Browse/Edit by Source table, sorted by field, looking at all variables and scrolling through entire field column.)
count if regexm(certifier, "UNKNOWN")|regexm(certifier, "Not")|regexm(certifier, "not")|certifier=="NIL."|certifier=="Not Stated"|certifier=="9" //0
list pid certifier dxyr cr5id if regexm(certifier, "UNKNOWN")|regexm(certifier, "Not")|regexm(certifier, "not")|certifier=="NIL."|certifier=="Not Stated"|certifier=="9"

** Check 168 - Certifier invalid entry(lowercase)
count if certifier!="99" & certifier!="" & regexm(certifier, "[a-z]") //1
list pid certifier dxyr cr5id if certifier!="99" & certifier!="" & regexm(certifier, "[a-z]")
replace certifier=upper(certifier) if certifier!="99" & certifier!="" & regexm(certifier, "[a-z]") //1 change

***********************************
** Admission, DFC & RT Reg Dates **
***********************************
** Check 169 - Admission Date invalid(future date)
count if admdate!=. & admdate>currentdatest //0
list pid cr5id admdate dxyr stda if admdate!=. & admdate>currentdatest

** Check 170 - DFC Date invalid (future date)
count if dfc!=. & dfc>currentdatest //0
list pid cr5id dfc dxyr stda if dfc!=. & dfc>currentdatest

** Check 171 - RT Date invalid (future date)
count if rtdate!=. & rtdate>currentdatest //0
list pid cr5id rtdate dxyr stda if rtdate!=. & rtdate>currentdatest


** Check 173 - invalid(admdate,dfc,rtdate)

** datescheckcat 1: Admission Date missing
count if datescheckcat==1 //1,024 - leave as is since SAF/KWG to decide if to collect missing dates
list pid cr5id sourcename nftype admdate dfc rtdate dxyr stda if datescheckcat==1

** datescheckcat 2: DFC missing
count if datescheckcat==2 //15 - leave as is since SAF/KWG to decide if to collect missing dates
list pid cr5id sourcename nftype admdate dfc rtdate dxyr stda if datescheckcat==2

** datescheckcat 3: RT Date missing
count if datescheckcat==3 //1 - leave as is since SAF/KWG to decide if to collect missing dates
list pid cr5id sourcename nftype admdate dfc rtdate dxyr stda if datescheckcat==3

** datescheckcat 4: admdate/dfc/rtdate BEFORE InciD
count if datescheckcat==4 //0
list pid cr5id dot admdate dfc rtdate dxyr stda if datescheckcat==4

** datescheckcat 5: admdate/dfc/rtdate after DLC
count if datescheckcat==5 //0
list pid cr5id dlc admdate dfc rtdate dxyr stda if datescheckcat==5

** datescheckcat 6: admdate!=. & sourcename!=hosp
count if datescheckcat==6 //0
list pid cr5id sourcename nftype admdate dfc rtdate dxyr stda if datescheckcat==6

** datescheckcat 7: dfc!=. & sourcename!=PrivPhys/IPS
count if datescheckcat==7 //0
list pid cr5id sourcename nftype admdate dfc rtdate dxyr stda if datescheckcat==7

** datescheckcat 8: rtdate!=. & nftype!=RT
count if datescheckcat==8 //0
list pid cr5id sourcename nftype admdate dfc rtdate dxyr stda if datescheckcat==8


****************
** Notes Seen **
****************

** Additional check for PT variable
** Check 174 - Notes Seen (check for missed 2013 cases that were abstracted in this dofile) 
count if notesseen==0 & dxyr==2013 //1
list pid cr5id if notesseen==0 & dxyr==2013
** Check main CR5db then correct
replace notesseen=4 if notesseen==0 & dxyr==2013 //1 change

** Check 175 - Notes Seen=pending retrieval; dxyr>2013 (for 2018 data collection this check will be revised)
count if notesseen==0 & dxyr>2013 //845
list pid dxyr cr5id if notesseen==0 & dxyr>2013
** Check main CRdb or add to above code: (regexm(comments, "Notes seen")|comments, "Notes seen"))
replace notesseen=4 if notesseen==0 & dxyr>2013 //845 changes

** Check 176 - Notes Seen=Yes but NS date=blank; dxyr=2014
count if notesseen==1 & nsdate==. & dxyr==2014 //81 - unnecessary to check each case for data cleaning but will flag in data review code
list pid comments cr5id if notesseen==1 & nsdate==. & dxyr==2014
replace nsdate=d(01jan2000) if notesseen==1 & nsdate==. & dxyr==2014 //81 changes

** Check 177 - Notes Seen=No; recstatus!=dup; dxyr==2013
count if notesseen==3 & recstatus!=4 & dxyr==2013 //25
list pid recstatus cr5id if notesseen==3 & recstatus!=4 & dxyr==2013 
replace notesseen=4 if notesseen==3 & recstatus!=4 & dxyr==2013 //25 changes

** Check 178 - Eligibility (missed 2013 & 2014 cases)
** Check all recstatus=ineligible (may need to whittle down list by including only T1?) - checking for cases (esp. deaths) where DA listed as ineligible due to 
** onset interval/duration of illness being outside registration year.
count if recstatus==3 & dxyr==2014 & (nftype==8|nftype==9) //367
list pid cr5id dlc duration onsetint if recstatus==3 & dxyr==2014 & (nftype==8|nftype==9)
list comments if recstatus==3 & dxyr==2014 & (nftype==8|nftype==9)
list cr5cod if recstatus==3 & dxyr==2014 & (nftype==8|nftype==9)

replace dot=d(30jun2012) if pid=="20140003" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140003" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140004" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140004" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140005" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140005" & regexm(cr5id,"T1") //1 change

replace dot=d(25nov2013) if pid=="20140007" & regexm(cr5id,"T1") //2 changes
replace dxyr=2013 if pid=="20140007" & regexm(cr5id,"T1") //2 changes
replace comments="JC 08NOV18: 2013 cases are eligible for abstraction but this is ineligible due to residency (MasterDb #2637). 31MAY18_KWG Pt not found on Electoral List and Death Data does not record an NRN. ?Residency. 22FEB18_KWG Case ineligible. DurationOfIllness outside of registration year. Record status updated." if pid=="20140007" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2009) if pid=="20140009" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20140009" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2011) if pid=="20140020" & regexm(cr5id,"T1") //1 change
replace dxyr=2011 if pid=="20140020" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace mpseq=1 if pid=="20140025" & regexm(cr5id, "T1") //0 changes
replace mptot=2 if pid=="20140025" & regexm(cr5id, "T1") //0 changes
replace primarysite="BLADDER" if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace topography=679 if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace top="679" if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace topcat=59 if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace hx="TRANSITIONAL CELL CARCINOMA,LOW GRADE" if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace morph=8120 if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace morphcat=5 if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140025" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace grade=1 if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace basis=7 if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140025" & regexm(cr5id, "T1") //0 changes
replace dot=d(16jan2014) if pid=="20140025" & regexm(cr5id, "T1") //1 change
replace consultant="J EMTAGE" if pid=="20140025" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2009) if pid=="20140026" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20140026" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace primarysite="UTERUS" if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace topography=559 if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace top="559" if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace topcat=48 if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140027" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140027" & regexm(cr5id, "T1") //0 changes
replace dot=d(08jan2014) if pid=="20140027" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140027" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2012) if pid=="20140028" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140028" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun1994) if pid=="20140029" & regexm(cr5id,"T1") //1 change
replace dxyr=1994 if pid=="20140029" & regexm(cr5id,"T1") //1 change

replace dot=d(15oct2012) if pid=="20140031" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140031" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace notesseen=3 if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace recstatus=1 if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace checkstatus=1 if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace primarysite="COLON" if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace topography=189 if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace top="189" if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace topcat=19 if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace hx="CANCER" if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace morph=8000 if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace morphcat=1 if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace lat=0 if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace latcat=0 if pid=="20140032" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace grade=9 if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace basis=0 if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace staging=8 if pid=="20140032" & regexm(cr5id, "T1") //0 changes
replace dot=d(17jan2014) if pid=="20140032" & regexm(cr5id, "T1") //3 changes
replace consultant="S CONNELL" if pid=="20140032" & regexm(cr5id, "T1") //3 changes

replace cstatus=1 if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace primarysite="99" if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace topography=809 if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace top="809" if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace topcat=70 if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace hx="LYMPHOMA" if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace morph=9590 if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace morphcat=41 if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140033" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140033" & regexm(cr5id, "T1") //0 changes
replace dot=d(28jan2014) if pid=="20140033" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140033" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2010) if pid=="20140036" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140036" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140037" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140037" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace primarysite="PANCREAS" if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace topography=259 if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace top="259" if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace topcat=26 if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace hx="CANCER" if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace morph=8000 if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace morphcat=1 if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140042" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace basis=0 if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace staging=8 if pid=="20140042" & regexm(cr5id, "T1") //0 changes
replace dot=d(27jan2014) if pid=="20140042" & regexm(cr5id, "T1") //2 changes
replace consultant="Y NAGDEE" if pid=="20140042" & regexm(cr5id, "T1") //2 changes

replace dot=d(15dec2012) if pid=="20140043" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140043" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2005) if pid=="20140045" & regexm(cr5id,"T1") //1 change
replace dxyr=2005 if pid=="20140045" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace comments="14NOV18 JC: See MasterDb #1540 frmCF_2009- dx in 2013 so eligible for abstraction-done in cleaning dofile. 07MAR18_KWG Case ineligible. Onset outside of registration year. Record status updated." if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace mpseq=0 if pid=="20140048" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20140048" & regexm(cr5id, "T1") //0 changes
replace primarysite="LEG,NOS" if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace topography=765 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace top="765" if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace topcat=68 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace hx="CANCEROUS LESION" if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140048" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace basis=9 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace staging=9 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace dot=d(26aug2013) if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140048" & regexm(cr5id, "T1") //1 change
replace rx1=9 if pid=="20140048" & regexm(cr5id, "T1") //0 changes

replace cstatus=1 if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace comments="14NOV18 JC: Death data indicates b'dos address altho resident=9 still abstracted as DCO in cleaning dofile.30AUG18_SF Ineligible. Unable to confirm residency.07MAR18_KWG ?Residency. Pt found in Death Data, however no NRN recorded." if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace primarysite="PANCREAS" if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace topography=259 if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace top="259" if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace topcat=26 if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace hx="CANCER" if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace morph=8000 if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace morphcat=1 if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140049" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace basis=0 if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace staging=8 if pid=="20140049" & regexm(cr5id, "T1") //0 changes
replace dot=d(29jan2014) if pid=="20140049" & regexm(cr5id, "T1") //2 changes
replace consultant="99" if pid=="20140049" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2009) if pid=="20140050" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20140050" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2011) if pid=="20140051" & regexm(cr5id,"T1") //1 change
replace dxyr=2011 if pid=="20140051" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2010) if pid=="20140054" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140054" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140057" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140057" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140061" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140061" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140067" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140067" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140069" & regexm(cr5id,"T1") //1 change
replace dxyr=2011 if pid=="20140069" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2010) if pid=="20140070" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140070" & regexm(cr5id,"T1") //1 change

replace resident=2 if pid=="20140075" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace primarysite="99" if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace topography=809 if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace top="809" if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace topcat=70 if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace hx="OCCULT MALIGNANCY" if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140078" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140078" & regexm(cr5id, "T1") //0 changes
replace dot=d(18feb2014) if pid=="20140078" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140078" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2007) if pid=="20140079" & regexm(cr5id,"T1") //1 change
replace dxyr=2007 if pid=="20140079" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2007) if pid=="20140080" & regexm(cr5id,"T1") //1 change
replace dxyr=2007 if pid=="20140080" & regexm(cr5id,"T1") //1 change

replace natregno="500802-0066" if pid=="20140081" & regexm(cr5id,"T1") //2 changes
replace dot=d(30jun2010) if pid=="20140081" & regexm(cr5id,"T1") //2 changes
replace dxyr=2010 if pid=="20140081" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140082" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140082" & regexm(cr5id,"T1") //2 changes

replace dot=d(15apr2012) if pid=="20140084" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140084" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140086" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140086" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2004) if pid=="20140088" & regexm(cr5id,"T1") //1 change
replace dxyr=2004 if pid=="20140088" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140089" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140089" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140091" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140091" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140098" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140098" & regexm(cr5id,"T1") //2 changes

replace cstatus=1 if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace primarysite="PROSTATE" if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace topography=619 if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace top="619" if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace topcat=53 if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace hx="CANCER" if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace morph=8000 if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace morphcat=1 if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140100" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace basis=0 if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace staging=8 if pid=="20140100" & regexm(cr5id, "T1") //0 changes
replace dot=d(01mar2014) if pid=="20140100" & regexm(cr5id, "T1") //2 changes
replace consultant="A CUMBERBATCH" if pid=="20140100" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2010) if pid=="20140104" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140104" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2010) if pid=="20140105" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140105" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140107" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140107" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2007) if pid=="20140109" & regexm(cr5id,"T1") //1 change
replace dxyr=2007 if pid=="20140109" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace primarysite="PROSTATE" if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace topography=619 if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace top="619" if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace topcat=53 if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140110" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140110" & regexm(cr5id, "T1") //0 changes
replace dot=d(24feb2014) if pid=="20140110" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140110" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2012) if pid=="20140111" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140111" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140113" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140113" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2002) if pid=="20140115" & regexm(cr5id,"T1") //2 changes
replace dxyr=2002 if pid=="20140115" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2004) if pid=="20140118" & regexm(cr5id,"T1") //1 change
replace dxyr=2004 if pid=="20140118" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun1998) if pid=="20140119" & regexm(cr5id,"T1") //1 change
replace dxyr=1998 if pid=="20140119" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2011) if pid=="20140121" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140121" & regexm(cr5id,"T1") //2 changes

replace cstatus=1 if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace primarysite="ESOPHAGUS" if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace topography=159 if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace top="159" if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace topcat=16 if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace hx="SQUAMOUS CELL CARCINOMA" if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace morph=8070 if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace morphcat=3 if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140124" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace grade=2 if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace basis=7 if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140124" & regexm(cr5id, "T1") //0 changes
replace dot=d(24feb2014) if pid=="20140124" & regexm(cr5id, "T1") //1 change
replace consultant="E SPRINGER-CYRUS" if pid=="20140124" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace primarysite="COLON" if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace topography=189 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace top="189" if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace topcat=19 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140127" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140127" & regexm(cr5id, "T1") //0 changes
replace dot=d(20mar2014) if pid=="20140127" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140127" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2011) if pid=="20140128" & regexm(cr5id,"T1") //1 change
replace dxyr=2011 if pid=="20140128" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140135" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140135" & regexm(cr5id,"T1") //2 changes

replace cstatus=1 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace primarysite="PROSTATE" if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace topography=619 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace top="619" if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace topcat=53 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140136" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140136" & regexm(cr5id, "T1") //0 changes
replace dot=d(27mar2014) if pid=="20140136" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140136" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace comments="14NOV18 JC: See MasterDb #1569 frmCF_2009- dx in 2013, 2012 ivg for goitre(see CD) so eligible for abstraction-done in cleaning dofile. 16Feb18_KWG Case ineligible. Onset outside of registration year. Record status updated." if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace mpseq=0 if pid=="20140148" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20140148" & regexm(cr5id, "T1") //0 changes
replace primarysite="THYROID" if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace topography=739 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace top="739" if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace topcat=65 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace hx="ENCAPSULATED MEDULLARY CARCINOMA" if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace morph=8510 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace morphcat=10 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140148" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace basis=7 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace staging=1 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace dot=d(12mar2013) if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace dxyr=2013 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace consultant="C MAYNARD" if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace rx1=1 if pid=="20140148" & regexm(cr5id, "T1") //2 changes
replace rx1d=d(12mar2013) if pid=="20140148" & regexm(cr5id, "T1") //2 changes

replace cstatus=1 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace comments="14NOV18 JC: See MasterDb #4051 & 2824 frmCF_2009- dx in 2013(see IHC) so eligible for abstraction-done in cleaning dofile. 27FEB18_KWG Case ineligible. Duration and onset outside of registration year. Record status updated." if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace mpseq=0 if pid=="20140151" & regexm(cr5id, "T1") //0 changes
replace mptot=1 if pid=="20140151" & regexm(cr5id, "T1") //0 changes
replace primarysite="KIDNEY" if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace topography=649 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace top="649" if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace topcat=56 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace hx="METASTATIC POORLY DIFFERENTIATED CARCINOMA" if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace morph=8010 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace morphcat=2 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace lat=9 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace latcat=37 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace beh=3 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace grade=3 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace basis=6 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace staging=7 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace dot=d(21dec2013) if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace dxyr=2013 if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace consultant="J WARD" if pid=="20140151" & regexm(cr5id, "T1") //1 change
replace rx1=9 if pid=="20140151" & regexm(cr5id, "T1") //0 changes

replace dot=d(30jun2007) if pid=="20140152" & regexm(cr5id,"T1") //1 change
replace dxyr=2007 if pid=="20140152" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2011) if pid=="20140155" & regexm(cr5id,"T1") //1 change
replace dxyr=2011 if pid=="20140155" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2007) if pid=="20140156" & regexm(cr5id,"T1") //2 changes
replace dxyr=2007 if pid=="20140156" & regexm(cr5id,"T1") //2 changes

replace cstatus=1 if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace notesseen=3 if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace recstatus=1 if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace checkstatus=1 if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace primarysite="NASOPHARYNX" if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace topography=119 if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace top="119" if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace topcat=12 if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace hx="SQUAMOUS CELL CARCINOMA" if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace morph=8070 if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace morphcat=3 if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace lat=0 if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace latcat=0 if pid=="20140160" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace grade=9 if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace basis=6 if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace staging=8 if pid=="20140160" & regexm(cr5id, "T1") //0 changes
replace dot=d(19feb2014) if pid=="20140160" & regexm(cr5id, "T1") //4 changes
replace consultant="J CLARKE" if pid=="20140160" & regexm(cr5id, "T1") //4 changes

replace cstatus=1 if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace primarysite="BREAST-LIQ" if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace topography=503 if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace top="503" if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace topcat=43 if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace hx="INVASIVE DUCTAL CARCINOMA" if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace morph=8500 if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace morphcat=10 if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace lat=2 if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace latcat=31 if pid=="20140161" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace basis=7 if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace staging=8 if pid=="20140161" & regexm(cr5id, "T1") //0 changes
replace dot=d(13jan2014) if pid=="20140161" & regexm(cr5id, "T1") //2 changes
replace consultant="N KING" if pid=="20140161" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2009) if pid=="20140163" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20140163" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2011) if pid=="20140166" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140166" & regexm(cr5id,"T1") //2 changes

replace cstatus=1 if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace primarysite="RECTUM" if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace topography=209 if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace top="209" if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace topcat=21 if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace hx="CANCER" if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace morph=8000 if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace morphcat=1 if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140168" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace basis=0 if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace staging=8 if pid=="20140168" & regexm(cr5id, "T1") //0 changes
replace dot=d(02apr2014) if pid=="20140168" & regexm(cr5id, "T1") //2 changes
replace consultant="M CAMBRIDGE-MAXWELL" if pid=="20140168" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2012) if pid=="20140171" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140171" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140172" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140172" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2011) if pid=="20140179" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140179" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2005) if pid=="20140182" & regexm(cr5id,"T1") //1 change
replace dxyr=2005 if pid=="20140182" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140183" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140183" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140184" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140184" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2010) if pid=="20140189" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140189" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace primarysite="PROSTATE" if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace topography=619 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace top="619" if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace topcat=53 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140192" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140192" & regexm(cr5id, "T1") //0 changes
replace dot=d(14apr2014) if pid=="20140192" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140192" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun1999) if pid=="20140208" & regexm(cr5id,"T1") //2 changes
replace dxyr=1999 if pid=="20140208" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2010) if pid=="20140209" & regexm(cr5id,"T1") //2 changes
replace dxyr=2010 if pid=="20140209" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140212" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140212" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140216" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140216" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140219" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140219" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2009) if pid=="20140220" & regexm(cr5id,"T1") //2 changes
replace dxyr=2009 if pid=="20140220" & regexm(cr5id,"T1") //2 changes

replace cstatus=1 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace primarysite="99" if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace topography=809 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace top="809" if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace topcat=70 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace hx="METASTATIC CARCINOMA" if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140224" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140224" & regexm(cr5id, "T1") //0 changes
replace dot=d(22apr2014) if pid=="20140224" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140224" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2011) if pid=="20140226" & regexm(cr5id,"T1") //1 change
replace dxyr=2011 if pid=="20140226" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140227" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140227" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2010) if pid=="20140233" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140233" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace primarysite="ABDOMEN" if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace topography=762 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace top="762" if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace topcat=68 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace hx="MALIGNANCY" if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140234" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140234" & regexm(cr5id, "T1") //0 changes
replace dot=d(26apr2014) if pid=="20140234" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140234" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2009) if pid=="20140237" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20140237" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2004) if pid=="20140238" & regexm(cr5id,"T1") //2 changes
replace dxyr=2004 if pid=="20140238" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140242" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140242" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140243" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140243" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140247" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140247" & regexm(cr5id,"T1") //1 change

replace dot=d(31dec2012) if pid=="20140249" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140249" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140251" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140251" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140252" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140252" & regexm(cr5id,"T1") //2 changes

replace cstatus=1 if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace primarysite="LUNG" if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace topography=349 if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace top="349" if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace topcat=32 if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace hx="CANCER" if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace morph=8000 if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace morphcat=1 if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace lat=9 if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace latcat=13 if pid=="20140258" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace basis=0 if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace staging=8 if pid=="20140258" & regexm(cr5id, "T1") //0 changes
replace dot=d(30apr2014) if pid=="20140258" & regexm(cr5id, "T1") //2 changes
replace consultant=certifier if pid=="20140258" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2012) if pid=="20140262" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140262" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2006) if pid=="20140266" & regexm(cr5id,"T1") //1 change
replace dxyr=2006 if pid=="20140266" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140267" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140267" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace primarysite="COLON" if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace topography=189 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace top="189" if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace topcat=19 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140268" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140268" & regexm(cr5id, "T1") //0 changes
replace dot=d(26may2014) if pid=="20140268" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140268" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2012) if pid=="20140271" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140271" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140272" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140272" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun1992) if pid=="20140273" & regexm(cr5id,"T1") //1 change
replace dxyr=1992 if pid=="20140273" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2002) if pid=="20140274" & regexm(cr5id,"T1") //1 change
replace dxyr=2002 if pid=="20140274" & regexm(cr5id,"T1") //1 change

replace dot=d(15nov2012) if pid=="20140275" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140275" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2007) if pid=="20140277" & regexm(cr5id,"T1") //1 change
replace dxyr=2007 if pid=="20140277" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2010) if pid=="20140278" & regexm(cr5id,"T1") //2 changes
replace dxyr=2010 if pid=="20140278" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2009) if pid=="20140279" & regexm(cr5id,"T1") //2 changes
replace dxyr=2009 if pid=="20140279" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2007) if pid=="20140280" & regexm(cr5id,"T1") //1 change
replace dxyr=2007 if pid=="20140280" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace primarysite="PROSTATE" if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace topography=619 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace top="619" if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace topcat=53 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140283" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140283" & regexm(cr5id, "T1") //0 changes
replace dot=d(10jun2014) if pid=="20140283" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140283" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2010) if pid=="20140285" & regexm(cr5id,"T1") //2 changes
replace dxyr=2010 if pid=="20140285" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2002) if pid=="20140287" & regexm(cr5id,"T1") //1 change
replace dxyr=2002 if pid=="20140287" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140288" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140288" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2007) if pid=="20140291" & regexm(cr5id,"T1") //2 changes
replace dxyr=2007 if pid=="20140291" & regexm(cr5id,"T1") //2 changes

replace dot=d(15oct2012) if pid=="20140297" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140297" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace notesseen=3 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace resident=1 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace recstatus=1 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace checkstatus=1 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace primarysite="LUNG" if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace topography=349 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace top="349" if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace topcat=32 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace hx="CARCINOMA" if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace morph=8010 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace morphcat=2 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace lat=9 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace latcat=13 if pid=="20140300" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace grade=9 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace basis=7 if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace staging=8 if pid=="20140300" & regexm(cr5id, "T1") //0 changes
replace dot=d(29apr2014) if pid=="20140300" & regexm(cr5id, "T1") //3 changes
replace consultant="A CUMBERBATCH" if pid=="20140300" & regexm(cr5id, "T1") //3 changes

replace dot=d(30jun2005) if pid=="20140314" & regexm(cr5id,"T1") //1 change
replace dxyr=2005 if pid=="20140314" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2011) if pid=="20140321" & regexm(cr5id,"T1") //1 change
replace dxyr=2011 if pid=="20140321" & regexm(cr5id,"T1") //1 change

replace dot=d(19nov2012) if pid=="20140322" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140322" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2004) if pid=="20140323" & regexm(cr5id,"T1") //1 change
replace dxyr=2004 if pid=="20140323" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2010) if pid=="20140335" & regexm(cr5id,"T1") //2 changes
replace dxyr=2010 if pid=="20140335" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140350" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140350" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140351" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140351" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2009) if pid=="20140355" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20140355" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2009) if pid=="20140358" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20140358" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2007) if pid=="20140359" & regexm(cr5id,"T1") //1 change
replace dxyr=2007 if pid=="20140359" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2007) if pid=="20140362" & regexm(cr5id,"T1") //1 change
replace dxyr=2007 if pid=="20140362" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun1994) if pid=="20140363" & regexm(cr5id,"T1") //1 change
replace dxyr=1994 if pid=="20140363" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2011) if pid=="20140364" & regexm(cr5id,"T1") //1 change
replace dxyr=2011 if pid=="20140364" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun1996) if pid=="20140351" & regexm(cr5id,"T1") //2 changes
replace dxyr=1996 if pid=="20140351" & regexm(cr5id,"T1") //2 changes

replace cstatus=1 if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace notesseen=3 if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace recstatus=1 if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace checkstatus=1 if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace primarysite="ESOPHAGUS" if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace topography=159 if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace top="159" if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace topcat=16 if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace hx="POORLY DIFFERENTIATED CARCINOMA" if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace morph=8010 if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace morphcat=2 if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace lat=0 if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace latcat=0 if pid=="20140375" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace grade=3 if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace basis=7 if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace staging=8 if pid=="20140375" & regexm(cr5id, "T1") //0 changes
replace dot=d(19mar2014) if pid=="20140375" & regexm(cr5id, "T1") //3 changes
replace consultant="E SPRINGER-CYRUS" if pid=="20140375" & regexm(cr5id, "T1") //3 changes

replace dot=d(30jun2012) if pid=="20140378" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140378" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace primarysite="STOMACH" if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace topography=169 if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace top="169" if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace topcat=17 if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace hx="CANCER" if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace morph=8000 if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace morphcat=1 if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140380" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace basis=0 if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace staging=8 if pid=="20140380" & regexm(cr5id, "T1") //0 changes
replace dot=d(31jul2014) if pid=="20140380" & regexm(cr5id, "T1") //2 changes
replace consultant=certifier if pid=="20140380" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2011) if pid=="20140386" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140386" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140388" & regexm(cr5id,"T1") //1 change
replace dxyr=2011 if pid=="20140388" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace primarysite="99" if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace topography=809 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace top="809" if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace topcat=70 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace hx="LEIOMYOSARCOMA" if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140389" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140389" & regexm(cr5id, "T1") //0 changes
replace dot=d(29jul2014) if pid=="20140389" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140389" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2012) if pid=="20140399" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140399" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2001) if pid=="20140400" & regexm(cr5id,"T1") //1 change
replace dxyr=2001 if pid=="20140400" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140402" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140402" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2002) if pid=="20140405" & regexm(cr5id,"T1") //1 change
replace dxyr=2002 if pid=="20140405" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2010) if pid=="20140412" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140412" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2010) if pid=="20140414" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140414" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2000) if pid=="20140415" & regexm(cr5id,"T1") //1 change
replace dxyr=2000 if pid=="20140415" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140417" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140417" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2006) if pid=="20140419" & regexm(cr5id,"T1") //1 change
replace dxyr=2006 if pid=="20140419" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2007) if pid=="20140421" & regexm(cr5id,"T1") //1 change
replace dxyr=2007 if pid=="20140421" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2009) if pid=="20140447" & regexm(cr5id,"T1") //2 changes
replace dxyr=2009 if pid=="20140447" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140457" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140457" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2003) if pid=="20140458" & regexm(cr5id,"T1") //1 change
replace dxyr=2003 if pid=="20140458" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace primarysite="BONE MARROW" if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace topography=421 if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace top="421" if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace topcat=38 if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace hx="LEUKAEMIA" if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace morph=9800 if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace morphcat=50 if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140459" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace basis=5 if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace staging=8 if pid=="20140459" & regexm(cr5id, "T1") //0 changes
replace dot=d(07feb2014) if pid=="20140459" & regexm(cr5id, "T1") //2 changes
replace consultant="T LAURENT" if pid=="20140459" & regexm(cr5id, "T1") //2 changes

replace cstatus=1 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace primarysite="PROSTATE" if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace topography=619 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace top="619" if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace topcat=53 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140461" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140461" & regexm(cr5id, "T1") //0 changes
replace dot=d(15sep2014) if pid=="20140461" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140461" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace primarysite="99" if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace topography=809 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace top="809" if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace topcat=70 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace hx="INVASIVE SQUAMOUS CELL CARCINOMA" if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140462" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140462" & regexm(cr5id, "T1") //0 changes
replace dot=d(24sep2014) if pid=="20140462" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140462" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2011) if pid=="20140466" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140466" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140469" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140469" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace notesseen=3 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace recstatus=1 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace checkstatus=1 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace mpseq=1 if pid=="20140474" & regexm(cr5id, "T1") //0 changes
replace mptot=3 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace primarysite="BREAST" if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace topography=509 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace top="509" if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace topcat=53 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace hx="INVASIVE DUCTAL CARCINOMA WITH METAPLASTIC FEATURES" if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace morph=8500 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace morphcat=10 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace lat=2 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace latcat=31 if pid=="20140474" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace grade=2 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace basis=7 if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace staging=8 if pid=="20140474" & regexm(cr5id, "T1") //0 changes
replace dot=d(06feb2014) if pid=="20140474" & regexm(cr5id, "T1") //3 changes
replace consultant="S BERNSTEIN" if pid=="20140474" & regexm(cr5id, "T1") //3 changes
** 20140474 is missed MP case so need to duplicate above observation then update cr5id and lat
expand=2 if pid=="20140474" & cr5id=="T1S1", gen (dupobs178c1)
replace cr5id="T3S1" if pid=="20140474" & dupobs178c1==1 //1 change
replace mpseq=3 if pid=="20140474" & regexm(cr5id, "T3") //1 change
replace mptot=3 if pid=="20140474" & regexm(cr5id, "T3") //0 changes
replace primarysite="KIDNEY" if pid=="20140474" & regexm(cr5id,"T3") //1 change
replace topography=649 if pid=="20140474" & regexm(cr5id,"T3") //1 change
replace top="649" if pid=="20140474" & regexm(cr5id,"T3") //1 change
replace topcat=56 if pid=="20140474" & regexm(cr5id,"T3") //1 change
replace hx="METASTATIC CARCINOMA" if pid=="20140474" & regexm(cr5id,"T3") //1 change
replace morph=8000 if pid=="20140474" & regexm(cr5id,"T3") //1 change
replace morphcat=1 if pid=="20140474" & regexm(cr5id,"T3") //1 change
replace lat=9 if pid=="20140474" & regexm(cr5id, "T3") //1 change
replace latcat=37 if pid=="20140474" & regexm(cr5id, "T3") //1 change
replace beh=3 if pid=="20140474" & regexm(cr5id, "T3") //0 changes
replace grade=9 if pid=="20140474" & regexm(cr5id, "T3") //1 change
replace basis=0 if pid=="20140474" & regexm(cr5id, "T3") //1 change
replace staging=8 if pid=="20140474" & regexm(cr5id, "T3") //0 changes
replace dot=d(27oct2014) if pid=="20140474" & regexm(cr5id, "T3") //1 change
replace consultant=certifier if pid=="20140474" & regexm(cr5id, "T3") //1 change

replace dot=d(30jun2002) if pid=="20140488" & regexm(cr5id,"T1") //1 change
replace dxyr=2002 if pid=="20140488" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace primarysite="PROSTATE" if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace topography=619 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace top="619" if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace topcat=53 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140491" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140491" & regexm(cr5id, "T1") //0 changes
replace dot=d(07oct2014) if pid=="20140491" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140491" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2010) if pid=="20140498" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140498" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2010) if pid=="20140502" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140502" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140503" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140503" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140508" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140508" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2007) if pid=="20140513" & regexm(cr5id,"T1") //1 change
replace dxyr=2007 if pid=="20140513" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace primarysite="ESOPHAGUS" if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace topography=159 if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace top="159" if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace topcat=16 if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace hx="SQUAMOUS CELL CARCINOMA" if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace morph=8070 if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace morphcat=3 if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140518" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace grade=2 if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace basis=7 if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace staging=8 if pid=="20140518" & regexm(cr5id, "T1") //0 changes
replace dot=d(08may2014) if pid=="20140518" & regexm(cr5id, "T1") //2 changes
replace consultant="A SMITH" if pid=="20140518" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2009) if pid=="20140520" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20140520" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2009) if pid=="20140521" & regexm(cr5id,"T1") //2 changes
replace dxyr=2009 if pid=="20140521" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140524" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140524" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2001) if pid=="20140527" & regexm(cr5id,"T1") //2 changes
replace dxyr=2001 if pid=="20140527" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140533" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140533" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2009) if pid=="20140540" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20140540" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2011) if pid=="20140541" & regexm(cr5id,"T1") //1 change
replace dxyr=2011 if pid=="20140541" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2011) if pid=="20140542" & regexm(cr5id,"T1") //1 change
replace dxyr=2011 if pid=="20140542" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140546" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140546" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140549" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140549" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2010) if pid=="20140554" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140554" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2011) if pid=="20140556" & regexm(cr5id,"T1") //1 change
replace dxyr=2011 if pid=="20140556" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2009) if pid=="20140559" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20140559" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace resident=1 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace primarysite="COLON-SIGMOID" if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace topography=187 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace top="187" if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace topcat=19 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace hx="ADENOCARCINOMA" if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace morph=8140 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace morphcat=6 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140562" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace grade=2 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace basis=7 if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace staging=8 if pid=="20140562" & regexm(cr5id, "T1") //0 changes
replace dot=d(06jan2014) if pid=="20140562" & regexm(cr5id, "T1") //2 changes
replace consultant="J RAMESH" if pid=="20140562" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2009) if pid=="20140564" & regexm(cr5id,"T1") //2 changes
replace dxyr=2009 if pid=="20140564" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140565" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140565" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun1998) if pid=="20140567" & regexm(cr5id,"T1") //1 change
replace dxyr=1998 if pid=="20140567" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace mpseq=1 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace mptot=2 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace primarysite="BONE MARROW" if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace topography=421 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace top="421" if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace topcat=38 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace hx="REFRACTORY ANAEMIA" if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace morph=9980 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace morphcat=56 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140570" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140570" & regexm(cr5id, "T1") //0 changes
replace dot=d(12nov2014) if pid=="20140570" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140570" & regexm(cr5id, "T1") //1 change
** 20140570 is missed MP case so need to duplicate above observation then update cr5id and lat
expand=2 if pid=="20140570" & cr5id=="T1S1", gen (dupobs178c2)
replace cr5id="T2S1" if pid=="20140570" & dupobs178c2==1 //1 change
replace mpseq=2 if pid=="20140570" & regexm(cr5id, "T2") //1 change
replace mptot=2 if pid=="20140570" & regexm(cr5id, "T2") //0 changes
replace primarysite="PROSTATE" if pid=="20140570" & regexm(cr5id,"T2") //1 change
replace topography=619 if pid=="20140570" & regexm(cr5id,"T2") //1 change
replace top="619" if pid=="20140570" & regexm(cr5id,"T2") //1 change
replace topcat=53 if pid=="20140570" & regexm(cr5id,"T2") //1 change
replace hx="METASTATIC CANCER" if pid=="20140570" & regexm(cr5id,"T2") //1 change
replace morph=8000 if pid=="20140570" & regexm(cr5id,"T2") //1 change
replace morphcat=1 if pid=="20140570" & regexm(cr5id,"T2") //1 change

replace dot=d(30jun2012) if pid=="20140579" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140579" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun1994) if pid=="20140581" & regexm(cr5id,"T1") //1 change
replace dxyr=1994 if pid=="20140581" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140583" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140583" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace primarysite="PROSTATE" if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace topography=619 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace top="619" if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace topcat=53 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140584" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140584" & regexm(cr5id, "T1") //0 changes
replace dot=d(13dec2014) if pid=="20140584" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140584" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2006) if pid=="20140585" & regexm(cr5id,"T1") //1 change
replace dxyr=2006 if pid=="20140585" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2005) if pid=="20140588" & regexm(cr5id,"T1") //1 change
replace dxyr=2005 if pid=="20140588" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2010) if pid=="20140589" & regexm(cr5id,"T1") //2 changes
replace dxyr=2010 if pid=="20140589" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140591" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140591" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2009) if pid=="20140599" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20140599" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2010) if pid=="20140604" & regexm(cr5id,"T1") //1 change
replace dxyr=2010 if pid=="20140604" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2004) if pid=="20140605" & regexm(cr5id,"T1") //1 change
replace dxyr=2004 if pid=="20140605" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140607" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140607" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140610" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140610" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2009) if pid=="20140611" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20140611" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace primarysite="ESOPHAGUS" if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace topography=159 if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace top="159" if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace topcat=16 if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace hx="METASTATIC ADENOCARCINOMA" if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace morph=8000 if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace morphcat=1 if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140616" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace basis=0 if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace staging=8 if pid=="20140616" & regexm(cr5id, "T1") //0 changes
replace dot=d(27dec2014) if pid=="20140616" & regexm(cr5id, "T1") //2 changes
replace consultant=certifier if pid=="20140616" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2012) if pid=="20140626" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140626" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140632" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140632" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2005) if pid=="20140633" & regexm(cr5id,"T1") //2 changes
replace dxyr=2005 if pid=="20140633" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2011) if pid=="20140634" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20140634" & regexm(cr5id,"T1") //2 changes

replace cstatus=1 if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace notesseen=3 if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace recstatus=1 if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace checkstatus=1 if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace primarysite="PROSTATE" if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace topography=619 if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace top="619" if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace topcat=53 if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace hx="CARCINOMA" if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace morph=8000 if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace morphcat=1 if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace lat=0 if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace latcat=0 if pid=="20140641" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace grade=9 if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace basis=0 if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace staging=8 if pid=="20140641" & regexm(cr5id, "T1") //0 changes
replace dot=d(27dec2014) if pid=="20140641" & regexm(cr5id, "T1") //2 changes
replace consultant=certifier if pid=="20140641" & regexm(cr5id, "T1") //2 changes

replace dot=d(30jun2004) if pid=="20140642" & regexm(cr5id,"T1") //1 change
replace dxyr=2004 if pid=="20140642" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace primarysite="99" if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace topography=809 if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace top="809" if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace topcat=70 if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace hx="MALIGNANT PROCESS" if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140647" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140647" & regexm(cr5id, "T1") //0 changes
replace dot=d(07dec2014) if pid=="20140647" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140647" & regexm(cr5id, "T1") //1 change

replace cstatus=1 if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace notesseen=3 if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace recstatus=1 if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace checkstatus=1 if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace primarysite="RECTUM" if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace topography=209 if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace top="209" if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace topcat=21 if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace hx="ADENOCARCINOMA" if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace morph=8140 if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace morphcat=6 if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace lat=0 if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace latcat=0 if pid=="20140653" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace grade=2 if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace basis=7 if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace staging=8 if pid=="20140653" & regexm(cr5id, "T1") //0 changes
replace dot=d(29apr2014) if pid=="20140653" & regexm(cr5id, "T1") //4 changes
replace consultant="S BERNSTEIN" if pid=="20140653" & regexm(cr5id, "T1") //4 changes

replace dot=d(30jun2012) if pid=="20140658" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140658" & regexm(cr5id,"T1") //2 changes

replace dot=d(30jun2012) if pid=="20140662" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140662" & regexm(cr5id,"T1") //1 change

replace cstatus=1 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace notesseen=3 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace resident=1 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace recstatus=1 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace checkstatus=1 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace primarysite="PROSTATE" if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace topography=619 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace top="619" if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace topcat=53 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace hx="CANCER" if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace morph=8000 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace morphcat=1 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace lat=0 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace latcat=0 if pid=="20140665" & regexm(cr5id, "T1") //0 changes
replace beh=3 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace grade=9 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace basis=0 if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace staging=8 if pid=="20140665" & regexm(cr5id, "T1") //0 changes
replace dot=d(28nov2014) if pid=="20140665" & regexm(cr5id, "T1") //1 change
replace consultant=certifier if pid=="20140665" & regexm(cr5id, "T1") //1 change

replace dot=d(30jun2012) if pid=="20140670" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20140670" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2000) if pid=="20140673" & regexm(cr5id,"T1") //1 change
replace dxyr=2000 if pid=="20140673" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20140752" & regexm(cr5id,"T1") //2 changes
replace dxyr=2012 if pid=="20140752" & regexm(cr5id,"T1") //2 changes

replace dot=d(16jul2002) if pid=="20141121" & regexm(cr5id,"T1") //1 change
replace dxyr=2002 if pid=="20141121" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20141548" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20141548" & regexm(cr5id,"T1") //1 change

replace dot=d(23nov2009) if pid=="20141559" & regexm(cr5id,"T1") //1 change
replace dxyr=2009 if pid=="20141559" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2012) if pid=="20141569" & regexm(cr5id,"T1") //1 change
replace dxyr=2012 if pid=="20141569" & regexm(cr5id,"T1") //1 change

replace dot=d(30jun2011) if pid=="20145140" & regexm(cr5id,"T1") //2 changes
replace dxyr=2011 if pid=="20145140" & regexm(cr5id,"T1") //2 changes


***********************
** Corrections found **
**    in Dofile 3    **
***********************

** JC 07nov18 - found below corrections when running 3_duplicates_cancer_dc.do
replace hx="INVASIVE SQUAMOUS CELL CARCINOMA,NON-KERATINIZING" if pid=="20140566" & regexm(cr5id, "T2") //1 change
replace morph=8072 if pid=="20140566" & regexm(cr5id, "T2") //1 change
replace morphcat=3 if pid=="20140566" & regexm(cr5id, "T2") //0 changes
** 20140628 & 20141184 are missed CR5db merge - 20141184 T1S2 (RT) to be copied into 20140628 as missed multiple source so need to duplicate above observation then update cr5id and source fields - need to add source for assessing registry completeness
expand=2 if pid=="20140628" & cr5id=="T1S3", gen (dupobs1do3)
replace cr5id="T1S4" if pid=="20140628" & dupobs1do3==1 //1 change
replace stda=13 if pid=="20140628" & cr5id=="T1S4" //1 change
replace stdoa=d(09jan2018) if pid=="20140628" & cr5id=="T1S4" //1 change
replace nftype=10 if pid=="20140628" & cr5id=="T1S4" //1 change
replace sourcename=1 if pid=="20140628" & cr5id=="T1S4" //0 changes
replace doctor="99" if pid=="20140628" & cr5id=="T1S4" //1 change
replace docaddr="MOPD" if pid=="20140628" & cr5id=="T1S4" //0 changes
replace recnum="2014/059" if pid=="20140628" & cr5id=="T1S4" //1 change
replace cfdx="S.C.C Oesophageal" if pid=="20140628" & cr5id=="T1S4" //1 change
replace labnum="" if pid=="20140628" & cr5id=="T1S4" //1 change
replace specimen="" if pid=="20140628" & cr5id=="T1S4" //1 change
replace sampledate=. if pid=="20140628" & cr5id=="T1S4" //1 change
replace recvdate=. if pid=="20140628" & cr5id=="T1S4" //1 change
replace rptdate=. if pid=="20140628" & cr5id=="T1S4" //1 change
replace clindets="" if pid=="20140628" & cr5id=="T1S4" //1 change
replace md="" if pid=="20140628" & cr5id=="T1S4" //1 change
replace rtdate=d(17feb2014) if pid=="20140628" & cr5id=="T1S4" //1 change
replace primarysite="ESOPHAGUS-PROXIMAL" if pid=="20140628" & regexm(cr5id, "T1") //4 changes
replace topography=153 if pid=="20140628" & regexm(cr5id, "T1") //4 changes
replace top="153" if pid=="20140628" & regexm(cr5id, "T1") //4 changes
replace topcat=16 if pid=="20140628" & regexm(cr5id, "T1") //0 changes
** 20140697 & 20141474 are missed CR5db merge - 20141474 T1S1(lab),T1S2 (RT) to be copied into 20140697 as missed multiple source so need to duplicate above observation then update cr5id and source fields - need to add source for assessing registry completeness
expand=2 if pid=="20140697" & cr5id=="T1S1", gen (dupobs2do3)
replace cr5id="T1S2" if pid=="20140697" & dupobs2do3==1 //1 change
replace stda=13 if pid=="20140697" & cr5id=="T1S2" //1 change
replace stdoa=d(30jan2018) if pid=="20140697" & cr5id=="T1S2" //1 change
replace nftype=10 if pid=="20140697" & cr5id=="T1S2" //1 change
replace sourcename=1 if pid=="20140697" & cr5id=="T1S2" //0 changes
replace doctor="99" if pid=="20140697" & cr5id=="T1S2" //1 change
replace docaddr="SOPD" if pid=="20140697" & cr5id=="T1S2" //0 changes
replace recnum="2014/238" if pid=="20140697" & cr5id=="T1S2" //1 change
replace cfdx="Ca (L) Breast" if pid=="20140697" & cr5id=="T1S2" //1 change
replace rtdate=d(15jul2014) if pid=="20140697" & cr5id=="T1S2" //1 change
expand=2 if pid=="20140697" & cr5id=="T1S1", gen (dupobs3do3)
replace cr5id="T1S3" if pid=="20140697" & dupobs3do3==1 //1 change
replace stda=13 if pid=="20140697" & cr5id=="T1S3" //1 change
replace stdoa=d(31oct2017) if pid=="20140697" & cr5id=="T1S3" //1 change
replace nftype=3 if pid=="20140697" & cr5id=="T1S3" //1 change
replace sourcename=1 if pid=="20140697" & cr5id=="T1S3" //0 changes
replace doctor="S FERDINAND" if pid=="20140697" & cr5id=="T1S3" //1 change
replace docaddr="SOPD" if pid=="20140697" & cr5id=="T1S3" //0 changes
replace recnum="" if pid=="20140697" & cr5id=="T1S3" //1 change
replace cfdx="Left mastectomy and nodal tissue   - Invasive ductal carcinoma. grade 3, negative for nodal metastases." if pid=="20140697" & cr5id=="T1S3" //1 change
replace labnum="14122361" if pid=="20140697" & cr5id=="T1S3" //1 change
replace specimen="1) Left breast 2) Axillary nodal tissues" if pid=="20140697" & cr5id=="T1S3" //1 change
replace sampledate=d(27jun2014) if pid=="20140697" & cr5id=="T1S3" //1 change
replace recvdate=. if pid=="20140697" & cr5id=="T1S3" //1 change
replace rptdate=d(17jul2014) if pid=="20140697" & cr5id=="T1S3" //1 change
replace clindets="Left breast carcinoma - (prior biopsy - Lab # CR-1093-14). Left mastectomy with axillary node. Excision done. Breast tagged at axillary tail with single black suture. Axillary dissection in three (3) pieces. Clinical diagnosis:- carcinoma left breast; rule out node mets." if pid=="20140697" & cr5id=="T1S3" //1 change
replace md="Type of specimen: Mastectomy and nodal tissue. Laterality: Left. Location of tumour: Upper inner quadrant. Size of tumour: Maximum dimension: 3cm. Other dimension: 2.7 x 2.5. Type of tumour: Invasive ductal carcinoma. Grade of tumour: 9/9 grade 3. Tubule formation <5%: 3. Mitoses >15 per 10 hpf - 3. Ductal carcinoma in situ: Not present. Perineural invasion: Not identified. Lymph/vascular invasion: Not identified. Margins: 7.8mm from deep margin. Lymph nodes examined: 5. Lymph nodes involved: 0. Stage T2 N0 M0: 2A. "N.B" Tumour was somewhat autolysed. Necrosis was also extensive." if pid=="20140697" & cr5id=="T1S3" //1 change
replace dlc=d(15jul2014) if pid=="20140697" & regexm(cr5id, "T1") //3 changes
replace hospnum="111556" if pid=="20140697" & regexm(cr5id, "T1") //3 changes
** 20141130 & 20145075 are missed CR5db merge - 20145075 T1S1(lab) to be copied into 20141130 as missed multiple source so need to duplicate above observation then update cr5id and source fields - need to add source for assessing registry completeness
expand=2 if pid=="20141130" & cr5id=="T1S1", gen (dupobs4do3)
replace cr5id="T1S3" if pid=="20141130" & dupobs4do3==1 //1 change
replace stda=98 if pid=="20141130" & cr5id=="T1S3" //1 change
replace stdoa=d(21nov2017) if pid=="20141130" & cr5id=="T1S3" //1 change
replace nftype=3 if pid=="20141130" & cr5id=="T1S3" //0 changes
replace sourcename=1 if pid=="20141130" & cr5id=="T1S3" //1 change
replace doctor="S JACKMAN" if pid=="20141130" & cr5id=="T1S3" //0 changes
replace cfdx="BREAST, LEFT, MASTECTOMY AND LYMPH NODES, LEFT AXILLA, DISSECTION:-INVASIVE DUCTAL CARCINOMA, NOTTINGHAM GRADE 3, AJCC pT2a pN3a." if pid=="20141130" & cr5id=="T1S3" //1 change
replace labnum="14055532" if pid=="20141130" & cr5id=="T1S3" //1 change
replace specimen="LEFT BREAST AND AXILLARY NODE" if pid=="20141130" & cr5id=="T1S3" //1 change
replace sampledate=d(24mar2014) if pid=="20141130" & cr5id=="T1S3" //1 change
replace recvdate=. if pid=="20141130" & cr5id=="T1S3" //1 change
replace rptdate=d(03apr2014) if pid=="20141130" & cr5id=="T1S3" //1 change
replace clindets="CONFIRMED CA BREAST-STAGE III-MASTECTOMY WITH AXILLARY NODE. CLINICAL DIAGNOSIS: CARCINOMA BREAST." if pid=="20141130" & cr5id=="T1S3" //1 change
replace md="SURGICAL PATHOLOGY:INVASIVE CARCINOMA OF THE BREAST: CHECKLIST. PROCDEURE:Total mastectomy (including nipple and skin), Lymph Node Sampling: Axillary dissection (partial or complete dissection), Specimen Laterality: Left. Histologic Type of Invasive Carcinoma:Invasive ductal carcinoma (no special type or not otherwise specified). Tumor Size: Size of Largest Invasive Carcinoma:Greatest dimension of focus of invasion >1mm:30.0mm. Histologic Grade:Nottingham Histologic Score, Glandular (Acinar)/Tubular Differentiation:Score 3, Nuclear Pleomorphism:Score 2, Mitotic Rate:Score 3, Overall Grade: Grade 3: score 8/9. Ductal Carcinoma In Situ (DCIS): DCIS is present; negative for extensive intraductal carcinoma component (EIC). Macroscopic and Microscopic Extent of Tumour:Nipple:DCIS involves nipple epidermis (Paget disease of the nipple). Margins:Invasive carcinoma:Margins uninvolved by invasive carcinoma. Distance from closest margin: 56mm; deep margin. DCIS: Margins uninvolved by DCIS. Lymph Nodes: Number of sentinel lymph nodes examined:0, Total number of lymph nodes examined (sentinel and nonsentinel): 12, Lymph Nodes Involvement: ?Number of lymph nodes with macrometastases (>2mm):12, ?Number of lymph nodes with micrometastases (>0.2mm to 2 mm and/or >200cells):0, ?Number of lymph nodes with isolated tumour cells (<0.2mm and <200 cells):0. Size of largest metastatic deposit:20.5mm. Extranodal Extension:Present, Lymph-Vascular Invasion: Present, Pathologic Staging pTNM, Primary Tumour (pT):pT2, Regional Lymph Nodes (pN):pN3a, Distant Metastasis(pM):Not applicable. Microcalcifications:Present in both carcinoma and nonneoplastic tissue." if pid=="20141130" & cr5id=="T1S3" //1 change

replace hospnum="258032" if pid=="20141130" & regexm(cr5id, "T1") //3 changes

** JC 14nov18 - found below corrections when running 3_duplicates_cancer_dc.do
** 20140835 & 20141095 are missed CR5db merge as names were switched - 20140835 T1S1 (NF) to be copied into 20141095 as missed multiple source so need to duplicate above observation then update cr5id and source fields - need to add source for assessing registry completeness
expand=2 if pid=="20141095" & cr5id=="T1S1", gen (dupobs5do3)
replace cr5id="T1S2" if pid=="20141095" & dupobs5do3==1 //1 change
replace stda=9 if pid=="20141095" & cr5id=="T1S2" //1 change
replace stdoa=d(08mar2016) if pid=="20141095" & cr5id=="T1S2" //1 change
replace nftype=7 if pid=="20141095" & cr5id=="T1S2" //1 change
replace sourcename=3 if pid=="20141095" & cr5id=="T1S2" //1 change
replace doctor="P GRIFFITH" if pid=="20141095" & cr5id=="T1S2" //0 changes
replace docaddr="99" if pid=="20141095" & cr5id=="T1S2" //0 changes
replace recnum="99" if pid=="20141095" & cr5id=="T1S2" //1 change
replace cfdx="Adenocarcinoma of Ascending Colon" if pid=="20141095" & cr5id=="T1S2" //1 change
replace labnum="" if pid=="20141095" & cr5id=="T1S2" //1 change
replace specimen="" if pid=="20141095" & cr5id=="T1S2" //1 change
replace sampledate=. if pid=="20141095" & cr5id=="T1S2" //1 change
replace recvdate=. if pid=="20141095" & cr5id=="T1S2" //1 change
replace rptdate=. if pid=="20141095" & cr5id=="T1S2" //1 change
replace clindets="" if pid=="20141095" & cr5id=="T1S2" //1 change
replace md="" if pid=="20141095" & cr5id=="T1S2" //1 change
drop if pid=="20140835" //1 obs deleted
replace comments="14NOV18 JC: Same pt as 20140835-names switched-dropped 20140835 in cleaning file-comments for 20140835 '2AUG18_SF Found Orig. NF in Master, doctor stated BOD was Histology adn Dx Date 20140511. USed this to complete Abs.28JUN18_TH Dr. Griffith said that this information is not available. Change retrieval source to QEH. F/U Needed with Dr P Griffith for DLC, InciDate and Basis of Dx.' 27FEB18_SF Birth Date added." if pid=="20141095" & regexm(cr5id, "T1") //2 changes
** 20140724 & 20141557 are missed CR5db merge as names were switched - 20140724 T1S1 (NF) to be copied into 20141557 as missed multiple source so need to duplicate above observation then update cr5id and source fields - need to add source for assessing registry completeness
/* 
NB: both cases maybe ineligible due to dx date on NF in MasterDb frmCF_2014 #1645 - check hardcopy NF 000150 for 20140724 (20140912 vs 20120909)
then drop 20140724 and, if applicable, make 20141557 ineligible
Checked hardcopy NF 000150 and the date is 12sep2014 so case is eligible.
*/
expand=2 if pid=="20141557" & cr5id=="T1S1", gen (dupobs6do3)
replace cr5id="T1S3" if pid=="20141557" & dupobs6do3==1 //1 change
replace basis=7 if pid=="20141557" & regexm(cr5id, "T1") //3 changes
replace stda=99 if pid=="20141557" & cr5id=="T1S3" //1 change
replace stdoa=d(10oct2014) if pid=="20141557" & cr5id=="T1S3" //1 change
replace nftype=7 if pid=="20141557" & cr5id=="T1S3" //1 change
replace sourcename=3 if pid=="20141557" & cr5id=="T1S3" //1 change
replace doctor="J CLARKE" if pid=="20141557" & cr5id=="T1S3" //1 change
replace docaddr="99" if pid=="20141557" & cr5id=="T1S3" //1 change
replace recnum="36034" if pid=="20141557" & cr5id=="T1S3" //1 change
replace cfdx="Multiple Myeloma" if pid=="20141557" & cr5id=="T1S3" //0 changes
replace rtdate=. if pid=="20141557" & cr5id=="T1S3" //1 change
drop if pid=="20140724" //2 obs deleted
replace comments="14NOV18 JC: Same pt as 20140724-names switched-dropped 20140724 in cleaning file-comments for 20140724 'No F/U Needed.7AUG18_SF Found in MasterDb - 1645. Dx Date: 20140912. BOD: Histology. Changed BOD from 0 to 7, IncDate to 20140912. Added Hosp #.  SLC updated from DeathData. New source added with COD.' No F/U needed. Notes cannot be retrieved due to target date to complete 2014 cases. 2AUG18_SF Notes not found in Death records - FR Soruce changed to QEH Hematology. F/U Needed with Qeh Death Records for Basis of Dx and InciDate. 02Feb18_KWG Middle name not recorded in RT Book." if pid=="20141557" & regexm(cr5id, "T1") //3 changes
** 20140951 & 20141412 are missed CR5db merge as names were switched - 20141412 T1S1 (path) to be copied into 20140951 as missed multiple source so need to duplicate above observation then update cr5id and source fields - need to add source for assessing registry completeness
expand=2 if pid=="20140951" & cr5id=="T1S1", gen (dupobs7do3)
replace cr5id="T1S2" if pid=="20140951" & dupobs7do3==1 //1 change
replace stda=13 if pid=="20140951" & cr5id=="T1S2" //1 change
replace stdoa=d(19oct2017) if pid=="20140951" & cr5id=="T1S2" //1 change
replace nftype=3 if pid=="20140951" & cr5id=="T1S2" //0 changes
replace sourcename=1 if pid=="20140951" & cr5id=="T1S2" //1 change
replace doctor="M WALROND" if pid=="20140951" & cr5id=="T1S2" //0 changes
replace docaddr="A5" if pid=="20140951" & cr5id=="T1S2" //1 change
replace cfdx="Right breast and axillary dissection  - Invasive ductal carcinoma, with: i) 1/14 lymph nodes positive for metastasis." if pid=="20140951" & cr5id=="T1S2" //1 change
replace labnum="14153218" if pid=="20140951" & cr5id=="T1S2" //1 change
replace specimen="Right breast and axillary dissection and separate axillary fat with nodes." if pid=="20140951" & cr5id=="T1S2" //1 change
replace sampledate=d(15aug2014) if pid=="20140951" & cr5id=="T1S2" //1 change
replace recvdate=. if pid=="20140951" & cr5id=="T1S2" //1 change
replace rptdate=d(22aug2014) if pid=="20140951" & cr5id=="T1S2" //1 change
replace clindets="2.5cm lump under right areolar with large axillary node. Core needle confirmed breast cancer. Clinical Diagnosis: Right breast cancer with axillary node ??breast cancer. Clinical Diagnosis: Right breast cancer with axillary node involvement." if pid=="20140951" & cr5id=="T1S2" //1 change
replace md="Procedure: Total mastectomy. Lymph node sampling: Axillary dissection. Specimen laterality: Right breast. Tumour site: Central. Histologic type: Invasive ductal carcinoma. Tumour size: 3.0cm (maximum gross dimension). Histologic grade: Cannot be assessed due to autolysis. Tumour focality: Single focus of invasive carcinoma. Ductal carcinoma in situ: Not identified. Macroscopic and microscopic extent of tumour: No skin, nipple or muscle invasion. Margins: 1.5cm from nearest margin. Lymph nodes: 1/14 positive for metastasis. Lymoh vascular invasion: Present. Pathologic stage: pT2 N1a Mx." if pid=="20140951" & cr5id=="T1S2" //1 change
replace consrpt="" if pid=="20140951" & cr5id=="T1S2" //1 change
drop if pid=="20141412" //1 obs deleted
replace dlc=d(15aug2014) if pid=="20140951" & regexm(cr5id, "T1") //2 changes
replace fname="JANETTE" if pid=="20140951" & regexm(cr5id, "T1") //2 changes
replace lname="ALLMAN-HEWITT" if pid=="20140951" & regexm(cr5id, "T1") //2 changes
replace init="S" if pid=="20140951" & regexm(cr5id, "T1") //2 changes
replace comments="14NOV18 JC: Same pt as 20141412-names switched-dropped 20141412 in cleaning file-comments for 20141412 blank. 06APR18_KWG IHC Report added. 21MAR18_SF On electoral list the FNAME listed as JANETTE and SONIA listed as Middle Name. 27FEB18_SF Birth Date added." if pid=="20140951" & regexm(cr5id, "T1") //2 changes
** 20145095 & 20141503 are missed CR5db merge as names were switched - 20141503 T1S1 (path) to be copied into 20145095 as missed multiple source so need to duplicate above observation then update cr5id and source fields - need to add source for assessing registry completeness
expand=2 if pid=="20145095" & cr5id=="T1S1", gen (dupobs8do3)
replace cr5id="T1S2" if pid=="20145095" & dupobs8do3==1 //1 change
replace stda=13 if pid=="20145095" & cr5id=="T1S2" //1 change
replace stdoa=d(11oct2017) if pid=="20145095" & cr5id=="T1S2" //1 change
replace nftype=3 if pid=="20145095" & cr5id=="T1S2" //0 changes
replace sourcename=1 if pid=="20145095" & cr5id=="T1S2" //0 changes
replace doctor="M OSHEA" if pid=="20145095" & cr5id=="T1S2" //1 change
replace docaddr="SOPD" if pid=="20145095" & cr5id=="T1S2" //0 changes
replace cfdx="1) Right breast and 2) Right axillary fat and lymph nodes:  - In-situ and invasive ductal carcinoma, grade II with:- i) 4/18 Lymph nodes positive for metastasis." if pid=="20145095" & cr5id=="T1S2" //1 change
replace labnum="14099279" if pid=="20145095" & cr5id=="T1S2" //1 change
replace specimen="1) Right breast. 2) Right axillary fat and lymph nodes." if pid=="20145095" & cr5id=="T1S2" //1 change
replace sampledate=d(27may2014) if pid=="20145095" & cr5id=="T1S2" //1 change
replace recvdate=. if pid=="20145095" & cr5id=="T1S2" //1 change
replace rptdate=d(10jun2014) if pid=="20145095" & cr5id=="T1S2" //1 change
replace clindets="Presented with breast lump - invasive ductal carcinoma. Had mastectomy and level II axillary dissection. (14066162). Clinical Diagnosis:- right breast carcinoma ?axillary metastases." if pid=="20145095" & cr5id=="T1S2" //1 change
replace md="Tumour type: In-situ and invasive ductal carcinoma. Tumour grade: II (Bloom-Richardson score 7). Tumour size: 2cm (maximum gross dimension). In-situ carcinoma: Solid. Necrosis: Not identified. Calcification: Present. Lymph vascular invasion: Present. Resection margin: Not involved. Random breast and nipple: Unremarkable. Irregular brown area: Ductal hyperplasia. Lymph nodes (specimen 2): 4/18 Positive for metastasis." if pid=="20145095" & cr5id=="T1S2" //1 change
replace consrpt="FACILITY: UHEALTH PATHOLOGY LAB. CASE #UT14-2936. FINDINGS: Infiltrating Ductal Carcinoma, intermediate nuclear grade. Immunohistochemistry is positive for estrogen receptor and negative for progesterone receptor and HER2." if pid=="20145095" & cr5id=="T1S2" //1 change
expand=2 if pid=="20145095" & cr5id=="T1S1", gen (dupobs9do3)
replace cr5id="T1S3" if pid=="20145095" & dupobs9do3==1 //1 change
replace stda=13 if pid=="20145095" & cr5id=="T1S3" //1 change
replace stdoa=d(25jan2018) if pid=="20145095" & cr5id=="T1S3" //1 change
replace nftype=10 if pid=="20145095" & cr5id=="T1S3" //1 change
replace sourcename=1 if pid=="20145095" & cr5id=="T1S3" //0 changes
replace doctor="99" if pid=="20145095" & cr5id=="T1S3" //1 change
replace docaddr="A2" if pid=="20145095" & cr5id=="T1S3" //1 change
replace recnum="2014/184" if pid=="20145095" & cr5id=="T1S3" //1 change
replace cfdx="Ca (R) Breast" if pid=="20145095" & cr5id=="T1S3" //1 change
replace labnum="" if pid=="20145095" & cr5id=="T1S3" //1 change
replace specimen="" if pid=="20145095" & cr5id=="T1S3" //1 change
replace sampledate=. if pid=="20145095" & cr5id=="T1S3" //1 change
replace recvdate=. if pid=="20145095" & cr5id=="T1S3" //1 change
replace rptdate=. if pid=="20145095" & cr5id=="T1S3" //1 change
replace clindets="" if pid=="20145095" & cr5id=="T1S3" //1 change
replace md="" if pid=="20145095" & cr5id=="T1S3" //1 change
replace consrpt="" if pid=="20145095" & cr5id=="T1S3" //1 change
replace rtdate=d(28may2014) if pid=="20145095" & cr5id=="T1S3" //1 change
drop if pid=="20141503" //2 obs deleted
replace dlc=d(28may2014) if pid=="20145095" & regexm(cr5id, "T1") //3 changes
replace fname="TAMMIE" if pid=="20145095" & regexm(cr5id, "T1") //3 changes
replace init="C" if pid=="20145095" & regexm(cr5id, "T1") //3 changes
replace comments="14NOV18 JC: Same pt as 20141503-names switched-dropped 20141503 in cleaning file-comments for 20141503 blank. 18MAY_SF FName listed as TAMMIE in Electoral list, CAROL listed as Middle Name." if pid=="20145095" & regexm(cr5id, "T1") //3 changes
replace grade=2 if pid=="20145095" & regexm(cr5id, "T1") //0 changes
** 20140592 & 20140659 have same hospnum but NOT same pt - seems 20140592 T1S2 was placed into 2014659 T1S2 but does not belong so drop and correct (see Check 76 subchk 1 for other corrections)
drop if pid=="20140659" & cr5id=="T1S2" //1 obs deleted
replace hospnum="99" if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace parish=3 if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace addr="SOUTH DISTRICT" if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace primarysite="99" if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace topography=809 if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace top="809" if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace topcat=70 if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace hx="LIVER METASTASES" if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace morph=8000 if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace morphcat=1 if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace lat=0 if pid=="20140659" & regexm(cr5id,"T1") //0 changes
replace latcat=0 if pid=="20140659" & regexm(cr5id,"T1") //0 changes
replace grade=9 if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace basis=0 if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace dot=dlc if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace consultant="99" if pid=="20140659" & regexm(cr5id,"T1") //1 change
replace rx1=9 if pid=="20140659" & regexm(cr5id,"T1") //0 changes
replace rx1d=. if pid=="20140659" & regexm(cr5id,"T1") //0 changes

** 14nov18 JC: Found errors when copying COD info from one source to another for this case in dofile 3
** Indicate in comments of 20141480 that MM dx is 2011
replace comments="14NOV18 JC: MM dx is 2011 see MasterDb frmCF_2009 #645. No F/U needed, IHC report seen in notes: FACILITY: Integrated Oncology. CASE#: BC14-002125. FINDINGS: 1) Metastatic nonkeratinizing poorly differentiated carcinoma. Primary site unknown up until time of death. Mets found to be to cervical lymph node in the neck. F/U Needed with Qeh Death Records, to determine histology and primary site. Abstraction based on Death Data as Pth Report and Bone Marrow Report not clear." if pid=="20141480" & regexm(cr5id,"T1") //4 changes
replace lat=0 if pid=="20141480" & regexm(cr5id,"T1") //0 changes
replace latcat=0 if pid=="20141480" & regexm(cr5id,"T1") //0 changes
replace grade=3 if pid=="20141480" & regexm(cr5id,"T1") //4 changes
replace basis=6 if pid=="20141480" & regexm(cr5id,"T1") //4 changes
replace consrpt="FACILITY: Integrated Oncology. CASE#: BC14-002125. FINDINGS: 1) Metastatic nonkeratinizing poorly differentiated carcinoma." if pid=="20141480" & cr5id=="T1S1" //1 change

** JC 07nov18 - found missed CR5db merge in above list so will drop - now total will be 920 instead of 921 and total=2,557
drop if pid=="20140935" //1 obs deleted
drop if pid=="20141184" //3 obs deleted
drop if pid=="20141474" //2 obs deleted
drop if pid=="20145075" //2 obs deleted

** remove unused variables - will remove more in upcoming dofiles
drop ObsoleteFlagTumourTable ObsoleteFlagPatientTable bas

count //2,553

save "data\clean\2014_cancer_clean_dups_dc.dta" ,replace
label data "BNR-Cancer Cleaning: Duplicate sources - 2013 & 2014"
notes _dta :These data prepared for 2014 ABS phase
